<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1710.03077] Deeper, Broader and Artier Domain Generalization</title><meta property="og:description" content="The problem of domain generalization is to learn from multiple training domains, and extract a domain-agnostic model that can then be applied to an unseen domain. Domain generalization (DG) has a clear motivation in co…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deeper, Broader and Artier Domain Generalization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Deeper, Broader and Artier Domain Generalization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1710.03077">
<link rel="canonical" target="_blank" href="https://ar5iv.labs.arxiv.org/html/1710.03077">

<!--Generated on Sun Mar  3 03:16:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Deeper, Broader and Artier Domain Generalization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Da Li  Yongxin Yang  Yi-Zhe Song  Timothy M. Hospedales
<br class="ltx_break">Queen Mary University of London  University of Edinburgh 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{da.li, yongxin.yang, yizhe.song}@qmul.ac.uk, t.hospedales@ed.ac.uk</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">The problem of domain generalization is to learn from multiple training domains, and extract a domain-agnostic model that can then be applied to an unseen domain. Domain generalization (DG) has a clear motivation in contexts where there are target domains with distinct characteristics, yet sparse data for training. For example recognition in sketch images, which are distinctly more abstract and rarer than photos. Nevertheless, DG methods have primarily been evaluated on photo-only benchmarks focusing on alleviating the dataset bias where both problems of domain distinctiveness and data sparsity can be minimal. We argue that these benchmarks are overly straightforward, and show that simple deep learning baselines perform surprisingly well on them.</p>
<p id="id3.id2" class="ltx_p">In this paper, we make two main contributions: Firstly, we build upon the favorable domain shift-robust properties of deep learning methods, and develop a low-rank parameterized CNN model for end-to-end DG learning. Secondly, we develop a DG benchmark dataset covering photo, sketch, cartoon and painting domains. This is both more practically relevant, and harder (bigger domain shift) than existing benchmarks. The results show that our method outperforms existing DG alternatives, and our dataset provides a more significant DG challenge to drive future research.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Learning models that can bridge train-test domain-shift is a topical issue in computer vision and beyond. In vision this has been motivated recently by the observation of significant bias across popular datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, and the poor performance of state-of-the-art models when applied across datasets. Existing approaches can broadly be categorized into domain <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">adaptation</em> (DA) methods, that use (un)labeled target data to adapt source model(s) to a specific target domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>; and domain <em id="S1.p1.1.2" class="ltx_emph ltx_font_italic">generalization</em> (DG) approaches, that learn a domain agnostic model from multiple sources that can be applied to any target domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. While DA has been more commonly studied, DG is the more valuable yet challenging setting, as it does not require acquisition of a large target domain set for off-line analysis to drive adaptation. Such data may not even exist if the target domain is sparse. Instead it aims to produce a more human-like model, where there is a deeper semantic sharing across different domains – a dog is a dog no matter if it is depicted in the form of a photo, cartoon, painting, or indeed, a sketch.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1710.03077/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_square" width="230" height="206" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Contrast between prior Caltech Office and VLCS datasets versus our new PACS dataset. The domain generalization task is to recognize categories in an unseen testing domain. PACS provides more diverse domains with bigger more challenging domain-shifts between them. </span></figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">The most popular existing DA/DG benchmarks define domains as photos of objects spanning different camera types <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, or datasets collected with different composition biases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. While these benchmarks provide a good start, we argue that they are neither well motivated nor hard enough to drive the field. <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">Motivation</em>: The constituent domains/datasets in existing benchmarks are based upon conventional photos, albeit with different camera types or composition bias. However there exist enough photos, that one could in principle collect enough target domain-specific data to train a good model, or enough diverse data to cover all domains and minimize bias (thus negating the need for DA). A more compelling motivation is domains where the total available images is fundamentally constrained, such as for particular styles of art <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, and sketches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. Compared to photos, there may simply not be enough examples of a given art style to train a good model, even if we are willing to spend the effort. <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">Difficulty:</em> The camera type and bias differences between domains in existing benchmarks are already partially bridged by contemporary Deep features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, thus questioning the need for DA or DG methods. In this paper, we show that multi-domain deep learning provides a very simple but highly effective approach to DG that outperforms existing purpose-designed methods.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address these limitations, we provide a harder and better motivated benchmark dataset PACS, consisting of images from photo (P), art painting (A), cartoon (C), and sketch (S) domains. This benchmark carries two important advancements over prior examples: (i) it extends the previously photo-only setting in DA/DG research, and uniquely includes domains that are maximally distinct from each other, spanning a wide spectrum of visual abstraction, from photos that are the least abstract to human sketches which are the most abstract; (ii) it is more reflective of a real-world task where a target domain (such as sketch) is intrinsically sparse, and so DG from a more abundant domain (such as photos) is really necessary. As illustrated qualitatively in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the benchmark is harder, as the domains are visually more distinct than in prior datasets. We explore these differences quantitatively in Sec. <a href="#S4.SS2" title="4.2 Characterizing Benchmarks’ Domain Shifts ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">There have been a variety of prior approaches to DG based on SVM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, subspace learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, metric learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and autoencoders <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Despite their differences, most of these have looked at fixed shallow features. In this paper, we address the question of how end-to-end learning of deep features impacts the DG setting. Our deep learning approach trains on multiple source domains, and extracts <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">both</em> domain agnostic features (e.g., convolutional kernels), and classifier (e.g., final FC layer) for transfer to a new target domain. This approach can be seen as a deep multi-class generalization of the shallow binary Undo Bias method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, which takes the form of a dynamically parameterized deep neural network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. However, the resulting number of parameters grows linearly with the number of source domains (of which ultimately, we expect many for DG), increasing overfitting risk. To address this we develop a low-rank parameterized neural network which reduces the number of parameters. Furthermore the low-rank approach provides an additional route to knowledge sharing besides through explicit parameterization. In particular it has the further benefit of automatically modeling how related the different domains are (e.g., perhaps sketch is similar to cartoon; and cartoon is similar to painting), and also how the degree of sharing should vary at each layer of the CNN.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To summarize our contributions: Firstly, we highlight the weaknesses of existing methods (they lose to a simple deep learning baseline) and datasets (their domain shift is small). Second, we introduce a new, better motivated, and more challenging DG benchmark. Finally, we develop a novel DG method based on low-rank parameterized CNNs that shows favorable performance compared to prior work.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Domain Generalization</span> Despite different methodological tools (SVM, subspace learning, autoencoders, etc), existing methods approach DG based on a few different intuitions. One is to project the data to a new domain invariant representation where the differences between training domains is minimized <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, with the intuition that such a space will also be good for an unseen testing domain. Another intuition is to predict which known domain a testing sample seems most relevant to, and use that classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Finally, there is the idea of generating a domain agnostic classifier, for example by asserting that each training domain’s classifier is the sum of a domain-specific and domain-agnostic weight vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The resulting domain-agnostic weight vector can then be extracted and applied to held out domains. Our approach lies in this latter category. However, prior work in this area has dealt with shallow, linear models only. We show how to extend this intuition to end-to-end learning in CNNs, while limiting the resulting parameter growth, and making the sharing structure richer than an unweighted sum.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">There has been more extensive work on CNN models for domain <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">adaptation</em>, with methods developed for encouraging CNN layers to learn transferable features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, these studies have typically not addressed our domain <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">generalization</em> setting. Moreover, as analysis has shown that the transferability of different layers in CNNs varies significantly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, these studies have had carefully hand designed the CNN sharing structure to address their particular DA problems. In our benchmark, this is harder, as the gaps between our more diverse domains are unknown and likely to be more variable. However, our low-rank modeling approach provides the benefit of automatically estimating both the per-domain and per-layer sharing strength.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Domain Generalization is also related to <em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">learning to learn</em>. Learning to learn methods aim to learn not just specific concepts or skills, but learning algorithms or problem agnostic biases that improve generalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
Similarly DG is to extract common knowledge from source domains that applies to unseen target domains.
Thus our method can be seen as a simple learning to learn method for the DG setting. Different from few-shot learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, DG is a zero-shot problem as performance is immediately evaluated on the target domain with no further learning.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Neural Network Methods</span> Our DG method is related to parameterized neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, in that the parameters are set based on external metadata. In our case, based on a description of the current domain, rather than an instance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, or additional sensor <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. It is also related to low-rank neural network models, typically used to compress <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and speed up <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> CNNs, and have very recently been explored for cross-category CNN knowledge transfer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. In our case we exploit this idea both for compression – but across rather than within domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, as well as for cross-domain (rather than cross-category <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>) knowledge sharing. Different domains can share parameters via common latent factors. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> also addresses the DG setting, but learns shared parameters based on image reconstruction, whereas ours is learned via paramaterizing each domain’s CNN.
As a parameterized neural network, our approach also differs from all those other low-rank methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, which have a fixed parameterization.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Benchmarks and Datasets</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p"><span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_bold">DG Benchmarks</span> The most popular DG benchmarks are: ‘Office’ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (containing Amazon/Webcam/DSLR images), later extended to include a fourth Caltech 101 domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> (OfficeCaltech) and Pascal 2007, LabelMe, Caltech, SUN09 (VLCS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The domains within Office relate to different camera types, and the others are created by the biases of different data collection procedures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Despite the famous analysis of dataset bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> that motivated the creation of the VLCS benchmark, it was later shown that the domain shift is much smaller with recent deep features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Thus recent DG studies have used deep features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, to obtain better results. Nevertheless, we show that a very simple baseline of fine-tuning deep features on multiple source domains performs comparably or better than prior DG methods. This motivates our design of a CNN-based DG method, as well as our new dataset (Fig <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) which has greater domain shift than the prior benchmarks. Our dataset draws on non-photorealistic and abstract visual domains which provide a better motivated example of the sort of relatively sparse data domain where DG would be of practical value.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Non-photorealistic Image Analysis</span> Non-photorealistic image analysis is a growing subfield of computer vision that extends the conventional photo-only setting of vision research to include other visual depictions (often more abstract) such as paintings and sketches. Typical tasks include instance-level matching between sketch-photo <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, and art-photo domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and transferring of object recognizers trained on photos to detect objects in art <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. Most prior work focuses on two domains (such as photo and painting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, or photo and sketch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>). Studies have investigated simple ‘blind’ transfer between domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, learning cross-domain projections <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, or engineering structured models for matching <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. Thus, in contrast to our DG setting, prior non-photorealistic analyses fall into either cross-domain instance matching, or domain adaptation settings. To create our benchmark, we aggregate multiple domains including paintings, cartoons and sketches, and define a comprehensive domain-generalization benchmark covering a wide spectrum of visual abstraction based upon these. Thus in contrast to prior DG benchmarks, our domain-shifts are bigger and more challenging.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.6" class="ltx_p">Assume we observe <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">S</annotation></semantics></math> domains, and the <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">i</annotation></semantics></math>th domain contains <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">N</mi><mi id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑁</ci><ci id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">N_{i}</annotation></semantics></math> labeled instances <math id="S3.p1.4.m4.3" class="ltx_Math" alttext="\{(x_{j}^{(i)},y_{j}^{(i)})\}^{N_{i}}_{j=1}" display="inline"><semantics id="S3.p1.4.m4.3a"><msubsup id="S3.p1.4.m4.3.3" xref="S3.p1.4.m4.3.3.cmml"><mrow id="S3.p1.4.m4.3.3.1.1.1" xref="S3.p1.4.m4.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.3.3.1.1.1.2" xref="S3.p1.4.m4.3.3.1.1.2.cmml">{</mo><mrow id="S3.p1.4.m4.3.3.1.1.1.1.2" xref="S3.p1.4.m4.3.3.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.4.m4.3.3.1.1.1.1.2.3" xref="S3.p1.4.m4.3.3.1.1.1.1.3.cmml">(</mo><msubsup id="S3.p1.4.m4.3.3.1.1.1.1.1.1" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.cmml"><mi id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.2" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.3" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.p1.4.m4.1.1.1.3" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.1" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.1.1.1.3.2" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p1.4.m4.3.3.1.1.1.1.2.4" xref="S3.p1.4.m4.3.3.1.1.1.1.3.cmml">,</mo><msubsup id="S3.p1.4.m4.3.3.1.1.1.1.2.2" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.cmml"><mi id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.2" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.3" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.3.cmml">j</mi><mrow id="S3.p1.4.m4.2.2.1.3" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.p1.4.m4.2.2.1.3.1" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.cmml">(</mo><mi id="S3.p1.4.m4.2.2.1.1" xref="S3.p1.4.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.4.m4.2.2.1.3.2" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.4.m4.3.3.1.1.1.1.2.5" xref="S3.p1.4.m4.3.3.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.p1.4.m4.3.3.1.1.1.3" xref="S3.p1.4.m4.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S3.p1.4.m4.3.3.3" xref="S3.p1.4.m4.3.3.3.cmml"><mi id="S3.p1.4.m4.3.3.3.2" xref="S3.p1.4.m4.3.3.3.2.cmml">j</mi><mo id="S3.p1.4.m4.3.3.3.1" xref="S3.p1.4.m4.3.3.3.1.cmml">=</mo><mn id="S3.p1.4.m4.3.3.3.3" xref="S3.p1.4.m4.3.3.3.3.cmml">1</mn></mrow><msub id="S3.p1.4.m4.3.3.1.3" xref="S3.p1.4.m4.3.3.1.3.cmml"><mi id="S3.p1.4.m4.3.3.1.3.2" xref="S3.p1.4.m4.3.3.1.3.2.cmml">N</mi><mi id="S3.p1.4.m4.3.3.1.3.3" xref="S3.p1.4.m4.3.3.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.3b"><apply id="S3.p1.4.m4.3.3.cmml" xref="S3.p1.4.m4.3.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.2.cmml" xref="S3.p1.4.m4.3.3">subscript</csymbol><apply id="S3.p1.4.m4.3.3.1.cmml" xref="S3.p1.4.m4.3.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.2.cmml" xref="S3.p1.4.m4.3.3">superscript</csymbol><set id="S3.p1.4.m4.3.3.1.1.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1"><interval closure="open" id="S3.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2"><apply id="S3.p1.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1">𝑖</ci></apply><apply id="S3.p1.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.1.1.1.2.2.1.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2">superscript</csymbol><apply id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.p1.4.m4.3.3.1.1.1.1.2.2.2.3">𝑗</ci></apply><ci id="S3.p1.4.m4.2.2.1.1.cmml" xref="S3.p1.4.m4.2.2.1.1">𝑖</ci></apply></interval></set><apply id="S3.p1.4.m4.3.3.1.3.cmml" xref="S3.p1.4.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.3.3.1.3.1.cmml" xref="S3.p1.4.m4.3.3.1.3">subscript</csymbol><ci id="S3.p1.4.m4.3.3.1.3.2.cmml" xref="S3.p1.4.m4.3.3.1.3.2">𝑁</ci><ci id="S3.p1.4.m4.3.3.1.3.3.cmml" xref="S3.p1.4.m4.3.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.p1.4.m4.3.3.3.cmml" xref="S3.p1.4.m4.3.3.3"><eq id="S3.p1.4.m4.3.3.3.1.cmml" xref="S3.p1.4.m4.3.3.3.1"></eq><ci id="S3.p1.4.m4.3.3.3.2.cmml" xref="S3.p1.4.m4.3.3.3.2">𝑗</ci><cn type="integer" id="S3.p1.4.m4.3.3.3.3.cmml" xref="S3.p1.4.m4.3.3.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.3c">\{(x_{j}^{(i)},y_{j}^{(i)})\}^{N_{i}}_{j=1}</annotation></semantics></math> where <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="x_{j}^{(i)}" display="inline"><semantics id="S3.p1.5.m5.1a"><msubsup id="S3.p1.5.m5.1.2" xref="S3.p1.5.m5.1.2.cmml"><mi id="S3.p1.5.m5.1.2.2.2" xref="S3.p1.5.m5.1.2.2.2.cmml">x</mi><mi id="S3.p1.5.m5.1.2.2.3" xref="S3.p1.5.m5.1.2.2.3.cmml">j</mi><mrow id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.2.cmml"><mo stretchy="false" id="S3.p1.5.m5.1.1.1.3.1" xref="S3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.p1.5.m5.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.5.m5.1.1.1.3.2" xref="S3.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.1.cmml" xref="S3.p1.5.m5.1.2">superscript</csymbol><apply id="S3.p1.5.m5.1.2.2.cmml" xref="S3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.2.2.1.cmml" xref="S3.p1.5.m5.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.2.2.2.cmml" xref="S3.p1.5.m5.1.2.2.2">𝑥</ci><ci id="S3.p1.5.m5.1.2.2.3.cmml" xref="S3.p1.5.m5.1.2.2.3">𝑗</ci></apply><ci id="S3.p1.5.m5.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">x_{j}^{(i)}</annotation></semantics></math> is the input data (e.g., an image) for which we assume they are of the same size among all domains (e.g., all images are cropped into the same size), and <math id="S3.p1.6.m6.2" class="ltx_Math" alttext="y_{j}^{(i)}\in\{1\dots C\}" display="inline"><semantics id="S3.p1.6.m6.2a"><mrow id="S3.p1.6.m6.2.2" xref="S3.p1.6.m6.2.2.cmml"><msubsup id="S3.p1.6.m6.2.2.3" xref="S3.p1.6.m6.2.2.3.cmml"><mi id="S3.p1.6.m6.2.2.3.2.2" xref="S3.p1.6.m6.2.2.3.2.2.cmml">y</mi><mi id="S3.p1.6.m6.2.2.3.2.3" xref="S3.p1.6.m6.2.2.3.2.3.cmml">j</mi><mrow id="S3.p1.6.m6.1.1.1.3" xref="S3.p1.6.m6.2.2.3.cmml"><mo stretchy="false" id="S3.p1.6.m6.1.1.1.3.1" xref="S3.p1.6.m6.2.2.3.cmml">(</mo><mi id="S3.p1.6.m6.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.6.m6.1.1.1.3.2" xref="S3.p1.6.m6.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.6.m6.2.2.2" xref="S3.p1.6.m6.2.2.2.cmml">∈</mo><mrow id="S3.p1.6.m6.2.2.1.1" xref="S3.p1.6.m6.2.2.1.2.cmml"><mo stretchy="false" id="S3.p1.6.m6.2.2.1.1.2" xref="S3.p1.6.m6.2.2.1.2.cmml">{</mo><mrow id="S3.p1.6.m6.2.2.1.1.1" xref="S3.p1.6.m6.2.2.1.1.1.cmml"><mn id="S3.p1.6.m6.2.2.1.1.1.2" xref="S3.p1.6.m6.2.2.1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.p1.6.m6.2.2.1.1.1.1" xref="S3.p1.6.m6.2.2.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.p1.6.m6.2.2.1.1.1.3" xref="S3.p1.6.m6.2.2.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.p1.6.m6.2.2.1.1.1.1a" xref="S3.p1.6.m6.2.2.1.1.1.1.cmml">​</mo><mi id="S3.p1.6.m6.2.2.1.1.1.4" xref="S3.p1.6.m6.2.2.1.1.1.4.cmml">C</mi></mrow><mo stretchy="false" id="S3.p1.6.m6.2.2.1.1.3" xref="S3.p1.6.m6.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.2b"><apply id="S3.p1.6.m6.2.2.cmml" xref="S3.p1.6.m6.2.2"><in id="S3.p1.6.m6.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2"></in><apply id="S3.p1.6.m6.2.2.3.cmml" xref="S3.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.3.1.cmml" xref="S3.p1.6.m6.2.2.3">superscript</csymbol><apply id="S3.p1.6.m6.2.2.3.2.cmml" xref="S3.p1.6.m6.2.2.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.3.2.1.cmml" xref="S3.p1.6.m6.2.2.3">subscript</csymbol><ci id="S3.p1.6.m6.2.2.3.2.2.cmml" xref="S3.p1.6.m6.2.2.3.2.2">𝑦</ci><ci id="S3.p1.6.m6.2.2.3.2.3.cmml" xref="S3.p1.6.m6.2.2.3.2.3">𝑗</ci></apply><ci id="S3.p1.6.m6.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1">𝑖</ci></apply><set id="S3.p1.6.m6.2.2.1.2.cmml" xref="S3.p1.6.m6.2.2.1.1"><apply id="S3.p1.6.m6.2.2.1.1.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1"><times id="S3.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.p1.6.m6.2.2.1.1.1.1"></times><cn type="integer" id="S3.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.p1.6.m6.2.2.1.1.1.2">1</cn><ci id="S3.p1.6.m6.2.2.1.1.1.3.cmml" xref="S3.p1.6.m6.2.2.1.1.1.3">…</ci><ci id="S3.p1.6.m6.2.2.1.1.1.4.cmml" xref="S3.p1.6.m6.2.2.1.1.1.4">𝐶</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.2c">y_{j}^{(i)}\in\{1\dots C\}</annotation></semantics></math> is the class label. We assume the label space is consistent across domains. The objective of DG is to learn a domain agnostic model which can be applied to unseen domains in the future. In contrast to domain adaptation, we can not access the labeled or unlabeled examples from those domains to which the model is eventually applied. So the model is supposed to extract the domain agnostic knowledge within the observed domains. In the training stage, we will minimize the empirical error for all observed domains,</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="\underset{\Theta_{1},\Theta_{2},\dots,\Theta_{S}}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\hat{y}^{(i)}_{j},y^{(i)}_{j})" display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.8" xref="S3.E1.m1.8.8.cmml"><munder accentunder="true" id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mi id="S3.E1.m1.4.4.5" xref="S3.E1.m1.4.4.5.cmml">argmin</mi><mrow id="S3.E1.m1.4.4.4.4" xref="S3.E1.m1.4.4.4.5.cmml"><msub id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.1.cmml"><mi mathvariant="normal" id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.1.2.cmml">Θ</mi><mn id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.4.4.4.4.4" xref="S3.E1.m1.4.4.4.5.cmml">,</mo><msub id="S3.E1.m1.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.3.3.2.2" xref="S3.E1.m1.3.3.3.3.2.2.cmml">Θ</mi><mn id="S3.E1.m1.3.3.3.3.2.3" xref="S3.E1.m1.3.3.3.3.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.4.4.4.4.5" xref="S3.E1.m1.4.4.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">…</mi><mo id="S3.E1.m1.4.4.4.4.6" xref="S3.E1.m1.4.4.4.5.cmml">,</mo><msub id="S3.E1.m1.4.4.4.4.3" xref="S3.E1.m1.4.4.4.4.3.cmml"><mi mathvariant="normal" id="S3.E1.m1.4.4.4.4.3.2" xref="S3.E1.m1.4.4.4.4.3.2.cmml">Θ</mi><mi id="S3.E1.m1.4.4.4.4.3.3" xref="S3.E1.m1.4.4.4.4.3.3.cmml">S</mi></msub></mrow></munder><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.8.8.3" xref="S3.E1.m1.8.8.3.cmml">​</mo><mfrac id="S3.E1.m1.8.8.4" xref="S3.E1.m1.8.8.4.cmml"><mn id="S3.E1.m1.8.8.4.2" xref="S3.E1.m1.8.8.4.2.cmml">1</mn><mi id="S3.E1.m1.8.8.4.3" xref="S3.E1.m1.8.8.4.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.3a" xref="S3.E1.m1.8.8.3.cmml">​</mo><mrow id="S3.E1.m1.8.8.2" xref="S3.E1.m1.8.8.2.cmml"><munderover id="S3.E1.m1.8.8.2.3" xref="S3.E1.m1.8.8.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.8.8.2.3.2.2" xref="S3.E1.m1.8.8.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.2.3.3" xref="S3.E1.m1.8.8.2.3.3.cmml"><mi id="S3.E1.m1.8.8.2.3.3.2" xref="S3.E1.m1.8.8.2.3.3.2.cmml">i</mi><mo id="S3.E1.m1.8.8.2.3.3.1" xref="S3.E1.m1.8.8.2.3.3.1.cmml">=</mo><mn id="S3.E1.m1.8.8.2.3.3.3" xref="S3.E1.m1.8.8.2.3.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.8.8.2.3.2.3" xref="S3.E1.m1.8.8.2.3.2.3.cmml">S</mi></munderover><mrow id="S3.E1.m1.8.8.2.2" xref="S3.E1.m1.8.8.2.2.cmml"><mfrac id="S3.E1.m1.8.8.2.2.4" xref="S3.E1.m1.8.8.2.2.4.cmml"><mn id="S3.E1.m1.8.8.2.2.4.2" xref="S3.E1.m1.8.8.2.2.4.2.cmml">1</mn><msub id="S3.E1.m1.8.8.2.2.4.3" xref="S3.E1.m1.8.8.2.2.4.3.cmml"><mi id="S3.E1.m1.8.8.2.2.4.3.2" xref="S3.E1.m1.8.8.2.2.4.3.2.cmml">N</mi><mi id="S3.E1.m1.8.8.2.2.4.3.3" xref="S3.E1.m1.8.8.2.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.2.2.3" xref="S3.E1.m1.8.8.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.8.8.2.2.2" xref="S3.E1.m1.8.8.2.2.2.cmml"><munderover id="S3.E1.m1.8.8.2.2.2.3" xref="S3.E1.m1.8.8.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.8.8.2.2.2.3.2.2" xref="S3.E1.m1.8.8.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.2.2.2.3.3" xref="S3.E1.m1.8.8.2.2.2.3.3.cmml"><mi id="S3.E1.m1.8.8.2.2.2.3.3.2" xref="S3.E1.m1.8.8.2.2.2.3.3.2.cmml">j</mi><mo id="S3.E1.m1.8.8.2.2.2.3.3.1" xref="S3.E1.m1.8.8.2.2.2.3.3.1.cmml">=</mo><mn id="S3.E1.m1.8.8.2.2.2.3.3.3" xref="S3.E1.m1.8.8.2.2.2.3.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.8.8.2.2.2.3.2.3" xref="S3.E1.m1.8.8.2.2.2.3.2.3.cmml"><mi id="S3.E1.m1.8.8.2.2.2.3.2.3.2" xref="S3.E1.m1.8.8.2.2.2.3.2.3.2.cmml">N</mi><mi id="S3.E1.m1.8.8.2.2.2.3.2.3.3" xref="S3.E1.m1.8.8.2.2.2.3.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E1.m1.8.8.2.2.2.2" xref="S3.E1.m1.8.8.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.8.8.2.2.2.2.4" xref="S3.E1.m1.8.8.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.2.2.2.2.3" xref="S3.E1.m1.8.8.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.8.8.2.2.2.2.2.2" xref="S3.E1.m1.8.8.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.2.2.2.2.2.2.3" xref="S3.E1.m1.8.8.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.7.7.1.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.3.cmml">j</mi><mrow id="S3.E1.m1.5.5.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.3.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml">i</mi><mo stretchy="false" id="S3.E1.m1.5.5.1.3.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E1.m1.8.8.2.2.2.2.2.2.4" xref="S3.E1.m1.8.8.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.8.8.2.2.2.2.2.2.2" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.8.8.2.2.2.2.2.2.2.3" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.3.cmml">j</mi><mrow id="S3.E1.m1.6.6.1.3" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.1.3.1" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.cmml">(</mo><mi id="S3.E1.m1.6.6.1.1" xref="S3.E1.m1.6.6.1.1.cmml">i</mi><mo stretchy="false" id="S3.E1.m1.6.6.1.3.2" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E1.m1.8.8.2.2.2.2.2.2.5" xref="S3.E1.m1.8.8.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.8.cmml" xref="S3.E1.m1.8.8"><times id="S3.E1.m1.8.8.3.cmml" xref="S3.E1.m1.8.8.3"></times><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><list id="S3.E1.m1.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.4"><apply id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.2">Θ</ci><cn type="integer" id="S3.E1.m1.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.3">1</cn></apply><apply id="S3.E1.m1.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.2.1.cmml" xref="S3.E1.m1.3.3.3.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.2.2.cmml" xref="S3.E1.m1.3.3.3.3.2.2">Θ</ci><cn type="integer" id="S3.E1.m1.3.3.3.3.2.3.cmml" xref="S3.E1.m1.3.3.3.3.2.3">2</cn></apply><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">…</ci><apply id="S3.E1.m1.4.4.4.4.3.cmml" xref="S3.E1.m1.4.4.4.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.4.3.1.cmml" xref="S3.E1.m1.4.4.4.4.3">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.3.2.cmml" xref="S3.E1.m1.4.4.4.4.3.2">Θ</ci><ci id="S3.E1.m1.4.4.4.4.3.3.cmml" xref="S3.E1.m1.4.4.4.4.3.3">𝑆</ci></apply></list><ci id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4.5">argmin</ci></apply><apply id="S3.E1.m1.8.8.4.cmml" xref="S3.E1.m1.8.8.4"><divide id="S3.E1.m1.8.8.4.1.cmml" xref="S3.E1.m1.8.8.4"></divide><cn type="integer" id="S3.E1.m1.8.8.4.2.cmml" xref="S3.E1.m1.8.8.4.2">1</cn><ci id="S3.E1.m1.8.8.4.3.cmml" xref="S3.E1.m1.8.8.4.3">𝑆</ci></apply><apply id="S3.E1.m1.8.8.2.cmml" xref="S3.E1.m1.8.8.2"><apply id="S3.E1.m1.8.8.2.3.cmml" xref="S3.E1.m1.8.8.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.3.1.cmml" xref="S3.E1.m1.8.8.2.3">subscript</csymbol><apply id="S3.E1.m1.8.8.2.3.2.cmml" xref="S3.E1.m1.8.8.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.3.2.1.cmml" xref="S3.E1.m1.8.8.2.3">superscript</csymbol><sum id="S3.E1.m1.8.8.2.3.2.2.cmml" xref="S3.E1.m1.8.8.2.3.2.2"></sum><ci id="S3.E1.m1.8.8.2.3.2.3.cmml" xref="S3.E1.m1.8.8.2.3.2.3">𝑆</ci></apply><apply id="S3.E1.m1.8.8.2.3.3.cmml" xref="S3.E1.m1.8.8.2.3.3"><eq id="S3.E1.m1.8.8.2.3.3.1.cmml" xref="S3.E1.m1.8.8.2.3.3.1"></eq><ci id="S3.E1.m1.8.8.2.3.3.2.cmml" xref="S3.E1.m1.8.8.2.3.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.8.8.2.3.3.3.cmml" xref="S3.E1.m1.8.8.2.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.8.8.2.2.cmml" xref="S3.E1.m1.8.8.2.2"><times id="S3.E1.m1.8.8.2.2.3.cmml" xref="S3.E1.m1.8.8.2.2.3"></times><apply id="S3.E1.m1.8.8.2.2.4.cmml" xref="S3.E1.m1.8.8.2.2.4"><divide id="S3.E1.m1.8.8.2.2.4.1.cmml" xref="S3.E1.m1.8.8.2.2.4"></divide><cn type="integer" id="S3.E1.m1.8.8.2.2.4.2.cmml" xref="S3.E1.m1.8.8.2.2.4.2">1</cn><apply id="S3.E1.m1.8.8.2.2.4.3.cmml" xref="S3.E1.m1.8.8.2.2.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.4.3.1.cmml" xref="S3.E1.m1.8.8.2.2.4.3">subscript</csymbol><ci id="S3.E1.m1.8.8.2.2.4.3.2.cmml" xref="S3.E1.m1.8.8.2.2.4.3.2">𝑁</ci><ci id="S3.E1.m1.8.8.2.2.4.3.3.cmml" xref="S3.E1.m1.8.8.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.8.8.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2"><apply id="S3.E1.m1.8.8.2.2.2.3.cmml" xref="S3.E1.m1.8.8.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.2.3.1.cmml" xref="S3.E1.m1.8.8.2.2.2.3">subscript</csymbol><apply id="S3.E1.m1.8.8.2.2.2.3.2.cmml" xref="S3.E1.m1.8.8.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.2.3.2.1.cmml" xref="S3.E1.m1.8.8.2.2.2.3">superscript</csymbol><sum id="S3.E1.m1.8.8.2.2.2.3.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2.3.2.2"></sum><apply id="S3.E1.m1.8.8.2.2.2.3.2.3.cmml" xref="S3.E1.m1.8.8.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.2.3.2.3.1.cmml" xref="S3.E1.m1.8.8.2.2.2.3.2.3">subscript</csymbol><ci id="S3.E1.m1.8.8.2.2.2.3.2.3.2.cmml" xref="S3.E1.m1.8.8.2.2.2.3.2.3.2">𝑁</ci><ci id="S3.E1.m1.8.8.2.2.2.3.2.3.3.cmml" xref="S3.E1.m1.8.8.2.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.8.8.2.2.2.3.3.cmml" xref="S3.E1.m1.8.8.2.2.2.3.3"><eq id="S3.E1.m1.8.8.2.2.2.3.3.1.cmml" xref="S3.E1.m1.8.8.2.2.2.3.3.1"></eq><ci id="S3.E1.m1.8.8.2.2.2.3.3.2.cmml" xref="S3.E1.m1.8.8.2.2.2.3.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.8.8.2.2.2.3.3.3.cmml" xref="S3.E1.m1.8.8.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.8.8.2.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2.2"><times id="S3.E1.m1.8.8.2.2.2.2.3.cmml" xref="S3.E1.m1.8.8.2.2.2.2.3"></times><ci id="S3.E1.m1.8.8.2.2.2.2.4.cmml" xref="S3.E1.m1.8.8.2.2.2.2.4">ℓ</ci><interval closure="open" id="S3.E1.m1.8.8.2.2.2.2.2.3.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2"><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2"><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1">𝑖</ci></apply><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1.m1.8.8.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.6.6.1.1.cmml" xref="S3.E1.m1.6.6.1.1">𝑖</ci></apply><ci id="S3.E1.m1.8.8.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.8.8.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">\underset{\Theta_{1},\Theta_{2},\dots,\Theta_{S}}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\hat{y}^{(i)}_{j},y^{(i)}_{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.24" class="ltx_p">where <math id="S3.p1.7.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.p1.7.m1.1a"><mi mathvariant="normal" id="S3.p1.7.m1.1.1" xref="S3.p1.7.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m1.1b"><ci id="S3.p1.7.m1.1.1.cmml" xref="S3.p1.7.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m1.1c">\ell</annotation></semantics></math> is the loss function that measures the error between the predicted label <math id="S3.p1.8.m2.1" class="ltx_Math" alttext="\hat{y}" display="inline"><semantics id="S3.p1.8.m2.1a"><mover accent="true" id="S3.p1.8.m2.1.1" xref="S3.p1.8.m2.1.1.cmml"><mi id="S3.p1.8.m2.1.1.2" xref="S3.p1.8.m2.1.1.2.cmml">y</mi><mo id="S3.p1.8.m2.1.1.1" xref="S3.p1.8.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.8.m2.1b"><apply id="S3.p1.8.m2.1.1.cmml" xref="S3.p1.8.m2.1.1"><ci id="S3.p1.8.m2.1.1.1.cmml" xref="S3.p1.8.m2.1.1.1">^</ci><ci id="S3.p1.8.m2.1.1.2.cmml" xref="S3.p1.8.m2.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m2.1c">\hat{y}</annotation></semantics></math> and the true label <math id="S3.p1.9.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.p1.9.m3.1a"><mi id="S3.p1.9.m3.1.1" xref="S3.p1.9.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m3.1b"><ci id="S3.p1.9.m3.1.1.cmml" xref="S3.p1.9.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m3.1c">y</annotation></semantics></math>, and prediction is carried out by a function <math id="S3.p1.10.m4.3" class="ltx_Math" alttext="\hat{y}^{(i)}_{j}=f(x^{(i)}_{j}|\Theta_{i})" display="inline"><semantics id="S3.p1.10.m4.3a"><mrow id="S3.p1.10.m4.3.3" xref="S3.p1.10.m4.3.3.cmml"><msubsup id="S3.p1.10.m4.3.3.3" xref="S3.p1.10.m4.3.3.3.cmml"><mover accent="true" id="S3.p1.10.m4.3.3.3.2.2" xref="S3.p1.10.m4.3.3.3.2.2.cmml"><mi id="S3.p1.10.m4.3.3.3.2.2.2" xref="S3.p1.10.m4.3.3.3.2.2.2.cmml">y</mi><mo id="S3.p1.10.m4.3.3.3.2.2.1" xref="S3.p1.10.m4.3.3.3.2.2.1.cmml">^</mo></mover><mi id="S3.p1.10.m4.3.3.3.3" xref="S3.p1.10.m4.3.3.3.3.cmml">j</mi><mrow id="S3.p1.10.m4.1.1.1.3" xref="S3.p1.10.m4.3.3.3.cmml"><mo stretchy="false" id="S3.p1.10.m4.1.1.1.3.1" xref="S3.p1.10.m4.3.3.3.cmml">(</mo><mi id="S3.p1.10.m4.1.1.1.1" xref="S3.p1.10.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.10.m4.1.1.1.3.2" xref="S3.p1.10.m4.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.p1.10.m4.3.3.2" xref="S3.p1.10.m4.3.3.2.cmml">=</mo><mrow id="S3.p1.10.m4.3.3.1" xref="S3.p1.10.m4.3.3.1.cmml"><mi id="S3.p1.10.m4.3.3.1.3" xref="S3.p1.10.m4.3.3.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m4.3.3.1.2" xref="S3.p1.10.m4.3.3.1.2.cmml">​</mo><mrow id="S3.p1.10.m4.3.3.1.1.1" xref="S3.p1.10.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.10.m4.3.3.1.1.1.2" xref="S3.p1.10.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.p1.10.m4.3.3.1.1.1.1" xref="S3.p1.10.m4.3.3.1.1.1.1.cmml"><msubsup id="S3.p1.10.m4.3.3.1.1.1.1.2" xref="S3.p1.10.m4.3.3.1.1.1.1.2.cmml"><mi id="S3.p1.10.m4.3.3.1.1.1.1.2.2.2" xref="S3.p1.10.m4.3.3.1.1.1.1.2.2.2.cmml">x</mi><mi id="S3.p1.10.m4.3.3.1.1.1.1.2.3" xref="S3.p1.10.m4.3.3.1.1.1.1.2.3.cmml">j</mi><mrow id="S3.p1.10.m4.2.2.1.3" xref="S3.p1.10.m4.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p1.10.m4.2.2.1.3.1" xref="S3.p1.10.m4.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.p1.10.m4.2.2.1.1" xref="S3.p1.10.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.10.m4.2.2.1.3.2" xref="S3.p1.10.m4.3.3.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo fence="false" id="S3.p1.10.m4.3.3.1.1.1.1.1" xref="S3.p1.10.m4.3.3.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.10.m4.3.3.1.1.1.1.3" xref="S3.p1.10.m4.3.3.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.p1.10.m4.3.3.1.1.1.1.3.2" xref="S3.p1.10.m4.3.3.1.1.1.1.3.2.cmml">Θ</mi><mi id="S3.p1.10.m4.3.3.1.1.1.1.3.3" xref="S3.p1.10.m4.3.3.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.p1.10.m4.3.3.1.1.1.3" xref="S3.p1.10.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m4.3b"><apply id="S3.p1.10.m4.3.3.cmml" xref="S3.p1.10.m4.3.3"><eq id="S3.p1.10.m4.3.3.2.cmml" xref="S3.p1.10.m4.3.3.2"></eq><apply id="S3.p1.10.m4.3.3.3.cmml" xref="S3.p1.10.m4.3.3.3"><csymbol cd="ambiguous" id="S3.p1.10.m4.3.3.3.1.cmml" xref="S3.p1.10.m4.3.3.3">subscript</csymbol><apply id="S3.p1.10.m4.3.3.3.2.cmml" xref="S3.p1.10.m4.3.3.3"><csymbol cd="ambiguous" id="S3.p1.10.m4.3.3.3.2.1.cmml" xref="S3.p1.10.m4.3.3.3">superscript</csymbol><apply id="S3.p1.10.m4.3.3.3.2.2.cmml" xref="S3.p1.10.m4.3.3.3.2.2"><ci id="S3.p1.10.m4.3.3.3.2.2.1.cmml" xref="S3.p1.10.m4.3.3.3.2.2.1">^</ci><ci id="S3.p1.10.m4.3.3.3.2.2.2.cmml" xref="S3.p1.10.m4.3.3.3.2.2.2">𝑦</ci></apply><ci id="S3.p1.10.m4.1.1.1.1.cmml" xref="S3.p1.10.m4.1.1.1.1">𝑖</ci></apply><ci id="S3.p1.10.m4.3.3.3.3.cmml" xref="S3.p1.10.m4.3.3.3.3">𝑗</ci></apply><apply id="S3.p1.10.m4.3.3.1.cmml" xref="S3.p1.10.m4.3.3.1"><times id="S3.p1.10.m4.3.3.1.2.cmml" xref="S3.p1.10.m4.3.3.1.2"></times><ci id="S3.p1.10.m4.3.3.1.3.cmml" xref="S3.p1.10.m4.3.3.1.3">𝑓</ci><apply id="S3.p1.10.m4.3.3.1.1.1.1.cmml" xref="S3.p1.10.m4.3.3.1.1.1"><csymbol cd="latexml" id="S3.p1.10.m4.3.3.1.1.1.1.1.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.10.m4.3.3.1.1.1.1.2.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.10.m4.3.3.1.1.1.1.2.1.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2">subscript</csymbol><apply id="S3.p1.10.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.10.m4.3.3.1.1.1.1.2.2.1.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.p1.10.m4.3.3.1.1.1.1.2.2.2.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2.2.2">𝑥</ci><ci id="S3.p1.10.m4.2.2.1.1.cmml" xref="S3.p1.10.m4.2.2.1.1">𝑖</ci></apply><ci id="S3.p1.10.m4.3.3.1.1.1.1.2.3.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.p1.10.m4.3.3.1.1.1.1.3.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.10.m4.3.3.1.1.1.1.3.1.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.10.m4.3.3.1.1.1.1.3.2.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.3.2">Θ</ci><ci id="S3.p1.10.m4.3.3.1.1.1.1.3.3.cmml" xref="S3.p1.10.m4.3.3.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m4.3c">\hat{y}^{(i)}_{j}=f(x^{(i)}_{j}|\Theta_{i})</annotation></semantics></math> parameterized by <math id="S3.p1.11.m5.1" class="ltx_Math" alttext="\Theta_{i}" display="inline"><semantics id="S3.p1.11.m5.1a"><msub id="S3.p1.11.m5.1.1" xref="S3.p1.11.m5.1.1.cmml"><mi mathvariant="normal" id="S3.p1.11.m5.1.1.2" xref="S3.p1.11.m5.1.1.2.cmml">Θ</mi><mi id="S3.p1.11.m5.1.1.3" xref="S3.p1.11.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.11.m5.1b"><apply id="S3.p1.11.m5.1.1.cmml" xref="S3.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m5.1.1.1.cmml" xref="S3.p1.11.m5.1.1">subscript</csymbol><ci id="S3.p1.11.m5.1.1.2.cmml" xref="S3.p1.11.m5.1.1.2">Θ</ci><ci id="S3.p1.11.m5.1.1.3.cmml" xref="S3.p1.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m5.1c">\Theta_{i}</annotation></semantics></math>. A straightforward approach to finding a domain agnostic model is to assume <math id="S3.p1.12.m6.1" class="ltx_Math" alttext="\Theta_{*}=\Theta_{1}=\Theta_{2}=\cdots=\Theta_{S}" display="inline"><semantics id="S3.p1.12.m6.1a"><mrow id="S3.p1.12.m6.1.1" xref="S3.p1.12.m6.1.1.cmml"><msub id="S3.p1.12.m6.1.1.2" xref="S3.p1.12.m6.1.1.2.cmml"><mi mathvariant="normal" id="S3.p1.12.m6.1.1.2.2" xref="S3.p1.12.m6.1.1.2.2.cmml">Θ</mi><mo id="S3.p1.12.m6.1.1.2.3" xref="S3.p1.12.m6.1.1.2.3.cmml">∗</mo></msub><mo id="S3.p1.12.m6.1.1.3" xref="S3.p1.12.m6.1.1.3.cmml">=</mo><msub id="S3.p1.12.m6.1.1.4" xref="S3.p1.12.m6.1.1.4.cmml"><mi mathvariant="normal" id="S3.p1.12.m6.1.1.4.2" xref="S3.p1.12.m6.1.1.4.2.cmml">Θ</mi><mn id="S3.p1.12.m6.1.1.4.3" xref="S3.p1.12.m6.1.1.4.3.cmml">1</mn></msub><mo id="S3.p1.12.m6.1.1.5" xref="S3.p1.12.m6.1.1.5.cmml">=</mo><msub id="S3.p1.12.m6.1.1.6" xref="S3.p1.12.m6.1.1.6.cmml"><mi mathvariant="normal" id="S3.p1.12.m6.1.1.6.2" xref="S3.p1.12.m6.1.1.6.2.cmml">Θ</mi><mn id="S3.p1.12.m6.1.1.6.3" xref="S3.p1.12.m6.1.1.6.3.cmml">2</mn></msub><mo id="S3.p1.12.m6.1.1.7" xref="S3.p1.12.m6.1.1.7.cmml">=</mo><mi mathvariant="normal" id="S3.p1.12.m6.1.1.8" xref="S3.p1.12.m6.1.1.8.cmml">⋯</mi><mo id="S3.p1.12.m6.1.1.9" xref="S3.p1.12.m6.1.1.9.cmml">=</mo><msub id="S3.p1.12.m6.1.1.10" xref="S3.p1.12.m6.1.1.10.cmml"><mi mathvariant="normal" id="S3.p1.12.m6.1.1.10.2" xref="S3.p1.12.m6.1.1.10.2.cmml">Θ</mi><mi id="S3.p1.12.m6.1.1.10.3" xref="S3.p1.12.m6.1.1.10.3.cmml">S</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.12.m6.1b"><apply id="S3.p1.12.m6.1.1.cmml" xref="S3.p1.12.m6.1.1"><and id="S3.p1.12.m6.1.1a.cmml" xref="S3.p1.12.m6.1.1"></and><apply id="S3.p1.12.m6.1.1b.cmml" xref="S3.p1.12.m6.1.1"><eq id="S3.p1.12.m6.1.1.3.cmml" xref="S3.p1.12.m6.1.1.3"></eq><apply id="S3.p1.12.m6.1.1.2.cmml" xref="S3.p1.12.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p1.12.m6.1.1.2.1.cmml" xref="S3.p1.12.m6.1.1.2">subscript</csymbol><ci id="S3.p1.12.m6.1.1.2.2.cmml" xref="S3.p1.12.m6.1.1.2.2">Θ</ci><times id="S3.p1.12.m6.1.1.2.3.cmml" xref="S3.p1.12.m6.1.1.2.3"></times></apply><apply id="S3.p1.12.m6.1.1.4.cmml" xref="S3.p1.12.m6.1.1.4"><csymbol cd="ambiguous" id="S3.p1.12.m6.1.1.4.1.cmml" xref="S3.p1.12.m6.1.1.4">subscript</csymbol><ci id="S3.p1.12.m6.1.1.4.2.cmml" xref="S3.p1.12.m6.1.1.4.2">Θ</ci><cn type="integer" id="S3.p1.12.m6.1.1.4.3.cmml" xref="S3.p1.12.m6.1.1.4.3">1</cn></apply></apply><apply id="S3.p1.12.m6.1.1c.cmml" xref="S3.p1.12.m6.1.1"><eq id="S3.p1.12.m6.1.1.5.cmml" xref="S3.p1.12.m6.1.1.5"></eq><share href="#S3.p1.12.m6.1.1.4.cmml" id="S3.p1.12.m6.1.1d.cmml" xref="S3.p1.12.m6.1.1"></share><apply id="S3.p1.12.m6.1.1.6.cmml" xref="S3.p1.12.m6.1.1.6"><csymbol cd="ambiguous" id="S3.p1.12.m6.1.1.6.1.cmml" xref="S3.p1.12.m6.1.1.6">subscript</csymbol><ci id="S3.p1.12.m6.1.1.6.2.cmml" xref="S3.p1.12.m6.1.1.6.2">Θ</ci><cn type="integer" id="S3.p1.12.m6.1.1.6.3.cmml" xref="S3.p1.12.m6.1.1.6.3">2</cn></apply></apply><apply id="S3.p1.12.m6.1.1e.cmml" xref="S3.p1.12.m6.1.1"><eq id="S3.p1.12.m6.1.1.7.cmml" xref="S3.p1.12.m6.1.1.7"></eq><share href="#S3.p1.12.m6.1.1.6.cmml" id="S3.p1.12.m6.1.1f.cmml" xref="S3.p1.12.m6.1.1"></share><ci id="S3.p1.12.m6.1.1.8.cmml" xref="S3.p1.12.m6.1.1.8">⋯</ci></apply><apply id="S3.p1.12.m6.1.1g.cmml" xref="S3.p1.12.m6.1.1"><eq id="S3.p1.12.m6.1.1.9.cmml" xref="S3.p1.12.m6.1.1.9"></eq><share href="#S3.p1.12.m6.1.1.8.cmml" id="S3.p1.12.m6.1.1h.cmml" xref="S3.p1.12.m6.1.1"></share><apply id="S3.p1.12.m6.1.1.10.cmml" xref="S3.p1.12.m6.1.1.10"><csymbol cd="ambiguous" id="S3.p1.12.m6.1.1.10.1.cmml" xref="S3.p1.12.m6.1.1.10">subscript</csymbol><ci id="S3.p1.12.m6.1.1.10.2.cmml" xref="S3.p1.12.m6.1.1.10.2">Θ</ci><ci id="S3.p1.12.m6.1.1.10.3.cmml" xref="S3.p1.12.m6.1.1.10.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m6.1c">\Theta_{*}=\Theta_{1}=\Theta_{2}=\cdots=\Theta_{S}</annotation></semantics></math>, i.e., there exists a universal model <math id="S3.p1.13.m7.1" class="ltx_Math" alttext="\Theta_{*}" display="inline"><semantics id="S3.p1.13.m7.1a"><msub id="S3.p1.13.m7.1.1" xref="S3.p1.13.m7.1.1.cmml"><mi mathvariant="normal" id="S3.p1.13.m7.1.1.2" xref="S3.p1.13.m7.1.1.2.cmml">Θ</mi><mo id="S3.p1.13.m7.1.1.3" xref="S3.p1.13.m7.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.p1.13.m7.1b"><apply id="S3.p1.13.m7.1.1.cmml" xref="S3.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m7.1.1.1.cmml" xref="S3.p1.13.m7.1.1">subscript</csymbol><ci id="S3.p1.13.m7.1.1.2.cmml" xref="S3.p1.13.m7.1.1.2">Θ</ci><times id="S3.p1.13.m7.1.1.3.cmml" xref="S3.p1.13.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m7.1c">\Theta_{*}</annotation></semantics></math>. Doing so we literally ignore the domain difference. Alternatively, Undo-Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> considers linear models, and assumes that the parameter (a <math id="S3.p1.14.m8.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.p1.14.m8.1a"><mi id="S3.p1.14.m8.1.1" xref="S3.p1.14.m8.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.p1.14.m8.1b"><ci id="S3.p1.14.m8.1.1.cmml" xref="S3.p1.14.m8.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m8.1c">D</annotation></semantics></math>-dimensional vector when <math id="S3.p1.15.m9.1" class="ltx_Math" alttext="x\in\mathbb{R}^{D}" display="inline"><semantics id="S3.p1.15.m9.1a"><mrow id="S3.p1.15.m9.1.1" xref="S3.p1.15.m9.1.1.cmml"><mi id="S3.p1.15.m9.1.1.2" xref="S3.p1.15.m9.1.1.2.cmml">x</mi><mo id="S3.p1.15.m9.1.1.1" xref="S3.p1.15.m9.1.1.1.cmml">∈</mo><msup id="S3.p1.15.m9.1.1.3" xref="S3.p1.15.m9.1.1.3.cmml"><mi id="S3.p1.15.m9.1.1.3.2" xref="S3.p1.15.m9.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.15.m9.1.1.3.3" xref="S3.p1.15.m9.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.15.m9.1b"><apply id="S3.p1.15.m9.1.1.cmml" xref="S3.p1.15.m9.1.1"><in id="S3.p1.15.m9.1.1.1.cmml" xref="S3.p1.15.m9.1.1.1"></in><ci id="S3.p1.15.m9.1.1.2.cmml" xref="S3.p1.15.m9.1.1.2">𝑥</ci><apply id="S3.p1.15.m9.1.1.3.cmml" xref="S3.p1.15.m9.1.1.3"><csymbol cd="ambiguous" id="S3.p1.15.m9.1.1.3.1.cmml" xref="S3.p1.15.m9.1.1.3">superscript</csymbol><ci id="S3.p1.15.m9.1.1.3.2.cmml" xref="S3.p1.15.m9.1.1.3.2">ℝ</ci><ci id="S3.p1.15.m9.1.1.3.3.cmml" xref="S3.p1.15.m9.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m9.1c">x\in\mathbb{R}^{D}</annotation></semantics></math>) for the <math id="S3.p1.16.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.16.m10.1a"><mi id="S3.p1.16.m10.1.1" xref="S3.p1.16.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.16.m10.1b"><ci id="S3.p1.16.m10.1.1.cmml" xref="S3.p1.16.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m10.1c">i</annotation></semantics></math>th domain is in the form <math id="S3.p1.17.m11.3" class="ltx_Math" alttext="\Theta^{(i)}=\Theta^{(0)}+\Delta^{(i)}" display="inline"><semantics id="S3.p1.17.m11.3a"><mrow id="S3.p1.17.m11.3.4" xref="S3.p1.17.m11.3.4.cmml"><msup id="S3.p1.17.m11.3.4.2" xref="S3.p1.17.m11.3.4.2.cmml"><mi mathvariant="normal" id="S3.p1.17.m11.3.4.2.2" xref="S3.p1.17.m11.3.4.2.2.cmml">Θ</mi><mrow id="S3.p1.17.m11.1.1.1.3" xref="S3.p1.17.m11.3.4.2.cmml"><mo stretchy="false" id="S3.p1.17.m11.1.1.1.3.1" xref="S3.p1.17.m11.3.4.2.cmml">(</mo><mi id="S3.p1.17.m11.1.1.1.1" xref="S3.p1.17.m11.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.17.m11.1.1.1.3.2" xref="S3.p1.17.m11.3.4.2.cmml">)</mo></mrow></msup><mo id="S3.p1.17.m11.3.4.1" xref="S3.p1.17.m11.3.4.1.cmml">=</mo><mrow id="S3.p1.17.m11.3.4.3" xref="S3.p1.17.m11.3.4.3.cmml"><msup id="S3.p1.17.m11.3.4.3.2" xref="S3.p1.17.m11.3.4.3.2.cmml"><mi mathvariant="normal" id="S3.p1.17.m11.3.4.3.2.2" xref="S3.p1.17.m11.3.4.3.2.2.cmml">Θ</mi><mrow id="S3.p1.17.m11.2.2.1.3" xref="S3.p1.17.m11.3.4.3.2.cmml"><mo stretchy="false" id="S3.p1.17.m11.2.2.1.3.1" xref="S3.p1.17.m11.3.4.3.2.cmml">(</mo><mn id="S3.p1.17.m11.2.2.1.1" xref="S3.p1.17.m11.2.2.1.1.cmml">0</mn><mo stretchy="false" id="S3.p1.17.m11.2.2.1.3.2" xref="S3.p1.17.m11.3.4.3.2.cmml">)</mo></mrow></msup><mo id="S3.p1.17.m11.3.4.3.1" xref="S3.p1.17.m11.3.4.3.1.cmml">+</mo><msup id="S3.p1.17.m11.3.4.3.3" xref="S3.p1.17.m11.3.4.3.3.cmml"><mi mathvariant="normal" id="S3.p1.17.m11.3.4.3.3.2" xref="S3.p1.17.m11.3.4.3.3.2.cmml">Δ</mi><mrow id="S3.p1.17.m11.3.3.1.3" xref="S3.p1.17.m11.3.4.3.3.cmml"><mo stretchy="false" id="S3.p1.17.m11.3.3.1.3.1" xref="S3.p1.17.m11.3.4.3.3.cmml">(</mo><mi id="S3.p1.17.m11.3.3.1.1" xref="S3.p1.17.m11.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.17.m11.3.3.1.3.2" xref="S3.p1.17.m11.3.4.3.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.17.m11.3b"><apply id="S3.p1.17.m11.3.4.cmml" xref="S3.p1.17.m11.3.4"><eq id="S3.p1.17.m11.3.4.1.cmml" xref="S3.p1.17.m11.3.4.1"></eq><apply id="S3.p1.17.m11.3.4.2.cmml" xref="S3.p1.17.m11.3.4.2"><csymbol cd="ambiguous" id="S3.p1.17.m11.3.4.2.1.cmml" xref="S3.p1.17.m11.3.4.2">superscript</csymbol><ci id="S3.p1.17.m11.3.4.2.2.cmml" xref="S3.p1.17.m11.3.4.2.2">Θ</ci><ci id="S3.p1.17.m11.1.1.1.1.cmml" xref="S3.p1.17.m11.1.1.1.1">𝑖</ci></apply><apply id="S3.p1.17.m11.3.4.3.cmml" xref="S3.p1.17.m11.3.4.3"><plus id="S3.p1.17.m11.3.4.3.1.cmml" xref="S3.p1.17.m11.3.4.3.1"></plus><apply id="S3.p1.17.m11.3.4.3.2.cmml" xref="S3.p1.17.m11.3.4.3.2"><csymbol cd="ambiguous" id="S3.p1.17.m11.3.4.3.2.1.cmml" xref="S3.p1.17.m11.3.4.3.2">superscript</csymbol><ci id="S3.p1.17.m11.3.4.3.2.2.cmml" xref="S3.p1.17.m11.3.4.3.2.2">Θ</ci><cn type="integer" id="S3.p1.17.m11.2.2.1.1.cmml" xref="S3.p1.17.m11.2.2.1.1">0</cn></apply><apply id="S3.p1.17.m11.3.4.3.3.cmml" xref="S3.p1.17.m11.3.4.3.3"><csymbol cd="ambiguous" id="S3.p1.17.m11.3.4.3.3.1.cmml" xref="S3.p1.17.m11.3.4.3.3">superscript</csymbol><ci id="S3.p1.17.m11.3.4.3.3.2.cmml" xref="S3.p1.17.m11.3.4.3.3.2">Δ</ci><ci id="S3.p1.17.m11.3.3.1.1.cmml" xref="S3.p1.17.m11.3.3.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m11.3c">\Theta^{(i)}=\Theta^{(0)}+\Delta^{(i)}</annotation></semantics></math>, where <math id="S3.p1.18.m12.1" class="ltx_Math" alttext="\Theta^{(0)}" display="inline"><semantics id="S3.p1.18.m12.1a"><msup id="S3.p1.18.m12.1.2" xref="S3.p1.18.m12.1.2.cmml"><mi mathvariant="normal" id="S3.p1.18.m12.1.2.2" xref="S3.p1.18.m12.1.2.2.cmml">Θ</mi><mrow id="S3.p1.18.m12.1.1.1.3" xref="S3.p1.18.m12.1.2.cmml"><mo stretchy="false" id="S3.p1.18.m12.1.1.1.3.1" xref="S3.p1.18.m12.1.2.cmml">(</mo><mn id="S3.p1.18.m12.1.1.1.1" xref="S3.p1.18.m12.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.p1.18.m12.1.1.1.3.2" xref="S3.p1.18.m12.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.18.m12.1b"><apply id="S3.p1.18.m12.1.2.cmml" xref="S3.p1.18.m12.1.2"><csymbol cd="ambiguous" id="S3.p1.18.m12.1.2.1.cmml" xref="S3.p1.18.m12.1.2">superscript</csymbol><ci id="S3.p1.18.m12.1.2.2.cmml" xref="S3.p1.18.m12.1.2.2">Θ</ci><cn type="integer" id="S3.p1.18.m12.1.1.1.1.cmml" xref="S3.p1.18.m12.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m12.1c">\Theta^{(0)}</annotation></semantics></math> can be seen as a domain agnostic model that benefits all domains, and <math id="S3.p1.19.m13.1" class="ltx_Math" alttext="\Delta^{(i)}" display="inline"><semantics id="S3.p1.19.m13.1a"><msup id="S3.p1.19.m13.1.2" xref="S3.p1.19.m13.1.2.cmml"><mi mathvariant="normal" id="S3.p1.19.m13.1.2.2" xref="S3.p1.19.m13.1.2.2.cmml">Δ</mi><mrow id="S3.p1.19.m13.1.1.1.3" xref="S3.p1.19.m13.1.2.cmml"><mo stretchy="false" id="S3.p1.19.m13.1.1.1.3.1" xref="S3.p1.19.m13.1.2.cmml">(</mo><mi id="S3.p1.19.m13.1.1.1.1" xref="S3.p1.19.m13.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.19.m13.1.1.1.3.2" xref="S3.p1.19.m13.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.19.m13.1b"><apply id="S3.p1.19.m13.1.2.cmml" xref="S3.p1.19.m13.1.2"><csymbol cd="ambiguous" id="S3.p1.19.m13.1.2.1.cmml" xref="S3.p1.19.m13.1.2">superscript</csymbol><ci id="S3.p1.19.m13.1.2.2.cmml" xref="S3.p1.19.m13.1.2.2">Δ</ci><ci id="S3.p1.19.m13.1.1.1.1.cmml" xref="S3.p1.19.m13.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m13.1c">\Delta^{(i)}</annotation></semantics></math> is a domain specific bias term. Conceptually, <math id="S3.p1.20.m14.1" class="ltx_Math" alttext="\Theta^{(0)}" display="inline"><semantics id="S3.p1.20.m14.1a"><msup id="S3.p1.20.m14.1.2" xref="S3.p1.20.m14.1.2.cmml"><mi mathvariant="normal" id="S3.p1.20.m14.1.2.2" xref="S3.p1.20.m14.1.2.2.cmml">Θ</mi><mrow id="S3.p1.20.m14.1.1.1.3" xref="S3.p1.20.m14.1.2.cmml"><mo stretchy="false" id="S3.p1.20.m14.1.1.1.3.1" xref="S3.p1.20.m14.1.2.cmml">(</mo><mn id="S3.p1.20.m14.1.1.1.1" xref="S3.p1.20.m14.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.p1.20.m14.1.1.1.3.2" xref="S3.p1.20.m14.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.20.m14.1b"><apply id="S3.p1.20.m14.1.2.cmml" xref="S3.p1.20.m14.1.2"><csymbol cd="ambiguous" id="S3.p1.20.m14.1.2.1.cmml" xref="S3.p1.20.m14.1.2">superscript</csymbol><ci id="S3.p1.20.m14.1.2.2.cmml" xref="S3.p1.20.m14.1.2.2">Θ</ci><cn type="integer" id="S3.p1.20.m14.1.1.1.1.cmml" xref="S3.p1.20.m14.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.20.m14.1c">\Theta^{(0)}</annotation></semantics></math> can also serve as the classifier for any unseen domains. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> showed that (for linear models) <math id="S3.p1.21.m15.1" class="ltx_Math" alttext="\Theta^{(0)}" display="inline"><semantics id="S3.p1.21.m15.1a"><msup id="S3.p1.21.m15.1.2" xref="S3.p1.21.m15.1.2.cmml"><mi mathvariant="normal" id="S3.p1.21.m15.1.2.2" xref="S3.p1.21.m15.1.2.2.cmml">Θ</mi><mrow id="S3.p1.21.m15.1.1.1.3" xref="S3.p1.21.m15.1.2.cmml"><mo stretchy="false" id="S3.p1.21.m15.1.1.1.3.1" xref="S3.p1.21.m15.1.2.cmml">(</mo><mn id="S3.p1.21.m15.1.1.1.1" xref="S3.p1.21.m15.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.p1.21.m15.1.1.1.3.2" xref="S3.p1.21.m15.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.21.m15.1b"><apply id="S3.p1.21.m15.1.2.cmml" xref="S3.p1.21.m15.1.2"><csymbol cd="ambiguous" id="S3.p1.21.m15.1.2.1.cmml" xref="S3.p1.21.m15.1.2">superscript</csymbol><ci id="S3.p1.21.m15.1.2.2.cmml" xref="S3.p1.21.m15.1.2.2">Θ</ci><cn type="integer" id="S3.p1.21.m15.1.1.1.1.cmml" xref="S3.p1.21.m15.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.21.m15.1c">\Theta^{(0)}</annotation></semantics></math> is better than the universal model <math id="S3.p1.22.m16.1" class="ltx_Math" alttext="\Theta_{*}" display="inline"><semantics id="S3.p1.22.m16.1a"><msub id="S3.p1.22.m16.1.1" xref="S3.p1.22.m16.1.1.cmml"><mi mathvariant="normal" id="S3.p1.22.m16.1.1.2" xref="S3.p1.22.m16.1.1.2.cmml">Θ</mi><mo id="S3.p1.22.m16.1.1.3" xref="S3.p1.22.m16.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.p1.22.m16.1b"><apply id="S3.p1.22.m16.1.1.cmml" xref="S3.p1.22.m16.1.1"><csymbol cd="ambiguous" id="S3.p1.22.m16.1.1.1.cmml" xref="S3.p1.22.m16.1.1">subscript</csymbol><ci id="S3.p1.22.m16.1.1.2.cmml" xref="S3.p1.22.m16.1.1.2">Θ</ci><times id="S3.p1.22.m16.1.1.3.cmml" xref="S3.p1.22.m16.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.22.m16.1c">\Theta_{*}</annotation></semantics></math> trained by <math id="S3.p1.23.m17.4" class="ltx_Math" alttext="\underset{\Theta_{*}}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\Theta_{*}^{T}x^{(i)}_{j},y^{(i)}_{j})" display="inline"><semantics id="S3.p1.23.m17.4a"><mrow id="S3.p1.23.m17.4.4" xref="S3.p1.23.m17.4.4.cmml"><munder accentunder="true" id="S3.p1.23.m17.4.4.4" xref="S3.p1.23.m17.4.4.4.cmml"><mi id="S3.p1.23.m17.4.4.4.2" xref="S3.p1.23.m17.4.4.4.2.cmml">argmin</mi><msub id="S3.p1.23.m17.4.4.4.1" xref="S3.p1.23.m17.4.4.4.1.cmml"><mi mathvariant="normal" id="S3.p1.23.m17.4.4.4.1.2" xref="S3.p1.23.m17.4.4.4.1.2.cmml">Θ</mi><mo id="S3.p1.23.m17.4.4.4.1.3" xref="S3.p1.23.m17.4.4.4.1.3.cmml">∗</mo></msub></munder><mo lspace="0.167em" rspace="0em" id="S3.p1.23.m17.4.4.3" xref="S3.p1.23.m17.4.4.3.cmml">​</mo><mfrac id="S3.p1.23.m17.4.4.5" xref="S3.p1.23.m17.4.4.5.cmml"><mn id="S3.p1.23.m17.4.4.5.2" xref="S3.p1.23.m17.4.4.5.2.cmml">1</mn><mi id="S3.p1.23.m17.4.4.5.3" xref="S3.p1.23.m17.4.4.5.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.p1.23.m17.4.4.3a" xref="S3.p1.23.m17.4.4.3.cmml">​</mo><mrow id="S3.p1.23.m17.4.4.2" xref="S3.p1.23.m17.4.4.2.cmml"><msubsup id="S3.p1.23.m17.4.4.2.3" xref="S3.p1.23.m17.4.4.2.3.cmml"><mo id="S3.p1.23.m17.4.4.2.3.2.2" xref="S3.p1.23.m17.4.4.2.3.2.2.cmml">∑</mo><mrow id="S3.p1.23.m17.4.4.2.3.3" xref="S3.p1.23.m17.4.4.2.3.3.cmml"><mi id="S3.p1.23.m17.4.4.2.3.3.2" xref="S3.p1.23.m17.4.4.2.3.3.2.cmml">i</mi><mo id="S3.p1.23.m17.4.4.2.3.3.1" xref="S3.p1.23.m17.4.4.2.3.3.1.cmml">=</mo><mn id="S3.p1.23.m17.4.4.2.3.3.3" xref="S3.p1.23.m17.4.4.2.3.3.3.cmml">1</mn></mrow><mi id="S3.p1.23.m17.4.4.2.3.2.3" xref="S3.p1.23.m17.4.4.2.3.2.3.cmml">S</mi></msubsup><mrow id="S3.p1.23.m17.4.4.2.2" xref="S3.p1.23.m17.4.4.2.2.cmml"><mfrac id="S3.p1.23.m17.4.4.2.2.4" xref="S3.p1.23.m17.4.4.2.2.4.cmml"><mn id="S3.p1.23.m17.4.4.2.2.4.2" xref="S3.p1.23.m17.4.4.2.2.4.2.cmml">1</mn><msub id="S3.p1.23.m17.4.4.2.2.4.3" xref="S3.p1.23.m17.4.4.2.2.4.3.cmml"><mi id="S3.p1.23.m17.4.4.2.2.4.3.2" xref="S3.p1.23.m17.4.4.2.2.4.3.2.cmml">N</mi><mi id="S3.p1.23.m17.4.4.2.2.4.3.3" xref="S3.p1.23.m17.4.4.2.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.p1.23.m17.4.4.2.2.3" xref="S3.p1.23.m17.4.4.2.2.3.cmml">​</mo><mrow id="S3.p1.23.m17.4.4.2.2.2" xref="S3.p1.23.m17.4.4.2.2.2.cmml"><msubsup id="S3.p1.23.m17.4.4.2.2.2.3" xref="S3.p1.23.m17.4.4.2.2.2.3.cmml"><mo id="S3.p1.23.m17.4.4.2.2.2.3.2.2" xref="S3.p1.23.m17.4.4.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.p1.23.m17.4.4.2.2.2.3.3" xref="S3.p1.23.m17.4.4.2.2.2.3.3.cmml"><mi id="S3.p1.23.m17.4.4.2.2.2.3.3.2" xref="S3.p1.23.m17.4.4.2.2.2.3.3.2.cmml">j</mi><mo id="S3.p1.23.m17.4.4.2.2.2.3.3.1" xref="S3.p1.23.m17.4.4.2.2.2.3.3.1.cmml">=</mo><mn id="S3.p1.23.m17.4.4.2.2.2.3.3.3" xref="S3.p1.23.m17.4.4.2.2.2.3.3.3.cmml">1</mn></mrow><msub id="S3.p1.23.m17.4.4.2.2.2.3.2.3" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3.cmml"><mi id="S3.p1.23.m17.4.4.2.2.2.3.2.3.2" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3.2.cmml">N</mi><mi id="S3.p1.23.m17.4.4.2.2.2.3.2.3.3" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3.3.cmml">i</mi></msub></msubsup><mrow id="S3.p1.23.m17.4.4.2.2.2.2" xref="S3.p1.23.m17.4.4.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.p1.23.m17.4.4.2.2.2.2.4" xref="S3.p1.23.m17.4.4.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.p1.23.m17.4.4.2.2.2.2.3" xref="S3.p1.23.m17.4.4.2.2.2.2.3.cmml">​</mo><mrow id="S3.p1.23.m17.4.4.2.2.2.2.2.2" xref="S3.p1.23.m17.4.4.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.23.m17.4.4.2.2.2.2.2.2.3" xref="S3.p1.23.m17.4.4.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.cmml"><msubsup id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.2.cmml">Θ</mi><mo id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo><mi id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.3" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.1" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mi id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.3" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.3.cmml">j</mi><mrow id="S3.p1.23.m17.1.1.1.3" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p1.23.m17.1.1.1.3.1" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.p1.23.m17.1.1.1.1" xref="S3.p1.23.m17.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.23.m17.1.1.1.3.2" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.p1.23.m17.4.4.2.2.2.2.2.2.4" xref="S3.p1.23.m17.4.4.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.2" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.3" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.3.cmml">j</mi><mrow id="S3.p1.23.m17.2.2.1.3" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.p1.23.m17.2.2.1.3.1" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.cmml">(</mo><mi id="S3.p1.23.m17.2.2.1.1" xref="S3.p1.23.m17.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.p1.23.m17.2.2.1.3.2" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.p1.23.m17.4.4.2.2.2.2.2.2.5" xref="S3.p1.23.m17.4.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.23.m17.4b"><apply id="S3.p1.23.m17.4.4.cmml" xref="S3.p1.23.m17.4.4"><times id="S3.p1.23.m17.4.4.3.cmml" xref="S3.p1.23.m17.4.4.3"></times><apply id="S3.p1.23.m17.4.4.4.cmml" xref="S3.p1.23.m17.4.4.4"><apply id="S3.p1.23.m17.4.4.4.1.cmml" xref="S3.p1.23.m17.4.4.4.1"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.4.1.1.cmml" xref="S3.p1.23.m17.4.4.4.1">subscript</csymbol><ci id="S3.p1.23.m17.4.4.4.1.2.cmml" xref="S3.p1.23.m17.4.4.4.1.2">Θ</ci><times id="S3.p1.23.m17.4.4.4.1.3.cmml" xref="S3.p1.23.m17.4.4.4.1.3"></times></apply><ci id="S3.p1.23.m17.4.4.4.2.cmml" xref="S3.p1.23.m17.4.4.4.2">argmin</ci></apply><apply id="S3.p1.23.m17.4.4.5.cmml" xref="S3.p1.23.m17.4.4.5"><divide id="S3.p1.23.m17.4.4.5.1.cmml" xref="S3.p1.23.m17.4.4.5"></divide><cn type="integer" id="S3.p1.23.m17.4.4.5.2.cmml" xref="S3.p1.23.m17.4.4.5.2">1</cn><ci id="S3.p1.23.m17.4.4.5.3.cmml" xref="S3.p1.23.m17.4.4.5.3">𝑆</ci></apply><apply id="S3.p1.23.m17.4.4.2.cmml" xref="S3.p1.23.m17.4.4.2"><apply id="S3.p1.23.m17.4.4.2.3.cmml" xref="S3.p1.23.m17.4.4.2.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.3.1.cmml" xref="S3.p1.23.m17.4.4.2.3">subscript</csymbol><apply id="S3.p1.23.m17.4.4.2.3.2.cmml" xref="S3.p1.23.m17.4.4.2.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.3.2.1.cmml" xref="S3.p1.23.m17.4.4.2.3">superscript</csymbol><sum id="S3.p1.23.m17.4.4.2.3.2.2.cmml" xref="S3.p1.23.m17.4.4.2.3.2.2"></sum><ci id="S3.p1.23.m17.4.4.2.3.2.3.cmml" xref="S3.p1.23.m17.4.4.2.3.2.3">𝑆</ci></apply><apply id="S3.p1.23.m17.4.4.2.3.3.cmml" xref="S3.p1.23.m17.4.4.2.3.3"><eq id="S3.p1.23.m17.4.4.2.3.3.1.cmml" xref="S3.p1.23.m17.4.4.2.3.3.1"></eq><ci id="S3.p1.23.m17.4.4.2.3.3.2.cmml" xref="S3.p1.23.m17.4.4.2.3.3.2">𝑖</ci><cn type="integer" id="S3.p1.23.m17.4.4.2.3.3.3.cmml" xref="S3.p1.23.m17.4.4.2.3.3.3">1</cn></apply></apply><apply id="S3.p1.23.m17.4.4.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2"><times id="S3.p1.23.m17.4.4.2.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.3"></times><apply id="S3.p1.23.m17.4.4.2.2.4.cmml" xref="S3.p1.23.m17.4.4.2.2.4"><divide id="S3.p1.23.m17.4.4.2.2.4.1.cmml" xref="S3.p1.23.m17.4.4.2.2.4"></divide><cn type="integer" id="S3.p1.23.m17.4.4.2.2.4.2.cmml" xref="S3.p1.23.m17.4.4.2.2.4.2">1</cn><apply id="S3.p1.23.m17.4.4.2.2.4.3.cmml" xref="S3.p1.23.m17.4.4.2.2.4.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.4.3.1.cmml" xref="S3.p1.23.m17.4.4.2.2.4.3">subscript</csymbol><ci id="S3.p1.23.m17.4.4.2.2.4.3.2.cmml" xref="S3.p1.23.m17.4.4.2.2.4.3.2">𝑁</ci><ci id="S3.p1.23.m17.4.4.2.2.4.3.3.cmml" xref="S3.p1.23.m17.4.4.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.p1.23.m17.4.4.2.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2"><apply id="S3.p1.23.m17.4.4.2.2.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.2.3.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3">subscript</csymbol><apply id="S3.p1.23.m17.4.4.2.2.2.3.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.2.3.2.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3">superscript</csymbol><sum id="S3.p1.23.m17.4.4.2.2.2.3.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.2.2"></sum><apply id="S3.p1.23.m17.4.4.2.2.2.3.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.2.3.2.3.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3">subscript</csymbol><ci id="S3.p1.23.m17.4.4.2.2.2.3.2.3.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3.2">𝑁</ci><ci id="S3.p1.23.m17.4.4.2.2.2.3.2.3.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.p1.23.m17.4.4.2.2.2.3.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.3"><eq id="S3.p1.23.m17.4.4.2.2.2.3.3.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.3.1"></eq><ci id="S3.p1.23.m17.4.4.2.2.2.3.3.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.3.2">𝑗</ci><cn type="integer" id="S3.p1.23.m17.4.4.2.2.2.3.3.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.p1.23.m17.4.4.2.2.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2"><times id="S3.p1.23.m17.4.4.2.2.2.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.3"></times><ci id="S3.p1.23.m17.4.4.2.2.2.2.4.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.4">ℓ</ci><interval closure="open" id="S3.p1.23.m17.4.4.2.2.2.2.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2"><apply id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1"><times id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.1"></times><apply id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.2">Θ</ci><times id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.2.2">𝑥</ci><ci id="S3.p1.23.m17.1.1.1.1.cmml" xref="S3.p1.23.m17.1.1.1.1">𝑖</ci></apply><ci id="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.23.m17.3.3.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.p1.23.m17.2.2.1.1.cmml" xref="S3.p1.23.m17.2.2.1.1">𝑖</ci></apply><ci id="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.23.m17.4.4.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.23.m17.4c">\underset{\Theta_{*}}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\Theta_{*}^{T}x^{(i)}_{j},y^{(i)}_{j})</annotation></semantics></math> in terms of testing performance on unseen domains. However we show that for deep networks, a universal model <math id="S3.p1.24.m18.1" class="ltx_Math" alttext="f(x|\Theta_{*})" display="inline"><semantics id="S3.p1.24.m18.1a"><mrow id="S3.p1.24.m18.1.1" xref="S3.p1.24.m18.1.1.cmml"><mi id="S3.p1.24.m18.1.1.3" xref="S3.p1.24.m18.1.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.24.m18.1.1.2" xref="S3.p1.24.m18.1.1.2.cmml">​</mo><mrow id="S3.p1.24.m18.1.1.1.1" xref="S3.p1.24.m18.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.24.m18.1.1.1.1.2" xref="S3.p1.24.m18.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.24.m18.1.1.1.1.1" xref="S3.p1.24.m18.1.1.1.1.1.cmml"><mi id="S3.p1.24.m18.1.1.1.1.1.2" xref="S3.p1.24.m18.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.p1.24.m18.1.1.1.1.1.1" xref="S3.p1.24.m18.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.24.m18.1.1.1.1.1.3" xref="S3.p1.24.m18.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.p1.24.m18.1.1.1.1.1.3.2" xref="S3.p1.24.m18.1.1.1.1.1.3.2.cmml">Θ</mi><mo id="S3.p1.24.m18.1.1.1.1.1.3.3" xref="S3.p1.24.m18.1.1.1.1.1.3.3.cmml">∗</mo></msub></mrow><mo stretchy="false" id="S3.p1.24.m18.1.1.1.1.3" xref="S3.p1.24.m18.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.24.m18.1b"><apply id="S3.p1.24.m18.1.1.cmml" xref="S3.p1.24.m18.1.1"><times id="S3.p1.24.m18.1.1.2.cmml" xref="S3.p1.24.m18.1.1.2"></times><ci id="S3.p1.24.m18.1.1.3.cmml" xref="S3.p1.24.m18.1.1.3">𝑓</ci><apply id="S3.p1.24.m18.1.1.1.1.1.cmml" xref="S3.p1.24.m18.1.1.1.1"><csymbol cd="latexml" id="S3.p1.24.m18.1.1.1.1.1.1.cmml" xref="S3.p1.24.m18.1.1.1.1.1.1">conditional</csymbol><ci id="S3.p1.24.m18.1.1.1.1.1.2.cmml" xref="S3.p1.24.m18.1.1.1.1.1.2">𝑥</ci><apply id="S3.p1.24.m18.1.1.1.1.1.3.cmml" xref="S3.p1.24.m18.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.24.m18.1.1.1.1.1.3.1.cmml" xref="S3.p1.24.m18.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.24.m18.1.1.1.1.1.3.2.cmml" xref="S3.p1.24.m18.1.1.1.1.1.3.2">Θ</ci><times id="S3.p1.24.m18.1.1.1.1.1.3.3.cmml" xref="S3.p1.24.m18.1.1.1.1.1.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.24.m18.1c">f(x|\Theta_{*})</annotation></semantics></math> is a strong baseline that requires improved methodology to beat.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Parameterized Neural Network for DG</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.9" class="ltx_p">To extend the idea of Undo-Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> into the neural network context, it is more convenient to think <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\Theta^{(i)}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msup id="S3.SS1.p1.1.m1.1.2" xref="S3.SS1.p1.1.m1.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.2.2" xref="S3.SS1.p1.1.m1.1.2.2.cmml">Θ</mi><mrow id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p1.1.m1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.2">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.2.2">Θ</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\Theta^{(i)}</annotation></semantics></math> is <em id="S3.SS1.p1.9.1" class="ltx_emph ltx_font_italic">generated</em> from a function <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="g(z^{(i)}|\Theta)" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.cmml">​</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><msup id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.cmml">z</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.3.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.3.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S3.SS1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">Θ</mi></mrow><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><times id="S3.SS1.p1.2.m2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2"></times><ci id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3">𝑔</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝑖</ci></apply><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">Θ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">g(z^{(i)}|\Theta)</annotation></semantics></math> parameterized by <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi mathvariant="normal" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\Theta</annotation></semantics></math>. Here <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="z^{(i)}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.2" xref="S3.SS1.p1.4.m4.1.2.cmml"><mi id="S3.SS1.p1.4.m4.1.2.2" xref="S3.SS1.p1.4.m4.1.2.2.cmml">z</mi><mrow id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.3.1" xref="S3.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.2.cmml" xref="S3.SS1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.p1.4.m4.1.2">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.2.2">𝑧</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">z^{(i)}</annotation></semantics></math> is a binary vector encoding of the <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">i</annotation></semantics></math>th domain with two properties: (i) it is of length <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="S+1" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">S</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><plus id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></plus><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑆</ci><cn type="integer" id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">S+1</annotation></semantics></math> where <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">S</annotation></semantics></math> is the number of observed domains; (ii) it always has only two units activated (being one): the <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">i</annotation></semantics></math>th unit active for the <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">i</annotation></semantics></math>th domain and the last unit active for all domains. Formally, the objective function becomes,</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\underset{\Theta}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\hat{y}^{(i)}_{j},y^{(i)}_{j})" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><munder accentunder="true" id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mi id="S3.E2.m1.4.4.4.2" xref="S3.E2.m1.4.4.4.2.cmml">argmin</mi><mo id="S3.E2.m1.4.4.4.1" xref="S3.E2.m1.4.4.4.1.cmml">Θ</mo></munder><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.4.4.3" xref="S3.E2.m1.4.4.3.cmml">​</mo><mfrac id="S3.E2.m1.4.4.5" xref="S3.E2.m1.4.4.5.cmml"><mn id="S3.E2.m1.4.4.5.2" xref="S3.E2.m1.4.4.5.2.cmml">1</mn><mi id="S3.E2.m1.4.4.5.3" xref="S3.E2.m1.4.4.5.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.3a" xref="S3.E2.m1.4.4.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml"><munderover id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.2.3.2.2" xref="S3.E2.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.2.3.3" xref="S3.E2.m1.4.4.2.3.3.cmml"><mi id="S3.E2.m1.4.4.2.3.3.2" xref="S3.E2.m1.4.4.2.3.3.2.cmml">i</mi><mo id="S3.E2.m1.4.4.2.3.3.1" xref="S3.E2.m1.4.4.2.3.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.2.3.3.3" xref="S3.E2.m1.4.4.2.3.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.4.4.2.3.2.3" xref="S3.E2.m1.4.4.2.3.2.3.cmml">S</mi></munderover><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><mfrac id="S3.E2.m1.4.4.2.2.4" xref="S3.E2.m1.4.4.2.2.4.cmml"><mn id="S3.E2.m1.4.4.2.2.4.2" xref="S3.E2.m1.4.4.2.2.4.2.cmml">1</mn><msub id="S3.E2.m1.4.4.2.2.4.3" xref="S3.E2.m1.4.4.2.2.4.3.cmml"><mi id="S3.E2.m1.4.4.2.2.4.3.2" xref="S3.E2.m1.4.4.2.2.4.3.2.cmml">N</mi><mi id="S3.E2.m1.4.4.2.2.4.3.3" xref="S3.E2.m1.4.4.2.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.2.2.2.cmml"><munderover id="S3.E2.m1.4.4.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.2.2.2.3.2.2" xref="S3.E2.m1.4.4.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.2.2.2.3.3" xref="S3.E2.m1.4.4.2.2.2.3.3.cmml"><mi id="S3.E2.m1.4.4.2.2.2.3.3.2" xref="S3.E2.m1.4.4.2.2.2.3.3.2.cmml">j</mi><mo id="S3.E2.m1.4.4.2.2.2.3.3.1" xref="S3.E2.m1.4.4.2.2.2.3.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.2.2.2.3.3.3" xref="S3.E2.m1.4.4.2.2.2.3.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.4.4.2.2.2.3.2.3" xref="S3.E2.m1.4.4.2.2.2.3.2.3.cmml"><mi id="S3.E2.m1.4.4.2.2.2.3.2.3.2" xref="S3.E2.m1.4.4.2.2.2.3.2.3.2.cmml">N</mi><mi id="S3.E2.m1.4.4.2.2.2.3.2.3.3" xref="S3.E2.m1.4.4.2.2.2.3.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E2.m1.4.4.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.4.4.2.2.2.2.4" xref="S3.E2.m1.4.4.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.4.4.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.2.2.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.3.3.1.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml">j</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E2.m1.4.4.2.2.2.2.2.2.4" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.2.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.3.cmml">j</mi><mrow id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.3.1" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E2.m1.2.2.1.3.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E2.m1.4.4.2.2.2.2.2.2.5" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><times id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.3"></times><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><ci id="S3.E2.m1.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.1">Θ</ci><ci id="S3.E2.m1.4.4.4.2.cmml" xref="S3.E2.m1.4.4.4.2">argmin</ci></apply><apply id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4.5"><divide id="S3.E2.m1.4.4.5.1.cmml" xref="S3.E2.m1.4.4.5"></divide><cn type="integer" id="S3.E2.m1.4.4.5.2.cmml" xref="S3.E2.m1.4.4.5.2">1</cn><ci id="S3.E2.m1.4.4.5.3.cmml" xref="S3.E2.m1.4.4.5.3">𝑆</ci></apply><apply id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"><apply id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.3.1.cmml" xref="S3.E2.m1.4.4.2.3">subscript</csymbol><apply id="S3.E2.m1.4.4.2.3.2.cmml" xref="S3.E2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.3.2.1.cmml" xref="S3.E2.m1.4.4.2.3">superscript</csymbol><sum id="S3.E2.m1.4.4.2.3.2.2.cmml" xref="S3.E2.m1.4.4.2.3.2.2"></sum><ci id="S3.E2.m1.4.4.2.3.2.3.cmml" xref="S3.E2.m1.4.4.2.3.2.3">𝑆</ci></apply><apply id="S3.E2.m1.4.4.2.3.3.cmml" xref="S3.E2.m1.4.4.2.3.3"><eq id="S3.E2.m1.4.4.2.3.3.1.cmml" xref="S3.E2.m1.4.4.2.3.3.1"></eq><ci id="S3.E2.m1.4.4.2.3.3.2.cmml" xref="S3.E2.m1.4.4.2.3.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.4.4.2.3.3.3.cmml" xref="S3.E2.m1.4.4.2.3.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><times id="S3.E2.m1.4.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3"></times><apply id="S3.E2.m1.4.4.2.2.4.cmml" xref="S3.E2.m1.4.4.2.2.4"><divide id="S3.E2.m1.4.4.2.2.4.1.cmml" xref="S3.E2.m1.4.4.2.2.4"></divide><cn type="integer" id="S3.E2.m1.4.4.2.2.4.2.cmml" xref="S3.E2.m1.4.4.2.2.4.2">1</cn><apply id="S3.E2.m1.4.4.2.2.4.3.cmml" xref="S3.E2.m1.4.4.2.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.4.3.1.cmml" xref="S3.E2.m1.4.4.2.2.4.3">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.4.3.2.cmml" xref="S3.E2.m1.4.4.2.2.4.3.2">𝑁</ci><ci id="S3.E2.m1.4.4.2.2.4.3.3.cmml" xref="S3.E2.m1.4.4.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2"><apply id="S3.E2.m1.4.4.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.2.3">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.3.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.3">superscript</csymbol><sum id="S3.E2.m1.4.4.2.2.2.3.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.3.2.2"></sum><apply id="S3.E2.m1.4.4.2.2.2.3.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.3.2.3.1.cmml" xref="S3.E2.m1.4.4.2.2.2.3.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.3.2.3.2.cmml" xref="S3.E2.m1.4.4.2.2.2.3.2.3.2">𝑁</ci><ci id="S3.E2.m1.4.4.2.2.2.3.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.3.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3.3"><eq id="S3.E2.m1.4.4.2.2.2.3.3.1.cmml" xref="S3.E2.m1.4.4.2.2.2.3.3.1"></eq><ci id="S3.E2.m1.4.4.2.2.2.3.3.2.cmml" xref="S3.E2.m1.4.4.2.2.2.3.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.4.4.2.2.2.3.3.3.cmml" xref="S3.E2.m1.4.4.2.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2"><times id="S3.E2.m1.4.4.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.3"></times><ci id="S3.E2.m1.4.4.2.2.2.2.4.cmml" xref="S3.E2.m1.4.4.2.2.2.2.4">ℓ</ci><interval closure="open" id="S3.E2.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2"><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.E2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\underset{\Theta}{\operatorname{argmin}}\frac{1}{S}\sum^{S}_{i=1}\frac{1}{N_{i}}\sum^{N_{i}}_{j=1}\ell(\hat{y}^{(i)}_{j},y^{(i)}_{j})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">where <math id="S3.SS1.p3.1.m1.4" class="ltx_math_unparsed" alttext="\hat{y}^{(i)}_{j}=f(x^{(i)}_{j}|\Theta_{i})=f(x^{(i)}_{j}|g(z^{(i)}|\Theta))" display="inline"><semantics id="S3.SS1.p3.1.m1.4a"><mrow id="S3.SS1.p3.1.m1.4b"><msubsup id="S3.SS1.p3.1.m1.4.5"><mover accent="true" id="S3.SS1.p3.1.m1.4.5.2.2"><mi id="S3.SS1.p3.1.m1.4.5.2.2.2">y</mi><mo id="S3.SS1.p3.1.m1.4.5.2.2.1">^</mo></mover><mi id="S3.SS1.p3.1.m1.4.5.3">j</mi><mrow id="S3.SS1.p3.1.m1.1.1.1.3"><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.1.3.1">(</mo><mi id="S3.SS1.p3.1.m1.1.1.1.1">i</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.1.3.2">)</mo></mrow></msubsup><mo id="S3.SS1.p3.1.m1.4.6">=</mo><mi id="S3.SS1.p3.1.m1.4.7">f</mi><mrow id="S3.SS1.p3.1.m1.4.8"><mo stretchy="false" id="S3.SS1.p3.1.m1.4.8.1">(</mo><msubsup id="S3.SS1.p3.1.m1.4.8.2"><mi id="S3.SS1.p3.1.m1.4.8.2.2.2">x</mi><mi id="S3.SS1.p3.1.m1.4.8.2.3">j</mi><mrow id="S3.SS1.p3.1.m1.2.2.1.3"><mo stretchy="false" id="S3.SS1.p3.1.m1.2.2.1.3.1">(</mo><mi id="S3.SS1.p3.1.m1.2.2.1.1">i</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.2.2.1.3.2">)</mo></mrow></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS1.p3.1.m1.4.8.3">|</mo><msub id="S3.SS1.p3.1.m1.4.8.4"><mi mathvariant="normal" id="S3.SS1.p3.1.m1.4.8.4.2">Θ</mi><mi id="S3.SS1.p3.1.m1.4.8.4.3">i</mi></msub><mo stretchy="false" id="S3.SS1.p3.1.m1.4.8.5">)</mo></mrow><mo id="S3.SS1.p3.1.m1.4.9">=</mo><mi id="S3.SS1.p3.1.m1.4.10">f</mi><mrow id="S3.SS1.p3.1.m1.4.11"><mo stretchy="false" id="S3.SS1.p3.1.m1.4.11.1">(</mo><msubsup id="S3.SS1.p3.1.m1.4.11.2"><mi id="S3.SS1.p3.1.m1.4.11.2.2.2">x</mi><mi id="S3.SS1.p3.1.m1.4.11.2.3">j</mi><mrow id="S3.SS1.p3.1.m1.3.3.1.3"><mo stretchy="false" id="S3.SS1.p3.1.m1.3.3.1.3.1">(</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1">i</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.3.3.1.3.2">)</mo></mrow></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS1.p3.1.m1.4.11.3">|</mo><mi id="S3.SS1.p3.1.m1.4.11.4">g</mi><mrow id="S3.SS1.p3.1.m1.4.11.5"><mo stretchy="false" id="S3.SS1.p3.1.m1.4.11.5.1">(</mo><msup id="S3.SS1.p3.1.m1.4.11.5.2"><mi id="S3.SS1.p3.1.m1.4.11.5.2.2">z</mi><mrow id="S3.SS1.p3.1.m1.4.4.1.3"><mo stretchy="false" id="S3.SS1.p3.1.m1.4.4.1.3.1">(</mo><mi id="S3.SS1.p3.1.m1.4.4.1.1">i</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.4.4.1.3.2">)</mo></mrow></msup><mo fence="false" rspace="0.167em" stretchy="false" id="S3.SS1.p3.1.m1.4.11.5.3">|</mo><mi mathvariant="normal" id="S3.SS1.p3.1.m1.4.11.5.4">Θ</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.4.11.5.5">)</mo></mrow><mo stretchy="false" id="S3.SS1.p3.1.m1.4.11.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.4c">\hat{y}^{(i)}_{j}=f(x^{(i)}_{j}|\Theta_{i})=f(x^{(i)}_{j}|g(z^{(i)}|\Theta))</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.4" class="ltx_p">To reproduce Undo-Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, we can stack all parameters in a column-wise fashion to form <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi mathvariant="normal" id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\Theta</annotation></semantics></math>, i.e., <math id="S3.SS1.p4.2.m2.9" class="ltx_Math" alttext="\Theta=[\Delta^{(1)},\Delta^{(2)},\dots,\Delta^{(S)},\Theta^{(0)}]" display="inline"><semantics id="S3.SS1.p4.2.m2.9a"><mrow id="S3.SS1.p4.2.m2.9.9" xref="S3.SS1.p4.2.m2.9.9.cmml"><mi mathvariant="normal" id="S3.SS1.p4.2.m2.9.9.6" xref="S3.SS1.p4.2.m2.9.9.6.cmml">Θ</mi><mo id="S3.SS1.p4.2.m2.9.9.5" xref="S3.SS1.p4.2.m2.9.9.5.cmml">=</mo><mrow id="S3.SS1.p4.2.m2.9.9.4.4" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.9.9.4.4.5" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">[</mo><msup id="S3.SS1.p4.2.m2.6.6.1.1.1" xref="S3.SS1.p4.2.m2.6.6.1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p4.2.m2.6.6.1.1.1.2" xref="S3.SS1.p4.2.m2.6.6.1.1.1.2.cmml">Δ</mi><mrow id="S3.SS1.p4.2.m2.1.1.1.3" xref="S3.SS1.p4.2.m2.6.6.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.1.1.1.3.1" xref="S3.SS1.p4.2.m2.6.6.1.1.1.cmml">(</mo><mn id="S3.SS1.p4.2.m2.1.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS1.p4.2.m2.1.1.1.3.2" xref="S3.SS1.p4.2.m2.6.6.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p4.2.m2.9.9.4.4.6" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">,</mo><msup id="S3.SS1.p4.2.m2.7.7.2.2.2" xref="S3.SS1.p4.2.m2.7.7.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p4.2.m2.7.7.2.2.2.2" xref="S3.SS1.p4.2.m2.7.7.2.2.2.2.cmml">Δ</mi><mrow id="S3.SS1.p4.2.m2.2.2.1.3" xref="S3.SS1.p4.2.m2.7.7.2.2.2.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.2.2.1.3.1" xref="S3.SS1.p4.2.m2.7.7.2.2.2.cmml">(</mo><mn id="S3.SS1.p4.2.m2.2.2.1.1" xref="S3.SS1.p4.2.m2.2.2.1.1.cmml">2</mn><mo stretchy="false" id="S3.SS1.p4.2.m2.2.2.1.3.2" xref="S3.SS1.p4.2.m2.7.7.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p4.2.m2.9.9.4.4.7" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p4.2.m2.5.5" xref="S3.SS1.p4.2.m2.5.5.cmml">…</mi><mo id="S3.SS1.p4.2.m2.9.9.4.4.8" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">,</mo><msup id="S3.SS1.p4.2.m2.8.8.3.3.3" xref="S3.SS1.p4.2.m2.8.8.3.3.3.cmml"><mi mathvariant="normal" id="S3.SS1.p4.2.m2.8.8.3.3.3.2" xref="S3.SS1.p4.2.m2.8.8.3.3.3.2.cmml">Δ</mi><mrow id="S3.SS1.p4.2.m2.3.3.1.3" xref="S3.SS1.p4.2.m2.8.8.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.3.3.1.3.1" xref="S3.SS1.p4.2.m2.8.8.3.3.3.cmml">(</mo><mi id="S3.SS1.p4.2.m2.3.3.1.1" xref="S3.SS1.p4.2.m2.3.3.1.1.cmml">S</mi><mo stretchy="false" id="S3.SS1.p4.2.m2.3.3.1.3.2" xref="S3.SS1.p4.2.m2.8.8.3.3.3.cmml">)</mo></mrow></msup><mo id="S3.SS1.p4.2.m2.9.9.4.4.9" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">,</mo><msup id="S3.SS1.p4.2.m2.9.9.4.4.4" xref="S3.SS1.p4.2.m2.9.9.4.4.4.cmml"><mi mathvariant="normal" id="S3.SS1.p4.2.m2.9.9.4.4.4.2" xref="S3.SS1.p4.2.m2.9.9.4.4.4.2.cmml">Θ</mi><mrow id="S3.SS1.p4.2.m2.4.4.1.3" xref="S3.SS1.p4.2.m2.9.9.4.4.4.cmml"><mo stretchy="false" id="S3.SS1.p4.2.m2.4.4.1.3.1" xref="S3.SS1.p4.2.m2.9.9.4.4.4.cmml">(</mo><mn id="S3.SS1.p4.2.m2.4.4.1.1" xref="S3.SS1.p4.2.m2.4.4.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS1.p4.2.m2.4.4.1.3.2" xref="S3.SS1.p4.2.m2.9.9.4.4.4.cmml">)</mo></mrow></msup><mo stretchy="false" id="S3.SS1.p4.2.m2.9.9.4.4.10" xref="S3.SS1.p4.2.m2.9.9.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.9b"><apply id="S3.SS1.p4.2.m2.9.9.cmml" xref="S3.SS1.p4.2.m2.9.9"><eq id="S3.SS1.p4.2.m2.9.9.5.cmml" xref="S3.SS1.p4.2.m2.9.9.5"></eq><ci id="S3.SS1.p4.2.m2.9.9.6.cmml" xref="S3.SS1.p4.2.m2.9.9.6">Θ</ci><list id="S3.SS1.p4.2.m2.9.9.4.5.cmml" xref="S3.SS1.p4.2.m2.9.9.4.4"><apply id="S3.SS1.p4.2.m2.6.6.1.1.1.cmml" xref="S3.SS1.p4.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.6.6.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.6.6.1.1.1">superscript</csymbol><ci id="S3.SS1.p4.2.m2.6.6.1.1.1.2.cmml" xref="S3.SS1.p4.2.m2.6.6.1.1.1.2">Δ</ci><cn type="integer" id="S3.SS1.p4.2.m2.1.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1.1">1</cn></apply><apply id="S3.SS1.p4.2.m2.7.7.2.2.2.cmml" xref="S3.SS1.p4.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.7.7.2.2.2.1.cmml" xref="S3.SS1.p4.2.m2.7.7.2.2.2">superscript</csymbol><ci id="S3.SS1.p4.2.m2.7.7.2.2.2.2.cmml" xref="S3.SS1.p4.2.m2.7.7.2.2.2.2">Δ</ci><cn type="integer" id="S3.SS1.p4.2.m2.2.2.1.1.cmml" xref="S3.SS1.p4.2.m2.2.2.1.1">2</cn></apply><ci id="S3.SS1.p4.2.m2.5.5.cmml" xref="S3.SS1.p4.2.m2.5.5">…</ci><apply id="S3.SS1.p4.2.m2.8.8.3.3.3.cmml" xref="S3.SS1.p4.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.8.8.3.3.3.1.cmml" xref="S3.SS1.p4.2.m2.8.8.3.3.3">superscript</csymbol><ci id="S3.SS1.p4.2.m2.8.8.3.3.3.2.cmml" xref="S3.SS1.p4.2.m2.8.8.3.3.3.2">Δ</ci><ci id="S3.SS1.p4.2.m2.3.3.1.1.cmml" xref="S3.SS1.p4.2.m2.3.3.1.1">𝑆</ci></apply><apply id="S3.SS1.p4.2.m2.9.9.4.4.4.cmml" xref="S3.SS1.p4.2.m2.9.9.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.9.9.4.4.4.1.cmml" xref="S3.SS1.p4.2.m2.9.9.4.4.4">superscript</csymbol><ci id="S3.SS1.p4.2.m2.9.9.4.4.4.2.cmml" xref="S3.SS1.p4.2.m2.9.9.4.4.4.2">Θ</ci><cn type="integer" id="S3.SS1.p4.2.m2.4.4.1.1.cmml" xref="S3.SS1.p4.2.m2.4.4.1.1">0</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.9c">\Theta=[\Delta^{(1)},\Delta^{(2)},\dots,\Delta^{(S)},\Theta^{(0)}]</annotation></semantics></math>, and choose the <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1.2" xref="S3.SS1.p4.3.m3.1.2.cmml"><mi id="S3.SS1.p4.3.m3.1.2.2" xref="S3.SS1.p4.3.m3.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.1.2.1" xref="S3.SS1.p4.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS1.p4.3.m3.1.2.3.2" xref="S3.SS1.p4.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.3.m3.1.2.3.2.1" xref="S3.SS1.p4.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p4.3.m3.1.2.3.2.2" xref="S3.SS1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.2.cmml" xref="S3.SS1.p4.3.m3.1.2"><times id="S3.SS1.p4.3.m3.1.2.1.cmml" xref="S3.SS1.p4.3.m3.1.2.1"></times><ci id="S3.SS1.p4.3.m3.1.2.2.cmml" xref="S3.SS1.p4.3.m3.1.2.2">𝑔</ci><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">g(\cdot)</annotation></semantics></math> function to be linear mapping: <math id="S3.SS1.p4.4.m4.3" class="ltx_Math" alttext="g(z^{(i)}|\Theta)=\Theta z^{(i)}" display="inline"><semantics id="S3.SS1.p4.4.m4.3a"><mrow id="S3.SS1.p4.4.m4.3.3" xref="S3.SS1.p4.4.m4.3.3.cmml"><mrow id="S3.SS1.p4.4.m4.3.3.1" xref="S3.SS1.p4.4.m4.3.3.1.cmml"><mi id="S3.SS1.p4.4.m4.3.3.1.3" xref="S3.SS1.p4.4.m4.3.3.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.3.3.1.2" xref="S3.SS1.p4.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS1.p4.4.m4.3.3.1.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p4.4.m4.3.3.1.1.1.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.4.m4.3.3.1.1.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml"><msup id="S3.SS1.p4.4.m4.3.3.1.1.1.1.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.2.cmml">z</mi><mrow id="S3.SS1.p4.4.m4.1.1.1.3" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.4.m4.1.1.1.3.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p4.4.m4.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p4.4.m4.1.1.1.3.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S3.SS1.p4.4.m4.3.3.1.1.1.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.1.cmml">|</mo><mi mathvariant="normal" id="S3.SS1.p4.4.m4.3.3.1.1.1.1.3" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.3.cmml">Θ</mi></mrow><mo stretchy="false" id="S3.SS1.p4.4.m4.3.3.1.1.1.3" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p4.4.m4.3.3.2" xref="S3.SS1.p4.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS1.p4.4.m4.3.3.3" xref="S3.SS1.p4.4.m4.3.3.3.cmml"><mi mathvariant="normal" id="S3.SS1.p4.4.m4.3.3.3.2" xref="S3.SS1.p4.4.m4.3.3.3.2.cmml">Θ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.3.3.3.1" xref="S3.SS1.p4.4.m4.3.3.3.1.cmml">​</mo><msup id="S3.SS1.p4.4.m4.3.3.3.3" xref="S3.SS1.p4.4.m4.3.3.3.3.cmml"><mi id="S3.SS1.p4.4.m4.3.3.3.3.2" xref="S3.SS1.p4.4.m4.3.3.3.3.2.cmml">z</mi><mrow id="S3.SS1.p4.4.m4.2.2.1.3" xref="S3.SS1.p4.4.m4.3.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p4.4.m4.2.2.1.3.1" xref="S3.SS1.p4.4.m4.3.3.3.3.cmml">(</mo><mi id="S3.SS1.p4.4.m4.2.2.1.1" xref="S3.SS1.p4.4.m4.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS1.p4.4.m4.2.2.1.3.2" xref="S3.SS1.p4.4.m4.3.3.3.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.3b"><apply id="S3.SS1.p4.4.m4.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3"><eq id="S3.SS1.p4.4.m4.3.3.2.cmml" xref="S3.SS1.p4.4.m4.3.3.2"></eq><apply id="S3.SS1.p4.4.m4.3.3.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1"><times id="S3.SS1.p4.4.m4.3.3.1.2.cmml" xref="S3.SS1.p4.4.m4.3.3.1.2"></times><ci id="S3.SS1.p4.4.m4.3.3.1.3.cmml" xref="S3.SS1.p4.4.m4.3.3.1.3">𝑔</ci><apply id="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.p4.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.2.2">𝑧</ci><ci id="S3.SS1.p4.4.m4.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1">𝑖</ci></apply><ci id="S3.SS1.p4.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.3">Θ</ci></apply></apply><apply id="S3.SS1.p4.4.m4.3.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3.3"><times id="S3.SS1.p4.4.m4.3.3.3.1.cmml" xref="S3.SS1.p4.4.m4.3.3.3.1"></times><ci id="S3.SS1.p4.4.m4.3.3.3.2.cmml" xref="S3.SS1.p4.4.m4.3.3.3.2">Θ</ci><apply id="S3.SS1.p4.4.m4.3.3.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.3.3.3.3.1.cmml" xref="S3.SS1.p4.4.m4.3.3.3.3">superscript</csymbol><ci id="S3.SS1.p4.4.m4.3.3.3.3.2.cmml" xref="S3.SS1.p4.4.m4.3.3.3.3.2">𝑧</ci><ci id="S3.SS1.p4.4.m4.2.2.1.1.cmml" xref="S3.SS1.p4.4.m4.2.2.1.1">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.3c">g(z^{(i)}|\Theta)=\Theta z^{(i)}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.1" class="ltx_p"><span id="S3.SS1.p5.1.1" class="ltx_text ltx_font_bold">From linear to multi-linear</span> The method as described so far generates the model parameter in the form of <em id="S3.SS1.p5.1.2" class="ltx_emph ltx_font_italic">vector</em> thus it is only suitable for single-out setting (univariate regression or binary classification). To generate higher order parameters, we use a multi-linear model, where <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mi mathvariant="normal" id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\Theta</annotation></semantics></math> is (3rd order or higher) tensor. E.g., to generate a weighting matrix for a fully-connected layer in neural network, we can use</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.4" class="ltx_Math" alttext="W^{(i)}_{\text{FC}}=g(z^{(i)}|\mathcal{W})=\mathcal{W}\times_{3}z^{(i)}" display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><msubsup id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml"><mi id="S3.E3.m1.4.4.3.2.2" xref="S3.E3.m1.4.4.3.2.2.cmml">W</mi><mtext id="S3.E3.m1.4.4.3.3" xref="S3.E3.m1.4.4.3.3a.cmml">FC</mtext><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.4.4.3.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.3.1" xref="S3.E3.m1.4.4.3.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.4.4.3.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.4.4.cmml">=</mo><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.cmml"><mi id="S3.E3.m1.4.4.1.3" xref="S3.E3.m1.4.4.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.4.4.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.cmml"><msup id="S3.E3.m1.4.4.1.1.1.1.2" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.1.1.2.2" xref="S3.E3.m1.4.4.1.1.1.1.2.2.cmml">z</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.3.1" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S3.E3.m1.4.4.1.1.1.1.1" xref="S3.E3.m1.4.4.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.1.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.3.cmml">𝒲</mi></mrow><mo stretchy="false" id="S3.E3.m1.4.4.1.1.1.3" xref="S3.E3.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.5" xref="S3.E3.m1.4.4.5.cmml">=</mo><mrow id="S3.E3.m1.4.4.6" xref="S3.E3.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.6.2" xref="S3.E3.m1.4.4.6.2.cmml">𝒲</mi><msub id="S3.E3.m1.4.4.6.1" xref="S3.E3.m1.4.4.6.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.4.4.6.1.2" xref="S3.E3.m1.4.4.6.1.2.cmml">×</mo><mn id="S3.E3.m1.4.4.6.1.3" xref="S3.E3.m1.4.4.6.1.3.cmml">3</mn></msub><msup id="S3.E3.m1.4.4.6.3" xref="S3.E3.m1.4.4.6.3.cmml"><mi id="S3.E3.m1.4.4.6.3.2" xref="S3.E3.m1.4.4.6.3.2.cmml">z</mi><mrow id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.4.4.6.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.3.1" xref="S3.E3.m1.4.4.6.3.cmml">(</mo><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.E3.m1.3.3.1.3.2" xref="S3.E3.m1.4.4.6.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><and id="S3.E3.m1.4.4a.cmml" xref="S3.E3.m1.4.4"></and><apply id="S3.E3.m1.4.4b.cmml" xref="S3.E3.m1.4.4"><eq id="S3.E3.m1.4.4.4.cmml" xref="S3.E3.m1.4.4.4"></eq><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.1.cmml" xref="S3.E3.m1.4.4.3">subscript</csymbol><apply id="S3.E3.m1.4.4.3.2.cmml" xref="S3.E3.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.2.1.cmml" xref="S3.E3.m1.4.4.3">superscript</csymbol><ci id="S3.E3.m1.4.4.3.2.2.cmml" xref="S3.E3.m1.4.4.3.2.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.E3.m1.4.4.3.3a.cmml" xref="S3.E3.m1.4.4.3.3"><mtext mathsize="70%" id="S3.E3.m1.4.4.3.3.cmml" xref="S3.E3.m1.4.4.3.3">FC</mtext></ci></apply><apply id="S3.E3.m1.4.4.1.cmml" xref="S3.E3.m1.4.4.1"><times id="S3.E3.m1.4.4.1.2.cmml" xref="S3.E3.m1.4.4.1.2"></times><ci id="S3.E3.m1.4.4.1.3.cmml" xref="S3.E3.m1.4.4.1.3">𝑔</ci><apply id="S3.E3.m1.4.4.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S3.E3.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.1.1.2.2">𝑧</ci><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.E3.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.1.1.3">𝒲</ci></apply></apply></apply><apply id="S3.E3.m1.4.4c.cmml" xref="S3.E3.m1.4.4"><eq id="S3.E3.m1.4.4.5.cmml" xref="S3.E3.m1.4.4.5"></eq><share href="#S3.E3.m1.4.4.1.cmml" id="S3.E3.m1.4.4d.cmml" xref="S3.E3.m1.4.4"></share><apply id="S3.E3.m1.4.4.6.cmml" xref="S3.E3.m1.4.4.6"><apply id="S3.E3.m1.4.4.6.1.cmml" xref="S3.E3.m1.4.4.6.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.6.1.1.cmml" xref="S3.E3.m1.4.4.6.1">subscript</csymbol><times id="S3.E3.m1.4.4.6.1.2.cmml" xref="S3.E3.m1.4.4.6.1.2"></times><cn type="integer" id="S3.E3.m1.4.4.6.1.3.cmml" xref="S3.E3.m1.4.4.6.1.3">3</cn></apply><ci id="S3.E3.m1.4.4.6.2.cmml" xref="S3.E3.m1.4.4.6.2">𝒲</ci><apply id="S3.E3.m1.4.4.6.3.cmml" xref="S3.E3.m1.4.4.6.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.6.3.1.cmml" xref="S3.E3.m1.4.4.6.3">superscript</csymbol><ci id="S3.E3.m1.4.4.6.3.2.cmml" xref="S3.E3.m1.4.4.6.3.2">𝑧</ci><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">W^{(i)}_{\text{FC}}=g(z^{(i)}|\mathcal{W})=\mathcal{W}\times_{3}z^{(i)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.8" class="ltx_p">Here <math id="S3.SS1.p7.1.m1.1" class="ltx_Math" alttext="\times_{3}" display="inline"><semantics id="S3.SS1.p7.1.m1.1a"><msub id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml"><mo id="S3.SS1.p7.1.m1.1.1.2" xref="S3.SS1.p7.1.m1.1.1.2.cmml">×</mo><mn id="S3.SS1.p7.1.m1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><apply id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">subscript</csymbol><times id="S3.SS1.p7.1.m1.1.1.2.cmml" xref="S3.SS1.p7.1.m1.1.1.2"></times><cn type="integer" id="S3.SS1.p7.1.m1.1.1.3.cmml" xref="S3.SS1.p7.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">\times_{3}</annotation></semantics></math> is the inner product between tensor and vector along tensor’s <math id="S3.SS1.p7.2.m2.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS1.p7.2.m2.1a"><mn id="S3.SS1.p7.2.m2.1.1" xref="S3.SS1.p7.2.m2.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.1b"><cn type="integer" id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.1c">3</annotation></semantics></math>rd axis. For example if <math id="S3.SS1.p7.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS1.p7.3.m3.1a"><mi id="S3.SS1.p7.3.m3.1.1" xref="S3.SS1.p7.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.1b"><ci id="S3.SS1.p7.3.m3.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.1c">W</annotation></semantics></math> is the weight matrix of size <math id="S3.SS1.p7.4.m4.1" class="ltx_Math" alttext="H\times C" display="inline"><semantics id="S3.SS1.p7.4.m4.1a"><mrow id="S3.SS1.p7.4.m4.1.1" xref="S3.SS1.p7.4.m4.1.1.cmml"><mi id="S3.SS1.p7.4.m4.1.1.2" xref="S3.SS1.p7.4.m4.1.1.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p7.4.m4.1.1.1" xref="S3.SS1.p7.4.m4.1.1.1.cmml">×</mo><mi id="S3.SS1.p7.4.m4.1.1.3" xref="S3.SS1.p7.4.m4.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.4.m4.1b"><apply id="S3.SS1.p7.4.m4.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1"><times id="S3.SS1.p7.4.m4.1.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1.1"></times><ci id="S3.SS1.p7.4.m4.1.1.2.cmml" xref="S3.SS1.p7.4.m4.1.1.2">𝐻</ci><ci id="S3.SS1.p7.4.m4.1.1.3.cmml" xref="S3.SS1.p7.4.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.4.m4.1c">H\times C</annotation></semantics></math> (i.e., the number of input neurons is <math id="S3.SS1.p7.5.m5.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.p7.5.m5.1a"><mi id="S3.SS1.p7.5.m5.1.1" xref="S3.SS1.p7.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.5.m5.1b"><ci id="S3.SS1.p7.5.m5.1.1.cmml" xref="S3.SS1.p7.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.5.m5.1c">H</annotation></semantics></math> and the number of output neurons is <math id="S3.SS1.p7.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p7.6.m6.1a"><mi id="S3.SS1.p7.6.m6.1.1" xref="S3.SS1.p7.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.6.m6.1b"><ci id="S3.SS1.p7.6.m6.1.1.cmml" xref="S3.SS1.p7.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.6.m6.1c">C</annotation></semantics></math>) then <math id="S3.SS1.p7.7.m7.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS1.p7.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p7.7.m7.1.1" xref="S3.SS1.p7.7.m7.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.7.m7.1b"><ci id="S3.SS1.p7.7.m7.1.1.cmml" xref="S3.SS1.p7.7.m7.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.7.m7.1c">\mathcal{W}</annotation></semantics></math> is a <math id="S3.SS1.p7.8.m8.1" class="ltx_Math" alttext="H\times C\times(S+1)" display="inline"><semantics id="S3.SS1.p7.8.m8.1a"><mrow id="S3.SS1.p7.8.m8.1.1" xref="S3.SS1.p7.8.m8.1.1.cmml"><mi id="S3.SS1.p7.8.m8.1.1.3" xref="S3.SS1.p7.8.m8.1.1.3.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p7.8.m8.1.1.2" xref="S3.SS1.p7.8.m8.1.1.2.cmml">×</mo><mi id="S3.SS1.p7.8.m8.1.1.4" xref="S3.SS1.p7.8.m8.1.1.4.cmml">C</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p7.8.m8.1.1.2a" xref="S3.SS1.p7.8.m8.1.1.2.cmml">×</mo><mrow id="S3.SS1.p7.8.m8.1.1.1.1" xref="S3.SS1.p7.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p7.8.m8.1.1.1.1.2" xref="S3.SS1.p7.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p7.8.m8.1.1.1.1.1" xref="S3.SS1.p7.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS1.p7.8.m8.1.1.1.1.1.2" xref="S3.SS1.p7.8.m8.1.1.1.1.1.2.cmml">S</mi><mo id="S3.SS1.p7.8.m8.1.1.1.1.1.1" xref="S3.SS1.p7.8.m8.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p7.8.m8.1.1.1.1.1.3" xref="S3.SS1.p7.8.m8.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p7.8.m8.1.1.1.1.3" xref="S3.SS1.p7.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.8.m8.1b"><apply id="S3.SS1.p7.8.m8.1.1.cmml" xref="S3.SS1.p7.8.m8.1.1"><times id="S3.SS1.p7.8.m8.1.1.2.cmml" xref="S3.SS1.p7.8.m8.1.1.2"></times><ci id="S3.SS1.p7.8.m8.1.1.3.cmml" xref="S3.SS1.p7.8.m8.1.1.3">𝐻</ci><ci id="S3.SS1.p7.8.m8.1.1.4.cmml" xref="S3.SS1.p7.8.m8.1.1.4">𝐶</ci><apply id="S3.SS1.p7.8.m8.1.1.1.1.1.cmml" xref="S3.SS1.p7.8.m8.1.1.1.1"><plus id="S3.SS1.p7.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS1.p7.8.m8.1.1.1.1.1.1"></plus><ci id="S3.SS1.p7.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS1.p7.8.m8.1.1.1.1.1.2">𝑆</ci><cn type="integer" id="S3.SS1.p7.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS1.p7.8.m8.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.8.m8.1c">H\times C\times(S+1)</annotation></semantics></math> tensor.</p>
</div>
<div id="S3.SS1.p8" class="ltx_para ltx_noindent">
<p id="S3.SS1.p8.2" class="ltx_p">If we need to generate the parameter for a convolutional layer of size <math id="S3.SS1.p8.1.m1.1" class="ltx_Math" alttext="D_{1}\times D_{2}\times F_{1}\times F_{2}" display="inline"><semantics id="S3.SS1.p8.1.m1.1a"><mrow id="S3.SS1.p8.1.m1.1.1" xref="S3.SS1.p8.1.m1.1.1.cmml"><msub id="S3.SS1.p8.1.m1.1.1.2" xref="S3.SS1.p8.1.m1.1.1.2.cmml"><mi id="S3.SS1.p8.1.m1.1.1.2.2" xref="S3.SS1.p8.1.m1.1.1.2.2.cmml">D</mi><mn id="S3.SS1.p8.1.m1.1.1.2.3" xref="S3.SS1.p8.1.m1.1.1.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.1.m1.1.1.1" xref="S3.SS1.p8.1.m1.1.1.1.cmml">×</mo><msub id="S3.SS1.p8.1.m1.1.1.3" xref="S3.SS1.p8.1.m1.1.1.3.cmml"><mi id="S3.SS1.p8.1.m1.1.1.3.2" xref="S3.SS1.p8.1.m1.1.1.3.2.cmml">D</mi><mn id="S3.SS1.p8.1.m1.1.1.3.3" xref="S3.SS1.p8.1.m1.1.1.3.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.1.m1.1.1.1a" xref="S3.SS1.p8.1.m1.1.1.1.cmml">×</mo><msub id="S3.SS1.p8.1.m1.1.1.4" xref="S3.SS1.p8.1.m1.1.1.4.cmml"><mi id="S3.SS1.p8.1.m1.1.1.4.2" xref="S3.SS1.p8.1.m1.1.1.4.2.cmml">F</mi><mn id="S3.SS1.p8.1.m1.1.1.4.3" xref="S3.SS1.p8.1.m1.1.1.4.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.1.m1.1.1.1b" xref="S3.SS1.p8.1.m1.1.1.1.cmml">×</mo><msub id="S3.SS1.p8.1.m1.1.1.5" xref="S3.SS1.p8.1.m1.1.1.5.cmml"><mi id="S3.SS1.p8.1.m1.1.1.5.2" xref="S3.SS1.p8.1.m1.1.1.5.2.cmml">F</mi><mn id="S3.SS1.p8.1.m1.1.1.5.3" xref="S3.SS1.p8.1.m1.1.1.5.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.m1.1b"><apply id="S3.SS1.p8.1.m1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1"><times id="S3.SS1.p8.1.m1.1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1.1"></times><apply id="S3.SS1.p8.1.m1.1.1.2.cmml" xref="S3.SS1.p8.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.2.1.cmml" xref="S3.SS1.p8.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.2.2.cmml" xref="S3.SS1.p8.1.m1.1.1.2.2">𝐷</ci><cn type="integer" id="S3.SS1.p8.1.m1.1.1.2.3.cmml" xref="S3.SS1.p8.1.m1.1.1.2.3">1</cn></apply><apply id="S3.SS1.p8.1.m1.1.1.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.3.1.cmml" xref="S3.SS1.p8.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.3.2.cmml" xref="S3.SS1.p8.1.m1.1.1.3.2">𝐷</ci><cn type="integer" id="S3.SS1.p8.1.m1.1.1.3.3.cmml" xref="S3.SS1.p8.1.m1.1.1.3.3">2</cn></apply><apply id="S3.SS1.p8.1.m1.1.1.4.cmml" xref="S3.SS1.p8.1.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.4.1.cmml" xref="S3.SS1.p8.1.m1.1.1.4">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.4.2.cmml" xref="S3.SS1.p8.1.m1.1.1.4.2">𝐹</ci><cn type="integer" id="S3.SS1.p8.1.m1.1.1.4.3.cmml" xref="S3.SS1.p8.1.m1.1.1.4.3">1</cn></apply><apply id="S3.SS1.p8.1.m1.1.1.5.cmml" xref="S3.SS1.p8.1.m1.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p8.1.m1.1.1.5.1.cmml" xref="S3.SS1.p8.1.m1.1.1.5">subscript</csymbol><ci id="S3.SS1.p8.1.m1.1.1.5.2.cmml" xref="S3.SS1.p8.1.m1.1.1.5.2">𝐹</ci><cn type="integer" id="S3.SS1.p8.1.m1.1.1.5.3.cmml" xref="S3.SS1.p8.1.m1.1.1.5.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.m1.1c">D_{1}\times D_{2}\times F_{1}\times F_{2}</annotation></semantics></math> (<math id="S3.SS1.p8.2.m2.1" class="ltx_Math" alttext="\text{Height}\times\text{Width}\times\text{Depth}\times\text{Filter Number}" display="inline"><semantics id="S3.SS1.p8.2.m2.1a"><mrow id="S3.SS1.p8.2.m2.1.1" xref="S3.SS1.p8.2.m2.1.1.cmml"><mtext id="S3.SS1.p8.2.m2.1.1.2" xref="S3.SS1.p8.2.m2.1.1.2a.cmml">Height</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.2.m2.1.1.1" xref="S3.SS1.p8.2.m2.1.1.1.cmml">×</mo><mtext id="S3.SS1.p8.2.m2.1.1.3" xref="S3.SS1.p8.2.m2.1.1.3a.cmml">Width</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.2.m2.1.1.1a" xref="S3.SS1.p8.2.m2.1.1.1.cmml">×</mo><mtext id="S3.SS1.p8.2.m2.1.1.4" xref="S3.SS1.p8.2.m2.1.1.4a.cmml">Depth</mtext><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.2.m2.1.1.1b" xref="S3.SS1.p8.2.m2.1.1.1.cmml">×</mo><mtext id="S3.SS1.p8.2.m2.1.1.5" xref="S3.SS1.p8.2.m2.1.1.5a.cmml">Filter Number</mtext></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.m2.1b"><apply id="S3.SS1.p8.2.m2.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1"><times id="S3.SS1.p8.2.m2.1.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1.1"></times><ci id="S3.SS1.p8.2.m2.1.1.2a.cmml" xref="S3.SS1.p8.2.m2.1.1.2"><mtext id="S3.SS1.p8.2.m2.1.1.2.cmml" xref="S3.SS1.p8.2.m2.1.1.2">Height</mtext></ci><ci id="S3.SS1.p8.2.m2.1.1.3a.cmml" xref="S3.SS1.p8.2.m2.1.1.3"><mtext id="S3.SS1.p8.2.m2.1.1.3.cmml" xref="S3.SS1.p8.2.m2.1.1.3">Width</mtext></ci><ci id="S3.SS1.p8.2.m2.1.1.4a.cmml" xref="S3.SS1.p8.2.m2.1.1.4"><mtext id="S3.SS1.p8.2.m2.1.1.4.cmml" xref="S3.SS1.p8.2.m2.1.1.4">Depth</mtext></ci><ci id="S3.SS1.p8.2.m2.1.1.5a.cmml" xref="S3.SS1.p8.2.m2.1.1.5"><mtext id="S3.SS1.p8.2.m2.1.1.5.cmml" xref="S3.SS1.p8.2.m2.1.1.5">Filter Number</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.m2.1c">\text{Height}\times\text{Width}\times\text{Depth}\times\text{Filter Number}</annotation></semantics></math>), then we use:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\mathcal{W}^{(i)}_{\text{CONV}}=g(z^{(i)}|\mathcal{W})=\mathcal{W}\times_{5}z^{(i)}" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msubsup id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.3.2.2" xref="S3.E4.m1.4.4.3.2.2.cmml">𝒲</mi><mtext id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3a.cmml">CONV</mtext><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.4.4.3.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.4.4.3.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.4.4.3.cmml">)</mo></mrow></msubsup><mo id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml">=</mo><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.cmml"><mi id="S3.E4.m1.4.4.1.3" xref="S3.E4.m1.4.4.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><msup id="S3.E4.m1.4.4.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.cmml">z</mi><mrow id="S3.E4.m1.2.2.1.3" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.3.1" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.3.cmml">𝒲</mi></mrow><mo stretchy="false" id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.5" xref="S3.E4.m1.4.4.5.cmml">=</mo><mrow id="S3.E4.m1.4.4.6" xref="S3.E4.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.6.2" xref="S3.E4.m1.4.4.6.2.cmml">𝒲</mi><msub id="S3.E4.m1.4.4.6.1" xref="S3.E4.m1.4.4.6.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.4.4.6.1.2" xref="S3.E4.m1.4.4.6.1.2.cmml">×</mo><mn id="S3.E4.m1.4.4.6.1.3" xref="S3.E4.m1.4.4.6.1.3.cmml">5</mn></msub><msup id="S3.E4.m1.4.4.6.3" xref="S3.E4.m1.4.4.6.3.cmml"><mi id="S3.E4.m1.4.4.6.3.2" xref="S3.E4.m1.4.4.6.3.2.cmml">z</mi><mrow id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.4.4.6.3.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.3.1" xref="S3.E4.m1.4.4.6.3.cmml">(</mo><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.3.2" xref="S3.E4.m1.4.4.6.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><and id="S3.E4.m1.4.4a.cmml" xref="S3.E4.m1.4.4"></and><apply id="S3.E4.m1.4.4b.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"></eq><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3">subscript</csymbol><apply id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.2.1.cmml" xref="S3.E4.m1.4.4.3">superscript</csymbol><ci id="S3.E4.m1.4.4.3.2.2.cmml" xref="S3.E4.m1.4.4.3.2.2">𝒲</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci></apply><ci id="S3.E4.m1.4.4.3.3a.cmml" xref="S3.E4.m1.4.4.3.3"><mtext mathsize="70%" id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3">CONV</mtext></ci></apply><apply id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4.1"><times id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.2"></times><ci id="S3.E4.m1.4.4.1.3.cmml" xref="S3.E4.m1.4.4.1.3">𝑔</ci><apply id="S3.E4.m1.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2">𝑧</ci><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3">𝒲</ci></apply></apply></apply><apply id="S3.E4.m1.4.4c.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.5.cmml" xref="S3.E4.m1.4.4.5"></eq><share href="#S3.E4.m1.4.4.1.cmml" id="S3.E4.m1.4.4d.cmml" xref="S3.E4.m1.4.4"></share><apply id="S3.E4.m1.4.4.6.cmml" xref="S3.E4.m1.4.4.6"><apply id="S3.E4.m1.4.4.6.1.cmml" xref="S3.E4.m1.4.4.6.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.6.1.1.cmml" xref="S3.E4.m1.4.4.6.1">subscript</csymbol><times id="S3.E4.m1.4.4.6.1.2.cmml" xref="S3.E4.m1.4.4.6.1.2"></times><cn type="integer" id="S3.E4.m1.4.4.6.1.3.cmml" xref="S3.E4.m1.4.4.6.1.3">5</cn></apply><ci id="S3.E4.m1.4.4.6.2.cmml" xref="S3.E4.m1.4.4.6.2">𝒲</ci><apply id="S3.E4.m1.4.4.6.3.cmml" xref="S3.E4.m1.4.4.6.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.6.3.1.cmml" xref="S3.E4.m1.4.4.6.3">superscript</csymbol><ci id="S3.E4.m1.4.4.6.3.2.cmml" xref="S3.E4.m1.4.4.6.3.2">𝑧</ci><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathcal{W}^{(i)}_{\text{CONV}}=g(z^{(i)}|\mathcal{W})=\mathcal{W}\times_{5}z^{(i)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p8.5" class="ltx_p">where <math id="S3.SS1.p8.3.m1.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS1.p8.3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p8.3.m1.1.1" xref="S3.SS1.p8.3.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.3.m1.1b"><ci id="S3.SS1.p8.3.m1.1.1.cmml" xref="S3.SS1.p8.3.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.3.m1.1c">\mathcal{W}</annotation></semantics></math> is a <math id="S3.SS1.p8.4.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S3.SS1.p8.4.m2.1a"><mn id="S3.SS1.p8.4.m2.1.1" xref="S3.SS1.p8.4.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.4.m2.1b"><cn type="integer" id="S3.SS1.p8.4.m2.1.1.cmml" xref="S3.SS1.p8.4.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.4.m2.1c">5</annotation></semantics></math>th order tensor of size <math id="S3.SS1.p8.5.m3.1" class="ltx_Math" alttext="D_{1}\times D_{2}\times F_{1}\times F_{2}\times(S+1)" display="inline"><semantics id="S3.SS1.p8.5.m3.1a"><mrow id="S3.SS1.p8.5.m3.1.1" xref="S3.SS1.p8.5.m3.1.1.cmml"><msub id="S3.SS1.p8.5.m3.1.1.3" xref="S3.SS1.p8.5.m3.1.1.3.cmml"><mi id="S3.SS1.p8.5.m3.1.1.3.2" xref="S3.SS1.p8.5.m3.1.1.3.2.cmml">D</mi><mn id="S3.SS1.p8.5.m3.1.1.3.3" xref="S3.SS1.p8.5.m3.1.1.3.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.5.m3.1.1.2" xref="S3.SS1.p8.5.m3.1.1.2.cmml">×</mo><msub id="S3.SS1.p8.5.m3.1.1.4" xref="S3.SS1.p8.5.m3.1.1.4.cmml"><mi id="S3.SS1.p8.5.m3.1.1.4.2" xref="S3.SS1.p8.5.m3.1.1.4.2.cmml">D</mi><mn id="S3.SS1.p8.5.m3.1.1.4.3" xref="S3.SS1.p8.5.m3.1.1.4.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.5.m3.1.1.2a" xref="S3.SS1.p8.5.m3.1.1.2.cmml">×</mo><msub id="S3.SS1.p8.5.m3.1.1.5" xref="S3.SS1.p8.5.m3.1.1.5.cmml"><mi id="S3.SS1.p8.5.m3.1.1.5.2" xref="S3.SS1.p8.5.m3.1.1.5.2.cmml">F</mi><mn id="S3.SS1.p8.5.m3.1.1.5.3" xref="S3.SS1.p8.5.m3.1.1.5.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.5.m3.1.1.2b" xref="S3.SS1.p8.5.m3.1.1.2.cmml">×</mo><msub id="S3.SS1.p8.5.m3.1.1.6" xref="S3.SS1.p8.5.m3.1.1.6.cmml"><mi id="S3.SS1.p8.5.m3.1.1.6.2" xref="S3.SS1.p8.5.m3.1.1.6.2.cmml">F</mi><mn id="S3.SS1.p8.5.m3.1.1.6.3" xref="S3.SS1.p8.5.m3.1.1.6.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p8.5.m3.1.1.2c" xref="S3.SS1.p8.5.m3.1.1.2.cmml">×</mo><mrow id="S3.SS1.p8.5.m3.1.1.1.1" xref="S3.SS1.p8.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p8.5.m3.1.1.1.1.2" xref="S3.SS1.p8.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p8.5.m3.1.1.1.1.1" xref="S3.SS1.p8.5.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p8.5.m3.1.1.1.1.1.2" xref="S3.SS1.p8.5.m3.1.1.1.1.1.2.cmml">S</mi><mo id="S3.SS1.p8.5.m3.1.1.1.1.1.1" xref="S3.SS1.p8.5.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p8.5.m3.1.1.1.1.1.3" xref="S3.SS1.p8.5.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p8.5.m3.1.1.1.1.3" xref="S3.SS1.p8.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.5.m3.1b"><apply id="S3.SS1.p8.5.m3.1.1.cmml" xref="S3.SS1.p8.5.m3.1.1"><times id="S3.SS1.p8.5.m3.1.1.2.cmml" xref="S3.SS1.p8.5.m3.1.1.2"></times><apply id="S3.SS1.p8.5.m3.1.1.3.cmml" xref="S3.SS1.p8.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p8.5.m3.1.1.3.1.cmml" xref="S3.SS1.p8.5.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p8.5.m3.1.1.3.2.cmml" xref="S3.SS1.p8.5.m3.1.1.3.2">𝐷</ci><cn type="integer" id="S3.SS1.p8.5.m3.1.1.3.3.cmml" xref="S3.SS1.p8.5.m3.1.1.3.3">1</cn></apply><apply id="S3.SS1.p8.5.m3.1.1.4.cmml" xref="S3.SS1.p8.5.m3.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p8.5.m3.1.1.4.1.cmml" xref="S3.SS1.p8.5.m3.1.1.4">subscript</csymbol><ci id="S3.SS1.p8.5.m3.1.1.4.2.cmml" xref="S3.SS1.p8.5.m3.1.1.4.2">𝐷</ci><cn type="integer" id="S3.SS1.p8.5.m3.1.1.4.3.cmml" xref="S3.SS1.p8.5.m3.1.1.4.3">2</cn></apply><apply id="S3.SS1.p8.5.m3.1.1.5.cmml" xref="S3.SS1.p8.5.m3.1.1.5"><csymbol cd="ambiguous" id="S3.SS1.p8.5.m3.1.1.5.1.cmml" xref="S3.SS1.p8.5.m3.1.1.5">subscript</csymbol><ci id="S3.SS1.p8.5.m3.1.1.5.2.cmml" xref="S3.SS1.p8.5.m3.1.1.5.2">𝐹</ci><cn type="integer" id="S3.SS1.p8.5.m3.1.1.5.3.cmml" xref="S3.SS1.p8.5.m3.1.1.5.3">1</cn></apply><apply id="S3.SS1.p8.5.m3.1.1.6.cmml" xref="S3.SS1.p8.5.m3.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.p8.5.m3.1.1.6.1.cmml" xref="S3.SS1.p8.5.m3.1.1.6">subscript</csymbol><ci id="S3.SS1.p8.5.m3.1.1.6.2.cmml" xref="S3.SS1.p8.5.m3.1.1.6.2">𝐹</ci><cn type="integer" id="S3.SS1.p8.5.m3.1.1.6.3.cmml" xref="S3.SS1.p8.5.m3.1.1.6.3">2</cn></apply><apply id="S3.SS1.p8.5.m3.1.1.1.1.1.cmml" xref="S3.SS1.p8.5.m3.1.1.1.1"><plus id="S3.SS1.p8.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p8.5.m3.1.1.1.1.1.1"></plus><ci id="S3.SS1.p8.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p8.5.m3.1.1.1.1.1.2">𝑆</ci><cn type="integer" id="S3.SS1.p8.5.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p8.5.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.5.m3.1c">D_{1}\times D_{2}\times F_{1}\times F_{2}\times(S+1)</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p9" class="ltx_para ltx_noindent">
<p id="S3.SS1.p9.2" class="ltx_p"><span id="S3.SS1.p9.2.1" class="ltx_text ltx_font_bold">Domain generalization</span> Using one such parameter generating function per layer, we can dynamically generate the weights at <em id="S3.SS1.p9.2.2" class="ltx_emph ltx_font_italic">every</em> layer of a CNN based on the encoded vector of every domain. In this approach, knowledge sharing is realized through the last (bias) bit in the encoding of <math id="S3.SS1.p9.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS1.p9.1.m1.1a"><mi id="S3.SS1.p9.1.m1.1.1" xref="S3.SS1.p9.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.1b"><ci id="S3.SS1.p9.1.m1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.1c">z</annotation></semantics></math>. I.e., every weight tensor for a given domain is the sum of a domain specific tensor and a (shared) domain agnostic tensor. For generalization to an unseen domain, we apply the one-hot, bias-only, vector <math id="S3.SS1.p9.2.m2.5" class="ltx_Math" alttext="z_{*}=[0,0,\dots,0,1]" display="inline"><semantics id="S3.SS1.p9.2.m2.5a"><mrow id="S3.SS1.p9.2.m2.5.6" xref="S3.SS1.p9.2.m2.5.6.cmml"><msub id="S3.SS1.p9.2.m2.5.6.2" xref="S3.SS1.p9.2.m2.5.6.2.cmml"><mi id="S3.SS1.p9.2.m2.5.6.2.2" xref="S3.SS1.p9.2.m2.5.6.2.2.cmml">z</mi><mo id="S3.SS1.p9.2.m2.5.6.2.3" xref="S3.SS1.p9.2.m2.5.6.2.3.cmml">∗</mo></msub><mo id="S3.SS1.p9.2.m2.5.6.1" xref="S3.SS1.p9.2.m2.5.6.1.cmml">=</mo><mrow id="S3.SS1.p9.2.m2.5.6.3.2" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml"><mo stretchy="false" id="S3.SS1.p9.2.m2.5.6.3.2.1" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">[</mo><mn id="S3.SS1.p9.2.m2.1.1" xref="S3.SS1.p9.2.m2.1.1.cmml">0</mn><mo id="S3.SS1.p9.2.m2.5.6.3.2.2" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p9.2.m2.2.2" xref="S3.SS1.p9.2.m2.2.2.cmml">0</mn><mo id="S3.SS1.p9.2.m2.5.6.3.2.3" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p9.2.m2.3.3" xref="S3.SS1.p9.2.m2.3.3.cmml">…</mi><mo id="S3.SS1.p9.2.m2.5.6.3.2.4" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p9.2.m2.4.4" xref="S3.SS1.p9.2.m2.4.4.cmml">0</mn><mo id="S3.SS1.p9.2.m2.5.6.3.2.5" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">,</mo><mn id="S3.SS1.p9.2.m2.5.5" xref="S3.SS1.p9.2.m2.5.5.cmml">1</mn><mo stretchy="false" id="S3.SS1.p9.2.m2.5.6.3.2.6" xref="S3.SS1.p9.2.m2.5.6.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.2.m2.5b"><apply id="S3.SS1.p9.2.m2.5.6.cmml" xref="S3.SS1.p9.2.m2.5.6"><eq id="S3.SS1.p9.2.m2.5.6.1.cmml" xref="S3.SS1.p9.2.m2.5.6.1"></eq><apply id="S3.SS1.p9.2.m2.5.6.2.cmml" xref="S3.SS1.p9.2.m2.5.6.2"><csymbol cd="ambiguous" id="S3.SS1.p9.2.m2.5.6.2.1.cmml" xref="S3.SS1.p9.2.m2.5.6.2">subscript</csymbol><ci id="S3.SS1.p9.2.m2.5.6.2.2.cmml" xref="S3.SS1.p9.2.m2.5.6.2.2">𝑧</ci><times id="S3.SS1.p9.2.m2.5.6.2.3.cmml" xref="S3.SS1.p9.2.m2.5.6.2.3"></times></apply><list id="S3.SS1.p9.2.m2.5.6.3.1.cmml" xref="S3.SS1.p9.2.m2.5.6.3.2"><cn type="integer" id="S3.SS1.p9.2.m2.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1">0</cn><cn type="integer" id="S3.SS1.p9.2.m2.2.2.cmml" xref="S3.SS1.p9.2.m2.2.2">0</cn><ci id="S3.SS1.p9.2.m2.3.3.cmml" xref="S3.SS1.p9.2.m2.3.3">…</ci><cn type="integer" id="S3.SS1.p9.2.m2.4.4.cmml" xref="S3.SS1.p9.2.m2.4.4">0</cn><cn type="integer" id="S3.SS1.p9.2.m2.5.5.cmml" xref="S3.SS1.p9.2.m2.5.5">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.2.m2.5c">z_{*}=[0,0,\dots,0,1]</annotation></semantics></math> to synthesize a domain agnostic CNN.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Low rank parameterized CNNs</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The method as described so far has two limitations: (i) the required parameters to learn now grow linearly in the number of domains (which we eventually hope to be large to achieve good DG), and (ii) the sharing structure is very prescribed: every parameter is an equally weighted sum of its domain agnostic and domain-specific bias partners.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.3" class="ltx_p">To alleviate these two issues, we place a structural constraint on <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{W}</annotation></semantics></math>. Motivated by the well-known Tucker decomposition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, we assume that the <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">M</annotation></semantics></math>-order tensor <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathcal{W}</annotation></semantics></math> is synthesized as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\mathcal{W}=\mathcal{G}\times_{1}U_{1}\dots\times_{M}U_{M}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">𝒲</mi><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mrow id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><mrow id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.cmml">𝒢</mi><msub id="S3.E5.m1.1.1.3.2.2.1" xref="S3.E5.m1.1.1.3.2.2.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.2.2.1.2" xref="S3.E5.m1.1.1.3.2.2.1.2.cmml">×</mo><mn id="S3.E5.m1.1.1.3.2.2.1.3" xref="S3.E5.m1.1.1.3.2.2.1.3.cmml">1</mn></msub><msub id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.2.3.2" xref="S3.E5.m1.1.1.3.2.2.3.2.cmml">U</mi><mn id="S3.E5.m1.1.1.3.2.2.3.3" xref="S3.E5.m1.1.1.3.2.2.3.3.cmml">1</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.1" xref="S3.E5.m1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml">⋯</mi></mrow><msub id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.3.1.2" xref="S3.E5.m1.1.1.3.1.2.cmml">×</mo><mi id="S3.E5.m1.1.1.3.1.3" xref="S3.E5.m1.1.1.3.1.3.cmml">M</mi></msub><msub id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml">U</mi><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">M</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">𝒲</ci><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><apply id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.1.cmml" xref="S3.E5.m1.1.1.3.1">subscript</csymbol><times id="S3.E5.m1.1.1.3.1.2.cmml" xref="S3.E5.m1.1.1.3.1.2"></times><ci id="S3.E5.m1.1.1.3.1.3.cmml" xref="S3.E5.m1.1.1.3.1.3">𝑀</ci></apply><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><times id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.1"></times><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><apply id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.1.cmml" xref="S3.E5.m1.1.1.3.2.2.1">subscript</csymbol><times id="S3.E5.m1.1.1.3.2.2.1.2.cmml" xref="S3.E5.m1.1.1.3.2.2.1.2"></times><cn type="integer" id="S3.E5.m1.1.1.3.2.2.1.3.cmml" xref="S3.E5.m1.1.1.3.2.2.1.3">1</cn></apply><ci id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2">𝒢</ci><apply id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.2.3.2">𝑈</ci><cn type="integer" id="S3.E5.m1.1.1.3.2.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3">⋯</ci></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">𝑈</ci><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\mathcal{W}=\mathcal{G}\times_{1}U_{1}\dots\times_{M}U_{M}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.15" class="ltx_p">where <math id="S3.SS2.p2.4.m1.1" class="ltx_Math" alttext="\mathcal{G}" display="inline"><semantics id="S3.SS2.p2.4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml">𝒢</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><ci id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1">𝒢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">\mathcal{G}</annotation></semantics></math> is a <math id="S3.SS2.p2.5.m2.1" class="ltx_Math" alttext="K_{1}\times\dots K_{M}" display="inline"><semantics id="S3.SS2.p2.5.m2.1a"><mrow id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml"><mrow id="S3.SS2.p2.5.m2.1.1.2" xref="S3.SS2.p2.5.m2.1.1.2.cmml"><msub id="S3.SS2.p2.5.m2.1.1.2.2" xref="S3.SS2.p2.5.m2.1.1.2.2.cmml"><mi id="S3.SS2.p2.5.m2.1.1.2.2.2" xref="S3.SS2.p2.5.m2.1.1.2.2.2.cmml">K</mi><mn id="S3.SS2.p2.5.m2.1.1.2.2.3" xref="S3.SS2.p2.5.m2.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.5.m2.1.1.2.1" xref="S3.SS2.p2.5.m2.1.1.2.1.cmml">×</mo><mi mathvariant="normal" id="S3.SS2.p2.5.m2.1.1.2.3" xref="S3.SS2.p2.5.m2.1.1.2.3.cmml">…</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m2.1.1.1" xref="S3.SS2.p2.5.m2.1.1.1.cmml">​</mo><msub id="S3.SS2.p2.5.m2.1.1.3" xref="S3.SS2.p2.5.m2.1.1.3.cmml"><mi id="S3.SS2.p2.5.m2.1.1.3.2" xref="S3.SS2.p2.5.m2.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.5.m2.1.1.3.3" xref="S3.SS2.p2.5.m2.1.1.3.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><apply id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1"><times id="S3.SS2.p2.5.m2.1.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1.1"></times><apply id="S3.SS2.p2.5.m2.1.1.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2"><times id="S3.SS2.p2.5.m2.1.1.2.1.cmml" xref="S3.SS2.p2.5.m2.1.1.2.1"></times><apply id="S3.SS2.p2.5.m2.1.1.2.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m2.1.1.2.2.1.cmml" xref="S3.SS2.p2.5.m2.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.5.m2.1.1.2.2.2.cmml" xref="S3.SS2.p2.5.m2.1.1.2.2.2">𝐾</ci><cn type="integer" id="S3.SS2.p2.5.m2.1.1.2.2.3.cmml" xref="S3.SS2.p2.5.m2.1.1.2.2.3">1</cn></apply><ci id="S3.SS2.p2.5.m2.1.1.2.3.cmml" xref="S3.SS2.p2.5.m2.1.1.2.3">…</ci></apply><apply id="S3.SS2.p2.5.m2.1.1.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m2.1.1.3.1.cmml" xref="S3.SS2.p2.5.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.5.m2.1.1.3.2.cmml" xref="S3.SS2.p2.5.m2.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.5.m2.1.1.3.3.cmml" xref="S3.SS2.p2.5.m2.1.1.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">K_{1}\times\dots K_{M}</annotation></semantics></math> sized low-rank core tensor, and <math id="S3.SS2.p2.6.m3.1" class="ltx_Math" alttext="U_{m}" display="inline"><semantics id="S3.SS2.p2.6.m3.1a"><msub id="S3.SS2.p2.6.m3.1.1" xref="S3.SS2.p2.6.m3.1.1.cmml"><mi id="S3.SS2.p2.6.m3.1.1.2" xref="S3.SS2.p2.6.m3.1.1.2.cmml">U</mi><mi id="S3.SS2.p2.6.m3.1.1.3" xref="S3.SS2.p2.6.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m3.1b"><apply id="S3.SS2.p2.6.m3.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m3.1.1.1.cmml" xref="S3.SS2.p2.6.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m3.1.1.2.cmml" xref="S3.SS2.p2.6.m3.1.1.2">𝑈</ci><ci id="S3.SS2.p2.6.m3.1.1.3.cmml" xref="S3.SS2.p2.6.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m3.1c">U_{m}</annotation></semantics></math> are <math id="S3.SS2.p2.7.m4.1" class="ltx_Math" alttext="K_{m}\times D_{m}" display="inline"><semantics id="S3.SS2.p2.7.m4.1a"><mrow id="S3.SS2.p2.7.m4.1.1" xref="S3.SS2.p2.7.m4.1.1.cmml"><msub id="S3.SS2.p2.7.m4.1.1.2" xref="S3.SS2.p2.7.m4.1.1.2.cmml"><mi id="S3.SS2.p2.7.m4.1.1.2.2" xref="S3.SS2.p2.7.m4.1.1.2.2.cmml">K</mi><mi id="S3.SS2.p2.7.m4.1.1.2.3" xref="S3.SS2.p2.7.m4.1.1.2.3.cmml">m</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.7.m4.1.1.1" xref="S3.SS2.p2.7.m4.1.1.1.cmml">×</mo><msub id="S3.SS2.p2.7.m4.1.1.3" xref="S3.SS2.p2.7.m4.1.1.3.cmml"><mi id="S3.SS2.p2.7.m4.1.1.3.2" xref="S3.SS2.p2.7.m4.1.1.3.2.cmml">D</mi><mi id="S3.SS2.p2.7.m4.1.1.3.3" xref="S3.SS2.p2.7.m4.1.1.3.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m4.1b"><apply id="S3.SS2.p2.7.m4.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1"><times id="S3.SS2.p2.7.m4.1.1.1.cmml" xref="S3.SS2.p2.7.m4.1.1.1"></times><apply id="S3.SS2.p2.7.m4.1.1.2.cmml" xref="S3.SS2.p2.7.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m4.1.1.2.1.cmml" xref="S3.SS2.p2.7.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.7.m4.1.1.2.2.cmml" xref="S3.SS2.p2.7.m4.1.1.2.2">𝐾</ci><ci id="S3.SS2.p2.7.m4.1.1.2.3.cmml" xref="S3.SS2.p2.7.m4.1.1.2.3">𝑚</ci></apply><apply id="S3.SS2.p2.7.m4.1.1.3.cmml" xref="S3.SS2.p2.7.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m4.1.1.3.1.cmml" xref="S3.SS2.p2.7.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.7.m4.1.1.3.2.cmml" xref="S3.SS2.p2.7.m4.1.1.3.2">𝐷</ci><ci id="S3.SS2.p2.7.m4.1.1.3.3.cmml" xref="S3.SS2.p2.7.m4.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m4.1c">K_{m}\times D_{m}</annotation></semantics></math> matrices (note that <math id="S3.SS2.p2.8.m5.1" class="ltx_Math" alttext="D_{M}=S+1" display="inline"><semantics id="S3.SS2.p2.8.m5.1a"><mrow id="S3.SS2.p2.8.m5.1.1" xref="S3.SS2.p2.8.m5.1.1.cmml"><msub id="S3.SS2.p2.8.m5.1.1.2" xref="S3.SS2.p2.8.m5.1.1.2.cmml"><mi id="S3.SS2.p2.8.m5.1.1.2.2" xref="S3.SS2.p2.8.m5.1.1.2.2.cmml">D</mi><mi id="S3.SS2.p2.8.m5.1.1.2.3" xref="S3.SS2.p2.8.m5.1.1.2.3.cmml">M</mi></msub><mo id="S3.SS2.p2.8.m5.1.1.1" xref="S3.SS2.p2.8.m5.1.1.1.cmml">=</mo><mrow id="S3.SS2.p2.8.m5.1.1.3" xref="S3.SS2.p2.8.m5.1.1.3.cmml"><mi id="S3.SS2.p2.8.m5.1.1.3.2" xref="S3.SS2.p2.8.m5.1.1.3.2.cmml">S</mi><mo id="S3.SS2.p2.8.m5.1.1.3.1" xref="S3.SS2.p2.8.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p2.8.m5.1.1.3.3" xref="S3.SS2.p2.8.m5.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m5.1b"><apply id="S3.SS2.p2.8.m5.1.1.cmml" xref="S3.SS2.p2.8.m5.1.1"><eq id="S3.SS2.p2.8.m5.1.1.1.cmml" xref="S3.SS2.p2.8.m5.1.1.1"></eq><apply id="S3.SS2.p2.8.m5.1.1.2.cmml" xref="S3.SS2.p2.8.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m5.1.1.2.1.cmml" xref="S3.SS2.p2.8.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.8.m5.1.1.2.2.cmml" xref="S3.SS2.p2.8.m5.1.1.2.2">𝐷</ci><ci id="S3.SS2.p2.8.m5.1.1.2.3.cmml" xref="S3.SS2.p2.8.m5.1.1.2.3">𝑀</ci></apply><apply id="S3.SS2.p2.8.m5.1.1.3.cmml" xref="S3.SS2.p2.8.m5.1.1.3"><plus id="S3.SS2.p2.8.m5.1.1.3.1.cmml" xref="S3.SS2.p2.8.m5.1.1.3.1"></plus><ci id="S3.SS2.p2.8.m5.1.1.3.2.cmml" xref="S3.SS2.p2.8.m5.1.1.3.2">𝑆</ci><cn type="integer" id="S3.SS2.p2.8.m5.1.1.3.3.cmml" xref="S3.SS2.p2.8.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m5.1c">D_{M}=S+1</annotation></semantics></math>). By controlling the ranks <math id="S3.SS2.p2.9.m6.1" class="ltx_Math" alttext="K_{1}\dots K_{M}" display="inline"><semantics id="S3.SS2.p2.9.m6.1a"><mrow id="S3.SS2.p2.9.m6.1.1" xref="S3.SS2.p2.9.m6.1.1.cmml"><msub id="S3.SS2.p2.9.m6.1.1.2" xref="S3.SS2.p2.9.m6.1.1.2.cmml"><mi id="S3.SS2.p2.9.m6.1.1.2.2" xref="S3.SS2.p2.9.m6.1.1.2.2.cmml">K</mi><mn id="S3.SS2.p2.9.m6.1.1.2.3" xref="S3.SS2.p2.9.m6.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.9.m6.1.1.1" xref="S3.SS2.p2.9.m6.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.9.m6.1.1.3" xref="S3.SS2.p2.9.m6.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.9.m6.1.1.1a" xref="S3.SS2.p2.9.m6.1.1.1.cmml">​</mo><msub id="S3.SS2.p2.9.m6.1.1.4" xref="S3.SS2.p2.9.m6.1.1.4.cmml"><mi id="S3.SS2.p2.9.m6.1.1.4.2" xref="S3.SS2.p2.9.m6.1.1.4.2.cmml">K</mi><mi id="S3.SS2.p2.9.m6.1.1.4.3" xref="S3.SS2.p2.9.m6.1.1.4.3.cmml">M</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m6.1b"><apply id="S3.SS2.p2.9.m6.1.1.cmml" xref="S3.SS2.p2.9.m6.1.1"><times id="S3.SS2.p2.9.m6.1.1.1.cmml" xref="S3.SS2.p2.9.m6.1.1.1"></times><apply id="S3.SS2.p2.9.m6.1.1.2.cmml" xref="S3.SS2.p2.9.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.2.1.cmml" xref="S3.SS2.p2.9.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.9.m6.1.1.2.2.cmml" xref="S3.SS2.p2.9.m6.1.1.2.2">𝐾</ci><cn type="integer" id="S3.SS2.p2.9.m6.1.1.2.3.cmml" xref="S3.SS2.p2.9.m6.1.1.2.3">1</cn></apply><ci id="S3.SS2.p2.9.m6.1.1.3.cmml" xref="S3.SS2.p2.9.m6.1.1.3">…</ci><apply id="S3.SS2.p2.9.m6.1.1.4.cmml" xref="S3.SS2.p2.9.m6.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m6.1.1.4.1.cmml" xref="S3.SS2.p2.9.m6.1.1.4">subscript</csymbol><ci id="S3.SS2.p2.9.m6.1.1.4.2.cmml" xref="S3.SS2.p2.9.m6.1.1.4.2">𝐾</ci><ci id="S3.SS2.p2.9.m6.1.1.4.3.cmml" xref="S3.SS2.p2.9.m6.1.1.4.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m6.1c">K_{1}\dots K_{M}</annotation></semantics></math> we can effectively reduce the number of parameters to learn. By learning <math id="S3.SS2.p2.10.m7.2" class="ltx_Math" alttext="\{\mathcal{G},U_{1}\dots U_{M}\}" display="inline"><semantics id="S3.SS2.p2.10.m7.2a"><mrow id="S3.SS2.p2.10.m7.2.2.1" xref="S3.SS2.p2.10.m7.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p2.10.m7.2.2.1.2" xref="S3.SS2.p2.10.m7.2.2.2.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.10.m7.1.1" xref="S3.SS2.p2.10.m7.1.1.cmml">𝒢</mi><mo id="S3.SS2.p2.10.m7.2.2.1.3" xref="S3.SS2.p2.10.m7.2.2.2.cmml">,</mo><mrow id="S3.SS2.p2.10.m7.2.2.1.1" xref="S3.SS2.p2.10.m7.2.2.1.1.cmml"><msub id="S3.SS2.p2.10.m7.2.2.1.1.2" xref="S3.SS2.p2.10.m7.2.2.1.1.2.cmml"><mi id="S3.SS2.p2.10.m7.2.2.1.1.2.2" xref="S3.SS2.p2.10.m7.2.2.1.1.2.2.cmml">U</mi><mn id="S3.SS2.p2.10.m7.2.2.1.1.2.3" xref="S3.SS2.p2.10.m7.2.2.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m7.2.2.1.1.1" xref="S3.SS2.p2.10.m7.2.2.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p2.10.m7.2.2.1.1.3" xref="S3.SS2.p2.10.m7.2.2.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m7.2.2.1.1.1a" xref="S3.SS2.p2.10.m7.2.2.1.1.1.cmml">​</mo><msub id="S3.SS2.p2.10.m7.2.2.1.1.4" xref="S3.SS2.p2.10.m7.2.2.1.1.4.cmml"><mi id="S3.SS2.p2.10.m7.2.2.1.1.4.2" xref="S3.SS2.p2.10.m7.2.2.1.1.4.2.cmml">U</mi><mi id="S3.SS2.p2.10.m7.2.2.1.1.4.3" xref="S3.SS2.p2.10.m7.2.2.1.1.4.3.cmml">M</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p2.10.m7.2.2.1.4" xref="S3.SS2.p2.10.m7.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m7.2b"><set id="S3.SS2.p2.10.m7.2.2.2.cmml" xref="S3.SS2.p2.10.m7.2.2.1"><ci id="S3.SS2.p2.10.m7.1.1.cmml" xref="S3.SS2.p2.10.m7.1.1">𝒢</ci><apply id="S3.SS2.p2.10.m7.2.2.1.1.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1"><times id="S3.SS2.p2.10.m7.2.2.1.1.1.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.1"></times><apply id="S3.SS2.p2.10.m7.2.2.1.1.2.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.2.2.1.1.2.1.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.10.m7.2.2.1.1.2.2.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.2.2">𝑈</ci><cn type="integer" id="S3.SS2.p2.10.m7.2.2.1.1.2.3.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS2.p2.10.m7.2.2.1.1.3.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.3">…</ci><apply id="S3.SS2.p2.10.m7.2.2.1.1.4.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m7.2.2.1.1.4.1.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.4">subscript</csymbol><ci id="S3.SS2.p2.10.m7.2.2.1.1.4.2.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.4.2">𝑈</ci><ci id="S3.SS2.p2.10.m7.2.2.1.1.4.3.cmml" xref="S3.SS2.p2.10.m7.2.2.1.1.4.3">𝑀</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m7.2c">\{\mathcal{G},U_{1}\dots U_{M}\}</annotation></semantics></math> instead of <math id="S3.SS2.p2.11.m8.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS2.p2.11.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.11.m8.1.1" xref="S3.SS2.p2.11.m8.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m8.1b"><ci id="S3.SS2.p2.11.m8.1.1.cmml" xref="S3.SS2.p2.11.m8.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m8.1c">\mathcal{W}</annotation></semantics></math>, the number of parameters is reduced from <math id="S3.SS2.p2.12.m9.1" class="ltx_Math" alttext="(D_{1}\times\dots\times D_{M-1}\times(S+1))" display="inline"><semantics id="S3.SS2.p2.12.m9.1a"><mrow id="S3.SS2.p2.12.m9.1.1.1" xref="S3.SS2.p2.12.m9.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.12.m9.1.1.1.2" xref="S3.SS2.p2.12.m9.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.12.m9.1.1.1.1" xref="S3.SS2.p2.12.m9.1.1.1.1.cmml"><msub id="S3.SS2.p2.12.m9.1.1.1.1.3" xref="S3.SS2.p2.12.m9.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.12.m9.1.1.1.1.3.2" xref="S3.SS2.p2.12.m9.1.1.1.1.3.2.cmml">D</mi><mn id="S3.SS2.p2.12.m9.1.1.1.1.3.3" xref="S3.SS2.p2.12.m9.1.1.1.1.3.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.12.m9.1.1.1.1.2" xref="S3.SS2.p2.12.m9.1.1.1.1.2.cmml">×</mo><mi mathvariant="normal" id="S3.SS2.p2.12.m9.1.1.1.1.4" xref="S3.SS2.p2.12.m9.1.1.1.1.4.cmml">⋯</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.12.m9.1.1.1.1.2a" xref="S3.SS2.p2.12.m9.1.1.1.1.2.cmml">×</mo><msub id="S3.SS2.p2.12.m9.1.1.1.1.5" xref="S3.SS2.p2.12.m9.1.1.1.1.5.cmml"><mi id="S3.SS2.p2.12.m9.1.1.1.1.5.2" xref="S3.SS2.p2.12.m9.1.1.1.1.5.2.cmml">D</mi><mrow id="S3.SS2.p2.12.m9.1.1.1.1.5.3" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.cmml"><mi id="S3.SS2.p2.12.m9.1.1.1.1.5.3.2" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.2.cmml">M</mi><mo id="S3.SS2.p2.12.m9.1.1.1.1.5.3.1" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.1.cmml">−</mo><mn id="S3.SS2.p2.12.m9.1.1.1.1.5.3.3" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.12.m9.1.1.1.1.2b" xref="S3.SS2.p2.12.m9.1.1.1.1.2.cmml">×</mo><mrow id="S3.SS2.p2.12.m9.1.1.1.1.1.1" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.12.m9.1.1.1.1.1.1.2" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.2" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.2.cmml">S</mi><mo id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.1" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.3" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p2.12.m9.1.1.1.1.1.1.3" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.12.m9.1.1.1.3" xref="S3.SS2.p2.12.m9.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m9.1b"><apply id="S3.SS2.p2.12.m9.1.1.1.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1"><times id="S3.SS2.p2.12.m9.1.1.1.1.2.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.2"></times><apply id="S3.SS2.p2.12.m9.1.1.1.1.3.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m9.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.12.m9.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.3.2">𝐷</ci><cn type="integer" id="S3.SS2.p2.12.m9.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.3.3">1</cn></apply><ci id="S3.SS2.p2.12.m9.1.1.1.1.4.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.4">⋯</ci><apply id="S3.SS2.p2.12.m9.1.1.1.1.5.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m9.1.1.1.1.5.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5">subscript</csymbol><ci id="S3.SS2.p2.12.m9.1.1.1.1.5.2.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5.2">𝐷</ci><apply id="S3.SS2.p2.12.m9.1.1.1.1.5.3.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3"><minus id="S3.SS2.p2.12.m9.1.1.1.1.5.3.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.1"></minus><ci id="S3.SS2.p2.12.m9.1.1.1.1.5.3.2.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.2">𝑀</ci><cn type="integer" id="S3.SS2.p2.12.m9.1.1.1.1.5.3.3.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.5.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1"><plus id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.2">𝑆</ci><cn type="integer" id="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.12.m9.1.1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m9.1c">(D_{1}\times\dots\times D_{M-1}\times(S+1))</annotation></semantics></math> to <math id="S3.SS2.p2.13.m10.2" class="ltx_Math" alttext="(K_{1}\times\dots K_{M})+\sum_{m=1}^{M-1}D_{m}\times K_{m}+K_{M}\times(S+1)" display="inline"><semantics id="S3.SS2.p2.13.m10.2a"><mrow id="S3.SS2.p2.13.m10.2.2" xref="S3.SS2.p2.13.m10.2.2.cmml"><mrow id="S3.SS2.p2.13.m10.1.1.1.1" xref="S3.SS2.p2.13.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.13.m10.1.1.1.1.2" xref="S3.SS2.p2.13.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.13.m10.1.1.1.1.1" xref="S3.SS2.p2.13.m10.1.1.1.1.1.cmml"><mrow id="S3.SS2.p2.13.m10.1.1.1.1.1.2" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.cmml"><msub id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.cmml"><mi id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.2" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.2.cmml">K</mi><mn id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.3" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.13.m10.1.1.1.1.1.2.1" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.1.cmml">×</mo><mi mathvariant="normal" id="S3.SS2.p2.13.m10.1.1.1.1.1.2.3" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.3.cmml">…</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p2.13.m10.1.1.1.1.1.1" xref="S3.SS2.p2.13.m10.1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS2.p2.13.m10.1.1.1.1.1.3" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p2.13.m10.1.1.1.1.1.3.2" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3.2.cmml">K</mi><mi id="S3.SS2.p2.13.m10.1.1.1.1.1.3.3" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p2.13.m10.1.1.1.1.3" xref="S3.SS2.p2.13.m10.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.055em" id="S3.SS2.p2.13.m10.2.2.3" xref="S3.SS2.p2.13.m10.2.2.3.cmml">+</mo><mrow id="S3.SS2.p2.13.m10.2.2.4" xref="S3.SS2.p2.13.m10.2.2.4.cmml"><msubsup id="S3.SS2.p2.13.m10.2.2.4.1" xref="S3.SS2.p2.13.m10.2.2.4.1.cmml"><mo id="S3.SS2.p2.13.m10.2.2.4.1.2.2" xref="S3.SS2.p2.13.m10.2.2.4.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.13.m10.2.2.4.1.2.3" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.cmml"><mi id="S3.SS2.p2.13.m10.2.2.4.1.2.3.2" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.2.cmml">m</mi><mo id="S3.SS2.p2.13.m10.2.2.4.1.2.3.1" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.13.m10.2.2.4.1.2.3.3" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p2.13.m10.2.2.4.1.3" xref="S3.SS2.p2.13.m10.2.2.4.1.3.cmml"><mi id="S3.SS2.p2.13.m10.2.2.4.1.3.2" xref="S3.SS2.p2.13.m10.2.2.4.1.3.2.cmml">M</mi><mo id="S3.SS2.p2.13.m10.2.2.4.1.3.1" xref="S3.SS2.p2.13.m10.2.2.4.1.3.1.cmml">−</mo><mn id="S3.SS2.p2.13.m10.2.2.4.1.3.3" xref="S3.SS2.p2.13.m10.2.2.4.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="S3.SS2.p2.13.m10.2.2.4.2" xref="S3.SS2.p2.13.m10.2.2.4.2.cmml"><msub id="S3.SS2.p2.13.m10.2.2.4.2.2" xref="S3.SS2.p2.13.m10.2.2.4.2.2.cmml"><mi id="S3.SS2.p2.13.m10.2.2.4.2.2.2" xref="S3.SS2.p2.13.m10.2.2.4.2.2.2.cmml">D</mi><mi id="S3.SS2.p2.13.m10.2.2.4.2.2.3" xref="S3.SS2.p2.13.m10.2.2.4.2.2.3.cmml">m</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.13.m10.2.2.4.2.1" xref="S3.SS2.p2.13.m10.2.2.4.2.1.cmml">×</mo><msub id="S3.SS2.p2.13.m10.2.2.4.2.3" xref="S3.SS2.p2.13.m10.2.2.4.2.3.cmml"><mi id="S3.SS2.p2.13.m10.2.2.4.2.3.2" xref="S3.SS2.p2.13.m10.2.2.4.2.3.2.cmml">K</mi><mi id="S3.SS2.p2.13.m10.2.2.4.2.3.3" xref="S3.SS2.p2.13.m10.2.2.4.2.3.3.cmml">m</mi></msub></mrow></mrow><mo id="S3.SS2.p2.13.m10.2.2.3a" xref="S3.SS2.p2.13.m10.2.2.3.cmml">+</mo><mrow id="S3.SS2.p2.13.m10.2.2.2" xref="S3.SS2.p2.13.m10.2.2.2.cmml"><msub id="S3.SS2.p2.13.m10.2.2.2.3" xref="S3.SS2.p2.13.m10.2.2.2.3.cmml"><mi id="S3.SS2.p2.13.m10.2.2.2.3.2" xref="S3.SS2.p2.13.m10.2.2.2.3.2.cmml">K</mi><mi id="S3.SS2.p2.13.m10.2.2.2.3.3" xref="S3.SS2.p2.13.m10.2.2.2.3.3.cmml">M</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.13.m10.2.2.2.2" xref="S3.SS2.p2.13.m10.2.2.2.2.cmml">×</mo><mrow id="S3.SS2.p2.13.m10.2.2.2.1.1" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.13.m10.2.2.2.1.1.2" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.13.m10.2.2.2.1.1.1" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p2.13.m10.2.2.2.1.1.1.2" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.2.cmml">S</mi><mo id="S3.SS2.p2.13.m10.2.2.2.1.1.1.1" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.1.cmml">+</mo><mn id="S3.SS2.p2.13.m10.2.2.2.1.1.1.3" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p2.13.m10.2.2.2.1.1.3" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m10.2b"><apply id="S3.SS2.p2.13.m10.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2"><plus id="S3.SS2.p2.13.m10.2.2.3.cmml" xref="S3.SS2.p2.13.m10.2.2.3"></plus><apply id="S3.SS2.p2.13.m10.1.1.1.1.1.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1"><times id="S3.SS2.p2.13.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.1"></times><apply id="S3.SS2.p2.13.m10.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2"><times id="S3.SS2.p2.13.m10.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.1"></times><apply id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.1.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.2">𝐾</ci><cn type="integer" id="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.3.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S3.SS2.p2.13.m10.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.2.3">…</ci></apply><apply id="S3.SS2.p2.13.m10.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.13.m10.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3.2">𝐾</ci><ci id="S3.SS2.p2.13.m10.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.13.m10.1.1.1.1.1.3.3">𝑀</ci></apply></apply><apply id="S3.SS2.p2.13.m10.2.2.4.cmml" xref="S3.SS2.p2.13.m10.2.2.4"><apply id="S3.SS2.p2.13.m10.2.2.4.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.2.2.4.1.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1">superscript</csymbol><apply id="S3.SS2.p2.13.m10.2.2.4.1.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.2.2.4.1.2.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1">subscript</csymbol><sum id="S3.SS2.p2.13.m10.2.2.4.1.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.2.2"></sum><apply id="S3.SS2.p2.13.m10.2.2.4.1.2.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3"><eq id="S3.SS2.p2.13.m10.2.2.4.1.2.3.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.1"></eq><ci id="S3.SS2.p2.13.m10.2.2.4.1.2.3.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.2">𝑚</ci><cn type="integer" id="S3.SS2.p2.13.m10.2.2.4.1.2.3.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.13.m10.2.2.4.1.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.3"><minus id="S3.SS2.p2.13.m10.2.2.4.1.3.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.3.1"></minus><ci id="S3.SS2.p2.13.m10.2.2.4.1.3.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.3.2">𝑀</ci><cn type="integer" id="S3.SS2.p2.13.m10.2.2.4.1.3.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.1.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.13.m10.2.2.4.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2"><times id="S3.SS2.p2.13.m10.2.2.4.2.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.1"></times><apply id="S3.SS2.p2.13.m10.2.2.4.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.2.2.4.2.2.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.2">subscript</csymbol><ci id="S3.SS2.p2.13.m10.2.2.4.2.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.2.2">𝐷</ci><ci id="S3.SS2.p2.13.m10.2.2.4.2.2.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.2.3">𝑚</ci></apply><apply id="S3.SS2.p2.13.m10.2.2.4.2.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.2.2.4.2.3.1.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.3">subscript</csymbol><ci id="S3.SS2.p2.13.m10.2.2.4.2.3.2.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.3.2">𝐾</ci><ci id="S3.SS2.p2.13.m10.2.2.4.2.3.3.cmml" xref="S3.SS2.p2.13.m10.2.2.4.2.3.3">𝑚</ci></apply></apply></apply><apply id="S3.SS2.p2.13.m10.2.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2.2"><times id="S3.SS2.p2.13.m10.2.2.2.2.cmml" xref="S3.SS2.p2.13.m10.2.2.2.2"></times><apply id="S3.SS2.p2.13.m10.2.2.2.3.cmml" xref="S3.SS2.p2.13.m10.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.13.m10.2.2.2.3.1.cmml" xref="S3.SS2.p2.13.m10.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p2.13.m10.2.2.2.3.2.cmml" xref="S3.SS2.p2.13.m10.2.2.2.3.2">𝐾</ci><ci id="S3.SS2.p2.13.m10.2.2.2.3.3.cmml" xref="S3.SS2.p2.13.m10.2.2.2.3.3">𝑀</ci></apply><apply id="S3.SS2.p2.13.m10.2.2.2.1.1.1.cmml" xref="S3.SS2.p2.13.m10.2.2.2.1.1"><plus id="S3.SS2.p2.13.m10.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.1"></plus><ci id="S3.SS2.p2.13.m10.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.2">𝑆</ci><cn type="integer" id="S3.SS2.p2.13.m10.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.13.m10.2.2.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m10.2c">(K_{1}\times\dots K_{M})+\sum_{m=1}^{M-1}D_{m}\times K_{m}+K_{M}\times(S+1)</annotation></semantics></math>. Besides, <math id="S3.SS2.p2.14.m11.1" class="ltx_Math" alttext="U_{M}" display="inline"><semantics id="S3.SS2.p2.14.m11.1a"><msub id="S3.SS2.p2.14.m11.1.1" xref="S3.SS2.p2.14.m11.1.1.cmml"><mi id="S3.SS2.p2.14.m11.1.1.2" xref="S3.SS2.p2.14.m11.1.1.2.cmml">U</mi><mi id="S3.SS2.p2.14.m11.1.1.3" xref="S3.SS2.p2.14.m11.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m11.1b"><apply id="S3.SS2.p2.14.m11.1.1.cmml" xref="S3.SS2.p2.14.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.14.m11.1.1.1.cmml" xref="S3.SS2.p2.14.m11.1.1">subscript</csymbol><ci id="S3.SS2.p2.14.m11.1.1.2.cmml" xref="S3.SS2.p2.14.m11.1.1.2">𝑈</ci><ci id="S3.SS2.p2.14.m11.1.1.3.cmml" xref="S3.SS2.p2.14.m11.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m11.1c">U_{M}</annotation></semantics></math> produces a <math id="S3.SS2.p2.15.m12.1" class="ltx_Math" alttext="K_{M}" display="inline"><semantics id="S3.SS2.p2.15.m12.1a"><msub id="S3.SS2.p2.15.m12.1.1" xref="S3.SS2.p2.15.m12.1.1.cmml"><mi id="S3.SS2.p2.15.m12.1.1.2" xref="S3.SS2.p2.15.m12.1.1.2.cmml">K</mi><mi id="S3.SS2.p2.15.m12.1.1.3" xref="S3.SS2.p2.15.m12.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m12.1b"><apply id="S3.SS2.p2.15.m12.1.1.cmml" xref="S3.SS2.p2.15.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.15.m12.1.1.1.cmml" xref="S3.SS2.p2.15.m12.1.1">subscript</csymbol><ci id="S3.SS2.p2.15.m12.1.1.2.cmml" xref="S3.SS2.p2.15.m12.1.1.2">𝐾</ci><ci id="S3.SS2.p2.15.m12.1.1.3.cmml" xref="S3.SS2.p2.15.m12.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m12.1c">K_{M}</annotation></semantics></math>-dimensional dense vector that guides how to linearly combine the shared factors, which is much more informative than the original case of equally weighted sum.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Given a tensor <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathcal{W}</annotation></semantics></math> the Tucker problem can be solved via high-order singular value decomposition (HO-SVD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\mathcal{G}=\mathcal{W}\times_{1}U^{T}_{1}\dots\times_{M}U^{T}_{M}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">𝒢</mi><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mrow id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mrow id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.3.2.2.2" xref="S3.E6.m1.1.1.3.2.2.2.cmml">𝒲</mi><msub id="S3.E6.m1.1.1.3.2.2.1" xref="S3.E6.m1.1.1.3.2.2.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.3.2.2.1.2" xref="S3.E6.m1.1.1.3.2.2.1.2.cmml">×</mo><mn id="S3.E6.m1.1.1.3.2.2.1.3" xref="S3.E6.m1.1.1.3.2.2.1.3.cmml">1</mn></msub><msubsup id="S3.E6.m1.1.1.3.2.2.3" xref="S3.E6.m1.1.1.3.2.2.3.cmml"><mi id="S3.E6.m1.1.1.3.2.2.3.2.2" xref="S3.E6.m1.1.1.3.2.2.3.2.2.cmml">U</mi><mn id="S3.E6.m1.1.1.3.2.2.3.3" xref="S3.E6.m1.1.1.3.2.2.3.3.cmml">1</mn><mi id="S3.E6.m1.1.1.3.2.2.3.2.3" xref="S3.E6.m1.1.1.3.2.2.3.2.3.cmml">T</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.2.1" xref="S3.E6.m1.1.1.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml">⋯</mi></mrow><msub id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.3.1.2" xref="S3.E6.m1.1.1.3.1.2.cmml">×</mo><mi id="S3.E6.m1.1.1.3.1.3" xref="S3.E6.m1.1.1.3.1.3.cmml">M</mi></msub><msubsup id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.3.3.2.2.cmml">U</mi><mi id="S3.E6.m1.1.1.3.3.3" xref="S3.E6.m1.1.1.3.3.3.cmml">M</mi><mi id="S3.E6.m1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.3.3.2.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><ci id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">𝒢</ci><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><apply id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.3.1">subscript</csymbol><times id="S3.E6.m1.1.1.3.1.2.cmml" xref="S3.E6.m1.1.1.3.1.2"></times><ci id="S3.E6.m1.1.1.3.1.3.cmml" xref="S3.E6.m1.1.1.3.1.3">𝑀</ci></apply><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><times id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.1"></times><apply id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2"><apply id="S3.E6.m1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.2.1.1.cmml" xref="S3.E6.m1.1.1.3.2.2.1">subscript</csymbol><times id="S3.E6.m1.1.1.3.2.2.1.2.cmml" xref="S3.E6.m1.1.1.3.2.2.1.2"></times><cn type="integer" id="S3.E6.m1.1.1.3.2.2.1.3.cmml" xref="S3.E6.m1.1.1.3.2.2.1.3">1</cn></apply><ci id="S3.E6.m1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2.2">𝒲</ci><apply id="S3.E6.m1.1.1.3.2.2.3.cmml" xref="S3.E6.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.2.3.1.cmml" xref="S3.E6.m1.1.1.3.2.2.3">subscript</csymbol><apply id="S3.E6.m1.1.1.3.2.2.3.2.cmml" xref="S3.E6.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.2.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.2.3">superscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2.3.2.2">𝑈</ci><ci id="S3.E6.m1.1.1.3.2.2.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.2.3.2.3">𝑇</ci></apply><cn type="integer" id="S3.E6.m1.1.1.3.2.2.3.3.cmml" xref="S3.E6.m1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3">⋯</ci></apply><apply id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3">subscript</csymbol><apply id="S3.E6.m1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.3.3">superscript</csymbol><ci id="S3.E6.m1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.3.3.2.2">𝑈</ci><ci id="S3.E6.m1.1.1.3.3.2.3.cmml" xref="S3.E6.m1.1.1.3.3.2.3">𝑇</ci></apply><ci id="S3.E6.m1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\mathcal{G}=\mathcal{W}\times_{1}U^{T}_{1}\dots\times_{M}U^{T}_{M}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.5" class="ltx_p">where <math id="S3.SS2.p3.2.m1.1" class="ltx_Math" alttext="U_{n}" display="inline"><semantics id="S3.SS2.p3.2.m1.1a"><msub id="S3.SS2.p3.2.m1.1.1" xref="S3.SS2.p3.2.m1.1.1.cmml"><mi id="S3.SS2.p3.2.m1.1.1.2" xref="S3.SS2.p3.2.m1.1.1.2.cmml">U</mi><mi id="S3.SS2.p3.2.m1.1.1.3" xref="S3.SS2.p3.2.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m1.1b"><apply id="S3.SS2.p3.2.m1.1.1.cmml" xref="S3.SS2.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m1.1.1.1.cmml" xref="S3.SS2.p3.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m1.1.1.2.cmml" xref="S3.SS2.p3.2.m1.1.1.2">𝑈</ci><ci id="S3.SS2.p3.2.m1.1.1.3.cmml" xref="S3.SS2.p3.2.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m1.1c">U_{n}</annotation></semantics></math> is the <math id="S3.SS2.p3.3.m2.1" class="ltx_Math" alttext="U" display="inline"><semantics id="S3.SS2.p3.3.m2.1a"><mi id="S3.SS2.p3.3.m2.1.1" xref="S3.SS2.p3.3.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m2.1b"><ci id="S3.SS2.p3.3.m2.1.1.cmml" xref="S3.SS2.p3.3.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m2.1c">U</annotation></semantics></math> matrix from the SVD of the the mode-<math id="S3.SS2.p3.4.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p3.4.m3.1a"><mi id="S3.SS2.p3.4.m3.1.1" xref="S3.SS2.p3.4.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m3.1b"><ci id="S3.SS2.p3.4.m3.1.1.cmml" xref="S3.SS2.p3.4.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m3.1c">n</annotation></semantics></math> flattening of <math id="S3.SS2.p3.5.m4.1" class="ltx_Math" alttext="\mathcal{W}" display="inline"><semantics id="S3.SS2.p3.5.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.5.m4.1.1" xref="S3.SS2.p3.5.m4.1.1.cmml">𝒲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m4.1b"><ci id="S3.SS2.p3.5.m4.1.1.cmml" xref="S3.SS2.p3.5.m4.1.1">𝒲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m4.1c">\mathcal{W}</annotation></semantics></math>. However, note that aside from (optionally) performing this once for initialization, we do <em id="S3.SS2.p3.5.1" class="ltx_emph ltx_font_italic">not</em> perform this costly HO-SVD operation during learning.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.4" class="ltx_p"><span id="S3.SS2.p4.4.1" class="ltx_text ltx_font_bold">Inference and Learning</span> To make predictions for a particular domain, we synthesize a concrete CNN by multiplying out the parameters <math id="S3.SS2.p4.1.m1.4" class="ltx_Math" alttext="\{\mathcal{G},U_{1},\dots,U_{M}\}" display="inline"><semantics id="S3.SS2.p4.1.m1.4a"><mrow id="S3.SS2.p4.1.m1.4.4.2" xref="S3.SS2.p4.1.m1.4.4.3.cmml"><mo stretchy="false" id="S3.SS2.p4.1.m1.4.4.2.3" xref="S3.SS2.p4.1.m1.4.4.3.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">𝒢</mi><mo id="S3.SS2.p4.1.m1.4.4.2.4" xref="S3.SS2.p4.1.m1.4.4.3.cmml">,</mo><msub id="S3.SS2.p4.1.m1.3.3.1.1" xref="S3.SS2.p4.1.m1.3.3.1.1.cmml"><mi id="S3.SS2.p4.1.m1.3.3.1.1.2" xref="S3.SS2.p4.1.m1.3.3.1.1.2.cmml">U</mi><mn id="S3.SS2.p4.1.m1.3.3.1.1.3" xref="S3.SS2.p4.1.m1.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p4.1.m1.4.4.2.5" xref="S3.SS2.p4.1.m1.4.4.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p4.1.m1.2.2" xref="S3.SS2.p4.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.p4.1.m1.4.4.2.6" xref="S3.SS2.p4.1.m1.4.4.3.cmml">,</mo><msub id="S3.SS2.p4.1.m1.4.4.2.2" xref="S3.SS2.p4.1.m1.4.4.2.2.cmml"><mi id="S3.SS2.p4.1.m1.4.4.2.2.2" xref="S3.SS2.p4.1.m1.4.4.2.2.2.cmml">U</mi><mi id="S3.SS2.p4.1.m1.4.4.2.2.3" xref="S3.SS2.p4.1.m1.4.4.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS2.p4.1.m1.4.4.2.7" xref="S3.SS2.p4.1.m1.4.4.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.4b"><set id="S3.SS2.p4.1.m1.4.4.3.cmml" xref="S3.SS2.p4.1.m1.4.4.2"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝒢</ci><apply id="S3.SS2.p4.1.m1.3.3.1.1.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1.2">𝑈</ci><cn type="integer" id="S3.SS2.p4.1.m1.3.3.1.1.3.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1.3">1</cn></apply><ci id="S3.SS2.p4.1.m1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2">…</ci><apply id="S3.SS2.p4.1.m1.4.4.2.2.cmml" xref="S3.SS2.p4.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.4.4.2.2.1.cmml" xref="S3.SS2.p4.1.m1.4.4.2.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.p4.1.m1.4.4.2.2.2">𝑈</ci><ci id="S3.SS2.p4.1.m1.4.4.2.2.3.cmml" xref="S3.SS2.p4.1.m1.4.4.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.4c">\{\mathcal{G},U_{1},\dots,U_{M}\}</annotation></semantics></math> after that doing an inner product with the corresponding domain’s <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">z</annotation></semantics></math>. This CNN can then be used to classify an input instance <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">x</annotation></semantics></math>. Since our method does not introduce any non-differentiable functions, we can use standard back-propagation to learn <math id="S3.SS2.p4.4.m4.4" class="ltx_Math" alttext="\{\mathcal{G},U_{1},\dots,U_{M}\}" display="inline"><semantics id="S3.SS2.p4.4.m4.4a"><mrow id="S3.SS2.p4.4.m4.4.4.2" xref="S3.SS2.p4.4.m4.4.4.3.cmml"><mo stretchy="false" id="S3.SS2.p4.4.m4.4.4.2.3" xref="S3.SS2.p4.4.m4.4.4.3.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">𝒢</mi><mo id="S3.SS2.p4.4.m4.4.4.2.4" xref="S3.SS2.p4.4.m4.4.4.3.cmml">,</mo><msub id="S3.SS2.p4.4.m4.3.3.1.1" xref="S3.SS2.p4.4.m4.3.3.1.1.cmml"><mi id="S3.SS2.p4.4.m4.3.3.1.1.2" xref="S3.SS2.p4.4.m4.3.3.1.1.2.cmml">U</mi><mn id="S3.SS2.p4.4.m4.3.3.1.1.3" xref="S3.SS2.p4.4.m4.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p4.4.m4.4.4.2.5" xref="S3.SS2.p4.4.m4.4.4.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p4.4.m4.2.2" xref="S3.SS2.p4.4.m4.2.2.cmml">…</mi><mo id="S3.SS2.p4.4.m4.4.4.2.6" xref="S3.SS2.p4.4.m4.4.4.3.cmml">,</mo><msub id="S3.SS2.p4.4.m4.4.4.2.2" xref="S3.SS2.p4.4.m4.4.4.2.2.cmml"><mi id="S3.SS2.p4.4.m4.4.4.2.2.2" xref="S3.SS2.p4.4.m4.4.4.2.2.2.cmml">U</mi><mi id="S3.SS2.p4.4.m4.4.4.2.2.3" xref="S3.SS2.p4.4.m4.4.4.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS2.p4.4.m4.4.4.2.7" xref="S3.SS2.p4.4.m4.4.4.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.4b"><set id="S3.SS2.p4.4.m4.4.4.3.cmml" xref="S3.SS2.p4.4.m4.4.4.2"><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝒢</ci><apply id="S3.SS2.p4.4.m4.3.3.1.1.cmml" xref="S3.SS2.p4.4.m4.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.3.3.1.1.1.cmml" xref="S3.SS2.p4.4.m4.3.3.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.3.3.1.1.2.cmml" xref="S3.SS2.p4.4.m4.3.3.1.1.2">𝑈</ci><cn type="integer" id="S3.SS2.p4.4.m4.3.3.1.1.3.cmml" xref="S3.SS2.p4.4.m4.3.3.1.1.3">1</cn></apply><ci id="S3.SS2.p4.4.m4.2.2.cmml" xref="S3.SS2.p4.4.m4.2.2">…</ci><apply id="S3.SS2.p4.4.m4.4.4.2.2.cmml" xref="S3.SS2.p4.4.m4.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.4.4.2.2.1.cmml" xref="S3.SS2.p4.4.m4.4.4.2.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.4.4.2.2.2.cmml" xref="S3.SS2.p4.4.m4.4.4.2.2.2">𝑈</ci><ci id="S3.SS2.p4.4.m4.4.4.2.2.3.cmml" xref="S3.SS2.p4.4.m4.4.4.2.2.3">𝑀</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.4c">\{\mathcal{G},U_{1},\dots,U_{M}\}</annotation></semantics></math> for every layer.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.3" class="ltx_p">For our model there are hyperparameters – Tucker rank <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="[K_{1}\dots K_{M}]" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.1.m1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.1.cmml">[</mo><mrow id="S3.SS2.p5.1.m1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.cmml"><msub id="S3.SS2.p5.1.m1.1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.1.1.2.2" xref="S3.SS2.p5.1.m1.1.1.1.1.2.2.cmml">K</mi><mn id="S3.SS2.p5.1.m1.1.1.1.1.2.3" xref="S3.SS2.p5.1.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS2.p5.1.m1.1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.1.1.1a" xref="S3.SS2.p5.1.m1.1.1.1.1.1.cmml">​</mo><msub id="S3.SS2.p5.1.m1.1.1.1.1.4" xref="S3.SS2.p5.1.m1.1.1.1.1.4.cmml"><mi id="S3.SS2.p5.1.m1.1.1.1.1.4.2" xref="S3.SS2.p5.1.m1.1.1.1.1.4.2.cmml">K</mi><mi id="S3.SS2.p5.1.m1.1.1.1.1.4.3" xref="S3.SS2.p5.1.m1.1.1.1.1.4.3.cmml">M</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p5.1.m1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p5.1.m1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS2.p5.1.m1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1"><times id="S3.SS2.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1"></times><apply id="S3.SS2.p5.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.2.2">𝐾</ci><cn type="integer" id="S3.SS2.p5.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.p5.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.3">…</ci><apply id="S3.SS2.p5.1.m1.1.1.1.1.4.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.1.4.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.1.1.4.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.4.2">𝐾</ci><ci id="S3.SS2.p5.1.m1.1.1.1.1.4.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.4.3">𝑀</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">[K_{1}\dots K_{M}]</annotation></semantics></math> – that can potentially be set at each layer. We sidestep the need to set all of these, by using the strategy of decomposing the stack of (ImageNet pre-trained) single domain models plus one agnostic domain model through Tucker decomposition, and then applying a reconstruction error threshold of <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\epsilon=10\%" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">ϵ</mi><mo id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mn id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml">10</mn><mo id="S3.SS2.p5.2.m2.1.1.3.1" xref="S3.SS2.p5.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><eq id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1"></eq><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">italic-ϵ</ci><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><csymbol cd="latexml" id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\epsilon=10\%</annotation></semantics></math> for the HO-SVD in Eq <a href="#S3.E6" title="In 3.2 Low rank parameterized CNNs ‣ 3 Methodology ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. This effectively determines all rank values via one ‘sharing strength’ hyperparameter <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><mi id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\epsilon</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>New Domain Generalization Dataset: PACS</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Our <span id="S4.SS1.p1.1.1" class="ltx_text" style="color:#000000;">PACS</span> DG dataset is created by intersecting the classes found in Caltech256 (Photo), Sketchy (Photo, Sketch) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, TU-Berlin (Sketch) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and Google Images (Art painting, Cartoon, Photo). Our dataset and code, together with latest results using alternative state-of-the-art base networks, can be found at: <span id="S4.SS1.p1.1.2" class="ltx_ERROR undefined">\url</span>http://sketchx.eecs.qmul.ac.uk/.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">PACS:</span> Our new benchmark includes 4 domains (Photo, Sketch, Cartoon, Painting), and 7 common categories ‘dog’, ‘elephant’, ‘giraffe’. ‘guitar’, ‘horse’, ‘house’, ‘person’. The total number of images is 9991.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.03077/assets/x2.png" id="S4.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="477" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Average KLD between domains.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.03077/assets/x3.png" id="S4.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="339" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">The feature distribution of VLCS</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S4.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.03077/assets/x4.png" id="S4.F2.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="339" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F2.sf3.3.2" class="ltx_text" style="font-size:90%;">The feature distribution of PACS</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Evaluation of domain shift in different domain generalization benchmarks.</span></figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Characterizing Benchmarks’ Domain Shifts</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">We first perform a preliminary analysis to contrast the domain shift within our PACS dataset to that of prior popular datasets such as VLCS. We make this contrast from both a feature space and a classifier performance perspective.
<br class="ltx_break"><span id="S4.SS2.p1.6.2" class="ltx_text ltx_font_bold">Feature Space Analysis</span> Given the DG setting of training on source domains and applying to held out test domain(s), we measure the shift between source and target domains based on the Kullback-Leibler divergence as: <math id="S4.SS2.p1.1.m1.1" class="ltx_math_unparsed" alttext="D_{shift}(D^{s},D^{t})=\frac{1}{m\times n}\sum\limits_{i}^{n}\sum\limits_{j}^{m}\lambda_{i}KLD(D_{i}^{s}||D_{j}^{t})" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1b"><msub id="S4.SS2.p1.1.m1.1.1"><mi id="S4.SS2.p1.1.m1.1.1.2">D</mi><mrow id="S4.SS2.p1.1.m1.1.1.3"><mi id="S4.SS2.p1.1.m1.1.1.3.2">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.3">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1a">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.4">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1b">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.5">f</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1c">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.6">t</mi></mrow></msub><mrow id="S4.SS2.p1.1.m1.1.2"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.1">(</mo><msup id="S4.SS2.p1.1.m1.1.2.2"><mi id="S4.SS2.p1.1.m1.1.2.2.2">D</mi><mi id="S4.SS2.p1.1.m1.1.2.2.3">s</mi></msup><mo id="S4.SS2.p1.1.m1.1.2.3">,</mo><msup id="S4.SS2.p1.1.m1.1.2.4"><mi id="S4.SS2.p1.1.m1.1.2.4.2">D</mi><mi id="S4.SS2.p1.1.m1.1.2.4.3">t</mi></msup><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.5">)</mo></mrow><mo id="S4.SS2.p1.1.m1.1.3">=</mo><mfrac id="S4.SS2.p1.1.m1.1.4"><mn id="S4.SS2.p1.1.m1.1.4.2">1</mn><mrow id="S4.SS2.p1.1.m1.1.4.3"><mi id="S4.SS2.p1.1.m1.1.4.3.2">m</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.1.m1.1.4.3.1">×</mo><mi id="S4.SS2.p1.1.m1.1.4.3.3">n</mi></mrow></mfrac><munderover id="S4.SS2.p1.1.m1.1.5"><mo movablelimits="false" rspace="0em" id="S4.SS2.p1.1.m1.1.5.2.2">∑</mo><mi id="S4.SS2.p1.1.m1.1.5.2.3">i</mi><mi id="S4.SS2.p1.1.m1.1.5.3">n</mi></munderover><munderover id="S4.SS2.p1.1.m1.1.6"><mo movablelimits="false" id="S4.SS2.p1.1.m1.1.6.2.2">∑</mo><mi id="S4.SS2.p1.1.m1.1.6.2.3">j</mi><mi id="S4.SS2.p1.1.m1.1.6.3">m</mi></munderover><msub id="S4.SS2.p1.1.m1.1.7"><mi id="S4.SS2.p1.1.m1.1.7.2">λ</mi><mi id="S4.SS2.p1.1.m1.1.7.3">i</mi></msub><mi id="S4.SS2.p1.1.m1.1.8">K</mi><mi id="S4.SS2.p1.1.m1.1.9">L</mi><mi id="S4.SS2.p1.1.m1.1.10">D</mi><mrow id="S4.SS2.p1.1.m1.1.11"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.11.1">(</mo><msubsup id="S4.SS2.p1.1.m1.1.11.2"><mi id="S4.SS2.p1.1.m1.1.11.2.2.2">D</mi><mi id="S4.SS2.p1.1.m1.1.11.2.2.3">i</mi><mi id="S4.SS2.p1.1.m1.1.11.2.3">s</mi></msubsup><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.p1.1.m1.1.11.3">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.SS2.p1.1.m1.1.11.4">|</mo><msubsup id="S4.SS2.p1.1.m1.1.11.5"><mi id="S4.SS2.p1.1.m1.1.11.5.2.2">D</mi><mi id="S4.SS2.p1.1.m1.1.11.5.2.3">j</mi><mi id="S4.SS2.p1.1.m1.1.11.5.3">t</mi></msubsup><mo stretchy="false" id="S4.SS2.p1.1.m1.1.11.6">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">D_{shift}(D^{s},D^{t})=\frac{1}{m\times n}\sum\limits_{i}^{n}\sum\limits_{j}^{m}\lambda_{i}KLD(D_{i}^{s}||D_{j}^{t})</annotation></semantics></math>,
where <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">n</annotation></semantics></math> and <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">m</annotation></semantics></math> are the number of source and target domains, and <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\lambda_{i}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">λ</mi><mi id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝜆</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\lambda_{i}</annotation></semantics></math> weights the <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">i</annotation></semantics></math> th source domain, to account for data imbalance. To encode each domain as a probability, <span id="S4.SS2.p1.6.1" class="ltx_text" style="color:#000000;">we calculate the mean DECAF<sub id="S4.SS2.p1.6.1.1" class="ltx_sub">7</sub> representation over instances and then apply softmax normalization</span>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Classifier Performance Analysis</span> We also compare the datasets by the margin between multiclass classification accuracy of within-domain learning, and a simple cross-domain baseline of training a CNN on all the source domains before testing on the held out target domain (as we shall see later, this baseline is very competitive). Assuming within-domain learning performance is an upper bound, then this difference indicates the space which a DG method has to make a contribution, and hence roughly reflects size of the domain-shift/difficulty of the DG task.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.03077/assets/x5.png" id="S4.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="230" height="55" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Measuring domain-shift by within versus across domain accuracy. Left: Our PACS, Middle: VLCS. Right: Distribution of margins between within and across domain accuracy.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.03077/assets/x6.png" id="S4.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="230" height="183" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Per-layer rank (inverse sharing strength) after learning for different held out domains.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Cross-domain similarity (a) and learned sharing strength by layer (b).</span></figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Results</span> Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 New Domain Generalization Dataset: PACS ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a) shows the average domain-shift in terms of KLD across all choices of held out domain in our new PACS benchmark, compared with the VLCS benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Clearly the domain shift is significantly higher in our new benchmark, as is visually intuitive from the illustrative examples in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. To provide a qualitative summarization, we also show the distribution of features in our PACS compared to VLCS in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.1 New Domain Generalization Dataset: PACS ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b,c) as visualized by a 2 dimensional t-SNE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> plot, where the features are categorized and colored by their associated domain. From this result, we can see that the VLCS data are generally hard to separate by domain, while our PACS data are much more separated by domain. This illustrates the greater degree of shift between the domains in PACS over VLCS.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.2" class="ltx_p">We next explore the domain shifts from a model-, rather than feature-centric perspective. Fig. <a href="#S4.F3.sf1" title="In Figure 3 ‣ 4.2 Characterizing Benchmarks’ Domain Shifts ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(a)</span></a> summarizes the within-domain and across-domain performance for each domain within PACS and VLCS benchmarks. The average drop in performance due to cross-domain transfer is <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="20.2\%" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mn id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">20.2</mn><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">20.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">20.2\%</annotation></semantics></math> for PACS versus <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="10.0\%" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mn id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">10.0</mn><mo id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">10.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">10.0\%</annotation></semantics></math> for VLCS. This shows that the scope for contribution of DG/DA in our PACS is double that of VLCS, and illustrates the greater relevance and challenge of the PACS benchmark.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Domain Generalization Experiments</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Datasets and Settings</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">We evaluate our proposed method on two datasets: VLCS, and our proposed PACS dataset. <span id="S4.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_bold">VLCS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> aggregates photos from Caltech, LabelMe, Pascal VOC 2007 and SUN09. It provides a 5-way multiclass benchmark on the five common classes: ’bird’,’car’,’chair’,’dog’ and ’person’.
Our <span id="S4.SS3.SSS1.p1.1.2" class="ltx_text ltx_font_bold">PACS</span> (described in Sec. <a href="#S4.SS1" title="4.1 New Domain Generalization Dataset: PACS ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>) with 7 classes
from Photo, Sketch, Cartoon, Painting domains.
All results are evaluated by multi-class accuracy, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. We explore features including <span id="S4.SS3.SSS1.p1.1.3" class="ltx_text ltx_font_bold">Classic</span> SIFT features (for direct comparison with earlier work), <span id="S4.SS3.SSS1.p1.1.4" class="ltx_text ltx_font_bold">DECAF</span> pre-extracted deep features following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and <span id="S4.SS3.SSS1.p1.1.5" class="ltx_text ltx_font_bold">E2E</span> end-to-end CNN learning.</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p2.7" class="ltx_p"><span id="S4.SS3.SSS1.p2.7.1" class="ltx_text ltx_font_bold">Settings:</span> For our method in E2E configuration, we use the ImageNet pre-trained AlexNet CNN, fine-tuned with multi-domain learning on the training domains. On VLCS, we follow the train-test split strategy from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
Our initial learning rate is 5e-5 and batch size is 64 for each training domain. We use the best performed model on validation to do the test after tuning the model for 25<math id="S4.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.SSS1.p2.1.m1.1a"><mi id="S4.SS3.SSS1.p2.1.m1.1.1" xref="S4.SS3.SSS1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.1.m1.1b"><ci id="S4.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.1.m1.1c">k</annotation></semantics></math> iterations. On PACS, we split the images from training domains to 9 (train) : 1 (val) and test on the whole held-out domain.
Recall that our model uses a 2-hot encoding of <math id="S4.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS3.SSS1.p2.2.m2.1a"><mi id="S4.SS3.SSS1.p2.2.m2.1.1" xref="S4.SS3.SSS1.p2.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.2.m2.1b"><ci id="S4.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p2.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.2.m2.1c">z</annotation></semantics></math> to parameterize the CNN. The domain-specific vs agnostic ‘prior’ can be set by varying the ratio <math id="S4.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS3.SSS1.p2.3.m3.1a"><mi id="S4.SS3.SSS1.p2.3.m3.1.1" xref="S4.SS3.SSS1.p2.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.3.m3.1b"><ci id="S4.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p2.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.3.m3.1c">\rho</annotation></semantics></math> of the elements in the 2-hot coding. For training we use <math id="S4.SS3.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\rho=0.3" display="inline"><semantics id="S4.SS3.SSS1.p2.4.m4.1a"><mrow id="S4.SS3.SSS1.p2.4.m4.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.cmml"><mi id="S4.SS3.SSS1.p2.4.m4.1.1.2" xref="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml">ρ</mi><mo id="S4.SS3.SSS1.p2.4.m4.1.1.1" xref="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS1.p2.4.m4.1.1.3" xref="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.4.m4.1b"><apply id="S4.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1"><eq id="S4.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.1"></eq><ci id="S4.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.2">𝜌</ci><cn type="float" id="S4.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p2.4.m4.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.4.m4.1c">\rho=0.3</annotation></semantics></math>, so <math id="S4.SS3.SSS1.p2.5.m5.4" class="ltx_math_unparsed" alttext="z=\{[0,0,0.3,1]" display="inline"><semantics id="S4.SS3.SSS1.p2.5.m5.4a"><mrow id="S4.SS3.SSS1.p2.5.m5.4b"><mi id="S4.SS3.SSS1.p2.5.m5.4.5">z</mi><mo id="S4.SS3.SSS1.p2.5.m5.4.6">=</mo><mrow id="S4.SS3.SSS1.p2.5.m5.4.7"><mo stretchy="false" id="S4.SS3.SSS1.p2.5.m5.4.7.1">{</mo><mrow id="S4.SS3.SSS1.p2.5.m5.4.7.2"><mo stretchy="false" id="S4.SS3.SSS1.p2.5.m5.4.7.2.1">[</mo><mn id="S4.SS3.SSS1.p2.5.m5.1.1">0</mn><mo id="S4.SS3.SSS1.p2.5.m5.4.7.2.2">,</mo><mn id="S4.SS3.SSS1.p2.5.m5.2.2">0</mn><mo id="S4.SS3.SSS1.p2.5.m5.4.7.2.3">,</mo><mn id="S4.SS3.SSS1.p2.5.m5.3.3">0.3</mn><mo id="S4.SS3.SSS1.p2.5.m5.4.7.2.4">,</mo><mn id="S4.SS3.SSS1.p2.5.m5.4.4">1</mn><mo stretchy="false" id="S4.SS3.SSS1.p2.5.m5.4.7.2.5">]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.5.m5.4c">z=\{[0,0,0.3,1]</annotation></semantics></math>, <math id="S4.SS3.SSS1.p2.6.m6.5" class="ltx_math_unparsed" alttext="[0,0.3,0,1],...\}" display="inline"><semantics id="S4.SS3.SSS1.p2.6.m6.5a"><mrow id="S4.SS3.SSS1.p2.6.m6.5b"><mrow id="S4.SS3.SSS1.p2.6.m6.5.6"><mo stretchy="false" id="S4.SS3.SSS1.p2.6.m6.5.6.1">[</mo><mn id="S4.SS3.SSS1.p2.6.m6.1.1">0</mn><mo id="S4.SS3.SSS1.p2.6.m6.5.6.2">,</mo><mn id="S4.SS3.SSS1.p2.6.m6.2.2">0.3</mn><mo id="S4.SS3.SSS1.p2.6.m6.5.6.3">,</mo><mn id="S4.SS3.SSS1.p2.6.m6.3.3">0</mn><mo id="S4.SS3.SSS1.p2.6.m6.5.6.4">,</mo><mn id="S4.SS3.SSS1.p2.6.m6.4.4">1</mn><mo stretchy="false" id="S4.SS3.SSS1.p2.6.m6.5.6.5">]</mo></mrow><mo id="S4.SS3.SSS1.p2.6.m6.5.7">,</mo><mi mathvariant="normal" id="S4.SS3.SSS1.p2.6.m6.5.5">…</mi><mo stretchy="false" id="S4.SS3.SSS1.p2.6.m6.5.8">}</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.6.m6.5c">[0,0.3,0,1],...\}</annotation></semantics></math>. For DG testing we use <math id="S4.SS3.SSS1.p2.7.m7.4" class="ltx_Math" alttext="z=[0,0,0,1]" display="inline"><semantics id="S4.SS3.SSS1.p2.7.m7.4a"><mrow id="S4.SS3.SSS1.p2.7.m7.4.5" xref="S4.SS3.SSS1.p2.7.m7.4.5.cmml"><mi id="S4.SS3.SSS1.p2.7.m7.4.5.2" xref="S4.SS3.SSS1.p2.7.m7.4.5.2.cmml">z</mi><mo id="S4.SS3.SSS1.p2.7.m7.4.5.1" xref="S4.SS3.SSS1.p2.7.m7.4.5.1.cmml">=</mo><mrow id="S4.SS3.SSS1.p2.7.m7.4.5.3.2" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS1.p2.7.m7.4.5.3.2.1" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml">[</mo><mn id="S4.SS3.SSS1.p2.7.m7.1.1" xref="S4.SS3.SSS1.p2.7.m7.1.1.cmml">0</mn><mo id="S4.SS3.SSS1.p2.7.m7.4.5.3.2.2" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p2.7.m7.2.2" xref="S4.SS3.SSS1.p2.7.m7.2.2.cmml">0</mn><mo id="S4.SS3.SSS1.p2.7.m7.4.5.3.2.3" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p2.7.m7.3.3" xref="S4.SS3.SSS1.p2.7.m7.3.3.cmml">0</mn><mo id="S4.SS3.SSS1.p2.7.m7.4.5.3.2.4" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml">,</mo><mn id="S4.SS3.SSS1.p2.7.m7.4.4" xref="S4.SS3.SSS1.p2.7.m7.4.4.cmml">1</mn><mo stretchy="false" id="S4.SS3.SSS1.p2.7.m7.4.5.3.2.5" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p2.7.m7.4b"><apply id="S4.SS3.SSS1.p2.7.m7.4.5.cmml" xref="S4.SS3.SSS1.p2.7.m7.4.5"><eq id="S4.SS3.SSS1.p2.7.m7.4.5.1.cmml" xref="S4.SS3.SSS1.p2.7.m7.4.5.1"></eq><ci id="S4.SS3.SSS1.p2.7.m7.4.5.2.cmml" xref="S4.SS3.SSS1.p2.7.m7.4.5.2">𝑧</ci><list id="S4.SS3.SSS1.p2.7.m7.4.5.3.1.cmml" xref="S4.SS3.SSS1.p2.7.m7.4.5.3.2"><cn type="integer" id="S4.SS3.SSS1.p2.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p2.7.m7.1.1">0</cn><cn type="integer" id="S4.SS3.SSS1.p2.7.m7.2.2.cmml" xref="S4.SS3.SSS1.p2.7.m7.2.2">0</cn><cn type="integer" id="S4.SS3.SSS1.p2.7.m7.3.3.cmml" xref="S4.SS3.SSS1.p2.7.m7.3.3">0</cn><cn type="integer" id="S4.SS3.SSS1.p2.7.m7.4.4.cmml" xref="S4.SS3.SSS1.p2.7.m7.4.4">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p2.7.m7.4c">z=[0,0,0,1]</annotation></semantics></math>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:520.0pt;height:109.3pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-42.3pt,8.8pt) scale(0.86,0.86) ;">
<table id="S4.T1.2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.2.1.1.1" class="ltx_tr">
<th id="S4.T1.2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T1.2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Unseen domain</span></th>
<th id="S4.T1.2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S4.T1.2.1.1.1.2.1" class="ltx_text" style="font-size:90%;">Bird</span></th>
<th id="S4.T1.2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S4.T1.2.1.1.1.3.1" class="ltx_text" style="font-size:90%;">Car</span></th>
<th id="S4.T1.2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S4.T1.2.1.1.1.4.1" class="ltx_text" style="font-size:90%;">Chair</span></th>
<th id="S4.T1.2.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S4.T1.2.1.1.1.5.1" class="ltx_text" style="font-size:90%;">Dog</span></th>
<th id="S4.T1.2.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2"><span id="S4.T1.2.1.1.1.6.1" class="ltx_text" style="font-size:90%;">Person</span></th>
</tr>
<tr id="S4.T1.2.1.2.2" class="ltx_tr">
<th id="S4.T1.2.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.1.1" class="ltx_text" style="font-size:90%;">Undo bias</span></th>
<th id="S4.T1.2.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.2.1" class="ltx_text" style="font-size:90%;">Ours-MLP</span></th>
<th id="S4.T1.2.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.3.1" class="ltx_text" style="font-size:90%;">Undo bias</span></th>
<th id="S4.T1.2.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.4.1" class="ltx_text" style="font-size:90%;">Ours-MLP</span></th>
<th id="S4.T1.2.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.5.1" class="ltx_text" style="font-size:90%;">Undo bias</span></th>
<th id="S4.T1.2.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.6.1" class="ltx_text" style="font-size:90%;">Ours-MLP</span></th>
<th id="S4.T1.2.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.7.1" class="ltx_text" style="font-size:90%;">Undo bias</span></th>
<th id="S4.T1.2.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.8.1" class="ltx_text" style="font-size:90%;">Ours-MLP</span></th>
<th id="S4.T1.2.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.9.1" class="ltx_text" style="font-size:90%;">Undo bias</span></th>
<th id="S4.T1.2.1.2.2.10" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.T1.2.1.2.2.10.1" class="ltx_text" style="font-size:90%;">Ours-MLP</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.2.1.3.1" class="ltx_tr">
<td id="S4.T1.2.1.3.1.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.1.1" class="ltx_text" style="font-size:90%;">Caltech</span></td>
<td id="S4.T1.2.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">12.08</span></td>
<td id="S4.T1.2.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.3.1" class="ltx_text" style="font-size:90%;">10.89</span></td>
<td id="S4.T1.2.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.80</span></td>
<td id="S4.T1.2.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.5.1" class="ltx_text" style="font-size:90%;">61.29</span></td>
<td id="S4.T1.2.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.6.1" class="ltx_text" style="font-size:90%;">7.54</span></td>
<td id="S4.T1.2.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">11.26</span></td>
<td id="S4.T1.2.1.3.1.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">5.24</span></td>
<td id="S4.T1.2.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.9.1" class="ltx_text" style="font-size:90%;">3.90</span></td>
<td id="S4.T1.2.1.3.1.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.10.1" class="ltx_text ltx_font_bold" style="font-size:90%;">50.81</span></td>
<td id="S4.T1.2.1.3.1.11" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.1.3.1.11.1" class="ltx_text" style="font-size:90%;">48.48</span></td>
</tr>
<tr id="S4.T1.2.1.4.2" class="ltx_tr">
<td id="S4.T1.2.1.4.2.1" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.1.1" class="ltx_text" style="font-size:90%;">LabelMe</span></td>
<td id="S4.T1.2.1.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">33.08</span></td>
<td id="S4.T1.2.1.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.3.1" class="ltx_text" style="font-size:90%;">28.35</span></td>
<td id="S4.T1.2.1.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.4.1" class="ltx_text" style="font-size:90%;">69.22</span></td>
<td id="S4.T1.2.1.4.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.07</span></td>
<td id="S4.T1.2.1.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">5.34</span></td>
<td id="S4.T1.2.1.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.7.1" class="ltx_text" style="font-size:90%;">3.68</span></td>
<td id="S4.T1.2.1.4.2.8" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.8.1" class="ltx_text" style="font-size:90%;">1.66</span></td>
<td id="S4.T1.2.1.4.2.9" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">2.06</span></td>
<td id="S4.T1.2.1.4.2.10" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.10.1" class="ltx_text" style="font-size:90%;">64.85</span></td>
<td id="S4.T1.2.1.4.2.11" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.4.2.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.00</span></td>
</tr>
<tr id="S4.T1.2.1.5.3" class="ltx_tr">
<td id="S4.T1.2.1.5.3.1" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.1.1" class="ltx_text" style="font-size:90%;">Pascal</span></td>
<td id="S4.T1.2.1.5.3.2" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">15.42</span></td>
<td id="S4.T1.2.1.5.3.3" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.3.1" class="ltx_text" style="font-size:90%;">13.63</span></td>
<td id="S4.T1.2.1.5.3.4" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.4.1" class="ltx_text" style="font-size:90%;">37.49</span></td>
<td id="S4.T1.2.1.5.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">42.81</span></td>
<td id="S4.T1.2.1.5.3.6" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.6.1" class="ltx_text" style="font-size:90%;">30.05</span></td>
<td id="S4.T1.2.1.5.3.7" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">32.71</span></td>
<td id="S4.T1.2.1.5.3.8" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.8.1" class="ltx_text" style="font-size:90%;">14.97</span></td>
<td id="S4.T1.2.1.5.3.9" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">15.93</span></td>
<td id="S4.T1.2.1.5.3.10" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.10.1" class="ltx_text" style="font-size:90%;">58.47</span></td>
<td id="S4.T1.2.1.5.3.11" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.5.3.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.61</span></td>
</tr>
<tr id="S4.T1.2.1.6.4" class="ltx_tr">
<td id="S4.T1.2.1.6.4.1" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.1.1" class="ltx_text" style="font-size:90%;">Sun</span></td>
<td id="S4.T1.2.1.6.4.2" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.2.1" class="ltx_text" style="font-size:90%;">0.59</span></td>
<td id="S4.T1.2.1.6.4.3" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">2.01</span></td>
<td id="S4.T1.2.1.6.4.4" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.4.1" class="ltx_text" style="font-size:90%;">70.62</span></td>
<td id="S4.T1.2.1.6.4.5" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">71.32</span></td>
<td id="S4.T1.2.1.6.4.6" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.6.1" class="ltx_text" style="font-size:90%;">37.44</span></td>
<td id="S4.T1.2.1.6.4.7" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">37.50</span></td>
<td id="S4.T1.2.1.6.4.8" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.8.1" class="ltx_text" style="font-size:90%;">1.12</span></td>
<td id="S4.T1.2.1.6.4.9" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">1.89</span></td>
<td id="S4.T1.2.1.6.4.10" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.10.1" class="ltx_text" style="font-size:90%;">42.20</span></td>
<td id="S4.T1.2.1.6.4.11" class="ltx_td ltx_align_center"><span id="S4.T1.2.1.6.4.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">42.71</span></td>
</tr>
<tr id="S4.T1.2.1.7.5" class="ltx_tr">
<td id="S4.T1.2.1.7.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.1.1" class="ltx_text" style="font-size:90%;">Mean AP %</span></td>
<td id="S4.T1.2.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">15.29</span></td>
<td id="S4.T1.2.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.3.1" class="ltx_text" style="font-size:90%;">13.72</span></td>
<td id="S4.T1.2.1.7.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.4.1" class="ltx_text" style="font-size:90%;">60.28</span></td>
<td id="S4.T1.2.1.7.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">62.37</span></td>
<td id="S4.T1.2.1.7.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.6.1" class="ltx_text" style="font-size:90%;">20.09</span></td>
<td id="S4.T1.2.1.7.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">21.29</span></td>
<td id="S4.T1.2.1.7.5.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.8.1" class="ltx_text" style="font-size:90%;">5.75</span></td>
<td id="S4.T1.2.1.7.5.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">5.94</span></td>
<td id="S4.T1.2.1.7.5.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.10.1" class="ltx_text" style="font-size:90%;">54.08</span></td>
<td id="S4.T1.2.1.7.5.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T1.2.1.7.5.11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">55.45</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison against Undo-Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> on the VLCS benchmark using classic SIFT-BOW features, and our shallow model Ours-MLP. Average precision (%) and mean average precision (%) of binary 1-v-all classification in unseen domains.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<div id="S4.T2.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:888.0pt;height:86.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-208.9pt,20.2pt) scale(0.68,0.68) ;">
<table id="S4.T2.3.3" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T2.3.3.3.4.1" class="ltx_text">Unseen domain</span></td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="9">Image <math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\mapsto</annotation></semantics></math> Deep Feature <math id="S4.T2.2.2.2.2.m2.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T2.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T2.2.2.2.2.m2.1.1" xref="S4.T2.2.2.2.2.m2.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m2.1b"><csymbol cd="latexml" id="S4.T2.2.2.2.2.m2.1.1.cmml" xref="S4.T2.2.2.2.2.m2.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m2.1c">\mapsto</annotation></semantics></math> Classifier</td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="2">Image <math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mo stretchy="false" id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\mapsto</annotation></semantics></math> E2E</td>
</tr>
<tr id="S4.T2.3.3.4.1" class="ltx_tr">
<td id="S4.T2.3.3.4.1.1" class="ltx_td ltx_align_center">SVM</td>
<td id="S4.T2.3.3.4.1.2" class="ltx_td ltx_align_center">1HNN</td>
<td id="S4.T2.3.3.4.1.3" class="ltx_td ltx_align_center">Undo-Bias<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.4" class="ltx_td ltx_align_center">uDICA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.5" class="ltx_td ltx_align_center">UML<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.6" class="ltx_td ltx_align_center">LRE-SVM<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.7" class="ltx_td ltx_align_center">MTAE+1HNN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.8" class="ltx_td ltx_align_center">D-MTAE+1HNN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T2.3.3.4.1.9" class="ltx_td ltx_align_center ltx_border_r">Ours-MLP</td>
<td id="S4.T2.3.3.4.1.10" class="ltx_td ltx_align_center">Deep-All</td>
<td id="S4.T2.3.3.4.1.11" class="ltx_td ltx_align_center">Ours-Full</td>
</tr>
<tr id="S4.T2.3.3.5.2" class="ltx_tr">
<td id="S4.T2.3.3.5.2.1" class="ltx_td ltx_align_center ltx_border_t">Caltech</td>
<td id="S4.T2.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_t">77.67</td>
<td id="S4.T2.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_t">86.67</td>
<td id="S4.T2.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_t">87.50</td>
<td id="S4.T2.3.3.5.2.5" class="ltx_td ltx_align_center ltx_border_t">61.70</td>
<td id="S4.T2.3.3.5.2.6" class="ltx_td ltx_align_center ltx_border_t">91.13</td>
<td id="S4.T2.3.3.5.2.7" class="ltx_td ltx_align_center ltx_border_t">88.11</td>
<td id="S4.T2.3.3.5.2.8" class="ltx_td ltx_align_center ltx_border_t">90.71</td>
<td id="S4.T2.3.3.5.2.9" class="ltx_td ltx_align_center ltx_border_t">89.05</td>
<td id="S4.T2.3.3.5.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">92.43</td>
<td id="S4.T2.3.3.5.2.11" class="ltx_td ltx_align_center ltx_border_t">93.40</td>
<td id="S4.T2.3.3.5.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.3.3.5.2.12.1" class="ltx_text ltx_font_bold">93.63</span></td>
</tr>
<tr id="S4.T2.3.3.6.3" class="ltx_tr">
<td id="S4.T2.3.3.6.3.1" class="ltx_td ltx_align_center">LabelMe</td>
<td id="S4.T2.3.3.6.3.2" class="ltx_td ltx_align_center">52.49</td>
<td id="S4.T2.3.3.6.3.3" class="ltx_td ltx_align_center">58.20</td>
<td id="S4.T2.3.3.6.3.4" class="ltx_td ltx_align_center">58.09</td>
<td id="S4.T2.3.3.6.3.5" class="ltx_td ltx_align_center">46.67</td>
<td id="S4.T2.3.3.6.3.6" class="ltx_td ltx_align_center">58.50</td>
<td id="S4.T2.3.3.6.3.7" class="ltx_td ltx_align_center">59.74</td>
<td id="S4.T2.3.3.6.3.8" class="ltx_td ltx_align_center">59.24</td>
<td id="S4.T2.3.3.6.3.9" class="ltx_td ltx_align_center">60.13</td>
<td id="S4.T2.3.3.6.3.10" class="ltx_td ltx_align_center ltx_border_r">58.74</td>
<td id="S4.T2.3.3.6.3.11" class="ltx_td ltx_align_center">62.11</td>
<td id="S4.T2.3.3.6.3.12" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.6.3.12.1" class="ltx_text ltx_font_bold">63.49</span></td>
</tr>
<tr id="S4.T2.3.3.7.4" class="ltx_tr">
<td id="S4.T2.3.3.7.4.1" class="ltx_td ltx_align_center">Pascal</td>
<td id="S4.T2.3.3.7.4.2" class="ltx_td ltx_align_center">58.86</td>
<td id="S4.T2.3.3.7.4.3" class="ltx_td ltx_align_center">59.10</td>
<td id="S4.T2.3.3.7.4.4" class="ltx_td ltx_align_center">54.29</td>
<td id="S4.T2.3.3.7.4.5" class="ltx_td ltx_align_center">44.41</td>
<td id="S4.T2.3.3.7.4.6" class="ltx_td ltx_align_center">56.26</td>
<td id="S4.T2.3.3.7.4.7" class="ltx_td ltx_align_center">60.58</td>
<td id="S4.T2.3.3.7.4.8" class="ltx_td ltx_align_center">61.09</td>
<td id="S4.T2.3.3.7.4.9" class="ltx_td ltx_align_center">63.90</td>
<td id="S4.T2.3.3.7.4.10" class="ltx_td ltx_align_center ltx_border_r">65.58</td>
<td id="S4.T2.3.3.7.4.11" class="ltx_td ltx_align_center">68.41</td>
<td id="S4.T2.3.3.7.4.12" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.7.4.12.1" class="ltx_text ltx_font_bold">69.99</span></td>
</tr>
<tr id="S4.T2.3.3.8.5" class="ltx_tr">
<td id="S4.T2.3.3.8.5.1" class="ltx_td ltx_align_center">Sun</td>
<td id="S4.T2.3.3.8.5.2" class="ltx_td ltx_align_center">49.09</td>
<td id="S4.T2.3.3.8.5.3" class="ltx_td ltx_align_center">57.86</td>
<td id="S4.T2.3.3.8.5.4" class="ltx_td ltx_align_center">54.21</td>
<td id="S4.T2.3.3.8.5.5" class="ltx_td ltx_align_center">38.56</td>
<td id="S4.T2.3.3.8.5.6" class="ltx_td ltx_align_center">58.49</td>
<td id="S4.T2.3.3.8.5.7" class="ltx_td ltx_align_center">54.88</td>
<td id="S4.T2.3.3.8.5.8" class="ltx_td ltx_align_center">60.20</td>
<td id="S4.T2.3.3.8.5.9" class="ltx_td ltx_align_center">61.33</td>
<td id="S4.T2.3.3.8.5.10" class="ltx_td ltx_align_center ltx_border_r">61.85</td>
<td id="S4.T2.3.3.8.5.11" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.8.5.11.1" class="ltx_text ltx_font_bold">64.16</span></td>
<td id="S4.T2.3.3.8.5.12" class="ltx_td ltx_align_center">61.32</td>
</tr>
<tr id="S4.T2.3.3.9.6" class="ltx_tr">
<td id="S4.T2.3.3.9.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">Ave.%</td>
<td id="S4.T2.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">59.93</td>
<td id="S4.T2.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">65.46</td>
<td id="S4.T2.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">63.52</td>
<td id="S4.T2.3.3.9.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">47.83</td>
<td id="S4.T2.3.3.9.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">65.85</td>
<td id="S4.T2.3.3.9.6.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">65.83</td>
<td id="S4.T2.3.3.9.6.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">67.81</td>
<td id="S4.T2.3.3.9.6.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">68.60</td>
<td id="S4.T2.3.3.9.6.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">69.65</td>
<td id="S4.T2.3.3.9.6.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">72.02</td>
<td id="S4.T2.3.3.9.6.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T2.3.3.9.6.12.1" class="ltx_text ltx_font_bold">72.11</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.5.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S4.T2.6.2" class="ltx_text" style="font-size:90%;">Comparison of features and state of the art on the VLCS benchmark. Multi-class accuracy (%).</span></figcaption>
</figure>
<div id="S4.SS3.SSS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS1.p3.1" class="ltx_p"><span id="S4.SS3.SSS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines:</span> We evaluate our contributions by comparison with number of alternatives including variants designed to reveal insights, and state of the art competitors:
<br class="ltx_break"><span id="S4.SS3.SSS1.p3.1.2" class="ltx_text ltx_font_bold">Ours-MLP:</span> Our DG method applied to a 1 hidden layer multi-layer perception. For use with pre-extracted features.
<br class="ltx_break"><span id="S4.SS3.SSS1.p3.1.3" class="ltx_text ltx_font_bold">Ours-Full:</span> Our full low-rank parameterized CNN trained end-to-end on images.
<span id="S4.SS3.SSS1.p3.1.4" class="ltx_text ltx_font_bold">SVM:</span> Linear SVM, applied on the aggregation of data from all source domains.
<span id="S4.SS3.SSS1.p3.1.5" class="ltx_text ltx_font_bold">Deep-All:</span> Pretrained Alexnet CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, fine-tuned on the aggregation of all source domains.
<span id="S4.SS3.SSS1.p3.1.6" class="ltx_text ltx_font_bold">Undo-Bias:</span> Modifies traditional SVM to include a domain-specific and global weight vector which can be extracted for DG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The original Undo-Bias is a binary classifier (BC). We also implement a multi-class (MC) generalization.
<span id="S4.SS3.SSS1.p3.1.7" class="ltx_text ltx_font_bold">uDICA:</span> A kernel based method learning a subspace to minimize the dissimilarity between domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, we found sDICA to be worse than uDICA, so excluded it.</span></span></span>.
<span id="S4.SS3.SSS1.p3.1.8" class="ltx_text ltx_font_bold">UML</span>: Structural metric learning algorithm learn a low-bias distance metric for classification tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
<span id="S4.SS3.SSS1.p3.1.9" class="ltx_text ltx_font_bold">LRE-SVM:</span> Exploits latent domains, and a nuclear-norm based regularizer on the likelihood matrix of exemplar-SVM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
<span id="S4.SS3.SSS1.p3.1.10" class="ltx_text ltx_font_bold">1HNN</span>: 1 hidden layer neural network.
<span id="S4.SS3.SSS1.p3.1.11" class="ltx_text ltx_font_bold">MTAE-1HNN</span>: 1HNN with multi-task auto encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. <span id="S4.SS3.SSS1.p3.1.12" class="ltx_text ltx_font_bold">D-MTAE-1HNN</span>: 1HNN with de-noising multi-task auto encoder <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
<span id="S4.SS3.SSS1.p3.1.13" class="ltx_text ltx_font_bold">DSN</span>: The domain separation network learns specific and shared models for the source and target domains <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. We re-purpose the original DSN from the domain adaptation to the DG task. Note that DSN is already shown to outperform the related <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>VLCS Benchmark</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p"><span id="S4.SS3.SSS2.p1.1.1" class="ltx_text ltx_font_bold">Classic Benchmark - Binary Classification with Shallow Features</span> Since our approach to extracting a domain invariant model is related to the intuition in Undo Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, we first evaluate our methodology by performing a direct comparison against Undo Bias. We use the same 5376 dimensional VLCS SIFT-BOW features<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span id="footnote2.1" class="ltx_ERROR undefined">\url</span>http://undoingbias.csail.mit.edu/</span></span></span> from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, and compare Our-MLP using one RELU hidden layer with 4096 neurons. For direct comparison, we apply Our-MLP in a 1-vs-All manner as per Undo-Bias. The results in Table <a href="#S4.T1" title="Table 1 ‣ 4.3.1 Datasets and Settings ‣ 4.3 Domain Generalization Experiments ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> show that without exploiting the benefit of end-to-end learning, our approach still performs favorably compared to Undo Bias. This is due to (i) our low-rank modeling of domain-specific and domain-agnostic knowledge, and (ii) the generalization of doing so in a multi-layer network.</p>
</div>
<div id="S4.SS3.SSS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS2.p2.1" class="ltx_p"><span id="S4.SS3.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Multi-class recognition with Deep Learning</span> In this experiment we continue to analyze the VLCS benchmark, but from a multiclass classification perspective. We compare existing DG methods (Undo-Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, UML <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, LRE-SVM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, uDICA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, MTAE+1HNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, D-MTAE+1HNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>) against baselines (1HNN, SVM, Deep) and our methods Ours-MLP/Ours-Full. For the other methods besides Deep-All and Ours-Full, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and use pre-extracted DECAF<sub id="S4.SS3.SSS2.p2.1.2" class="ltx_sub">6</sub> features<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span id="footnote3.1" class="ltx_ERROR undefined">\url</span>http://www.cs.dartmouth.edu/ chenfang/proj_page/FXR_iccv13/index.php</span></span></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. For Deep and Ours-Full, we fine-tune the CNN on the source domains.</p>
</div>
<div id="S4.SS3.SSS2.p3" class="ltx_para">
<p id="S4.SS3.SSS2.p3.1" class="ltx_p">From the results in Table <a href="#S4.T2" title="Table 2 ‣ 4.3.1 Datasets and Settings ‣ 4.3 Domain Generalization Experiments ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we make the following observations: (i) Given the fixed DECAF<sub id="S4.SS3.SSS2.p3.1.1" class="ltx_sub">6</sub> feature, most prior DG methods improve on vanilla SVM, and D-MTAE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> is the best of these. (ii) Ours-MLP outperforms 1HNN, which uses the same type of architecture
and the same feature. This margin is due to our low-rank domain-generalization approach. (iii) The very simple baseline of fine-tuning a deep model on the aggregation of source domains (Deep-All) performs surprisingly well and actually outperforms all the prior DG methods. (iii) Ours-Full outperforms Deep-All slightly. This small margin is understandable. Our model does have more parameters to learn than Deep-All, despite the low rank; and the cost of doing this is not justified by the relatively small domain gap between the VLCS datasets.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1710.03077/assets/x7.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="223" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Visualization of the preferred images of output neurons ‘horse’, ‘giraffe’ and ‘house’ in the domains of the PACS dataset. Left: real images. Middle: synthesized images for PACS domains. Right: synthesized images for agnostic domain.</span></figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:849.5pt;height:107.9pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-75.0pt,9.4pt) scale(0.85,0.85) ;">
<table id="S4.T3.3.3" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.T3.3.3.3.4.1" class="ltx_text">Unseen domain</span></td>
<td id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="6">Image <math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo stretchy="false" id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\mapsto</annotation></semantics></math> Deep Feature <math id="S4.T3.2.2.2.2.m2.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T3.2.2.2.2.m2.1a"><mo stretchy="false" id="S4.T3.2.2.2.2.m2.1.1" xref="S4.T3.2.2.2.2.m2.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m2.1b"><csymbol cd="latexml" id="S4.T3.2.2.2.2.m2.1.1.cmml" xref="S4.T3.2.2.2.2.m2.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m2.1c">\mapsto</annotation></semantics></math> Classifier</td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_t" colspan="3">Image <math id="S4.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="\mapsto" display="inline"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo stretchy="false" id="S4.T3.3.3.3.3.m1.1.1" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↦</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">maps-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\mapsto</annotation></semantics></math> E2E</td>
</tr>
<tr id="S4.T3.3.3.4.1" class="ltx_tr">
<td id="S4.T3.3.3.4.1.1" class="ltx_td ltx_align_center">SVM</td>
<td id="S4.T3.3.3.4.1.2" class="ltx_td ltx_align_center">1HNN</td>
<td id="S4.T3.3.3.4.1.3" class="ltx_td ltx_align_center">uDICA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T3.3.3.4.1.4" class="ltx_td ltx_align_center">LRE-SVM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>
</td>
<td id="S4.T3.3.3.4.1.5" class="ltx_td ltx_align_center">D-MTAE+1HNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>
</td>
<td id="S4.T3.3.3.4.1.6" class="ltx_td ltx_align_center ltx_border_r">Ours-MLP</td>
<td id="S4.T3.3.3.4.1.7" class="ltx_td ltx_align_center">Deep-All</td>
<td id="S4.T3.3.3.4.1.8" class="ltx_td ltx_align_center">DSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</td>
<td id="S4.T3.3.3.4.1.9" class="ltx_td ltx_align_center">Ours-Full</td>
</tr>
<tr id="S4.T3.3.3.5.2" class="ltx_tr">
<td id="S4.T3.3.3.5.2.1" class="ltx_td ltx_align_center ltx_border_t">Art painting</td>
<td id="S4.T3.3.3.5.2.2" class="ltx_td ltx_align_center ltx_border_t">55.39</td>
<td id="S4.T3.3.3.5.2.3" class="ltx_td ltx_align_center ltx_border_t">59.10</td>
<td id="S4.T3.3.3.5.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.3.3.5.2.4.1" class="ltx_text ltx_font_bold">64.57</span></td>
<td id="S4.T3.3.3.5.2.5" class="ltx_td ltx_align_center ltx_border_t">59.74</td>
<td id="S4.T3.3.3.5.2.6" class="ltx_td ltx_align_center ltx_border_t">60.27</td>
<td id="S4.T3.3.3.5.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.40</td>
<td id="S4.T3.3.3.5.2.8" class="ltx_td ltx_align_center ltx_border_t">63.30</td>
<td id="S4.T3.3.3.5.2.9" class="ltx_td ltx_align_center ltx_border_t">61.13</td>
<td id="S4.T3.3.3.5.2.10" class="ltx_td ltx_align_center ltx_border_t">62.86</td>
</tr>
<tr id="S4.T3.3.3.6.3" class="ltx_tr">
<td id="S4.T3.3.3.6.3.1" class="ltx_td ltx_align_center">Cartoon</td>
<td id="S4.T3.3.3.6.3.2" class="ltx_td ltx_align_center">52.86</td>
<td id="S4.T3.3.3.6.3.3" class="ltx_td ltx_align_center">57.89</td>
<td id="S4.T3.3.3.6.3.4" class="ltx_td ltx_align_center">64.54</td>
<td id="S4.T3.3.3.6.3.5" class="ltx_td ltx_align_center">52.81</td>
<td id="S4.T3.3.3.6.3.6" class="ltx_td ltx_align_center">58.65</td>
<td id="S4.T3.3.3.6.3.7" class="ltx_td ltx_align_center ltx_border_r">57.16</td>
<td id="S4.T3.3.3.6.3.8" class="ltx_td ltx_align_center">63.13</td>
<td id="S4.T3.3.3.6.3.9" class="ltx_td ltx_align_center">66.54</td>
<td id="S4.T3.3.3.6.3.10" class="ltx_td ltx_align_center"><span id="S4.T3.3.3.6.3.10.1" class="ltx_text ltx_font_bold">66.97</span></td>
</tr>
<tr id="S4.T3.3.3.7.4" class="ltx_tr">
<td id="S4.T3.3.3.7.4.1" class="ltx_td ltx_align_center">Photo</td>
<td id="S4.T3.3.3.7.4.2" class="ltx_td ltx_align_center">82.83</td>
<td id="S4.T3.3.3.7.4.3" class="ltx_td ltx_align_center">89.86</td>
<td id="S4.T3.3.3.7.4.4" class="ltx_td ltx_align_center"><span id="S4.T3.3.3.7.4.4.1" class="ltx_text ltx_font_bold">91.78</span></td>
<td id="S4.T3.3.3.7.4.5" class="ltx_td ltx_align_center">85.53</td>
<td id="S4.T3.3.3.7.4.6" class="ltx_td ltx_align_center">91.12</td>
<td id="S4.T3.3.3.7.4.7" class="ltx_td ltx_align_center ltx_border_r">89.68</td>
<td id="S4.T3.3.3.7.4.8" class="ltx_td ltx_align_center">87.70</td>
<td id="S4.T3.3.3.7.4.9" class="ltx_td ltx_align_center">83.25</td>
<td id="S4.T3.3.3.7.4.10" class="ltx_td ltx_align_center">89.50</td>
</tr>
<tr id="S4.T3.3.3.8.5" class="ltx_tr">
<td id="S4.T3.3.3.8.5.1" class="ltx_td ltx_align_center">Sketch</td>
<td id="S4.T3.3.3.8.5.2" class="ltx_td ltx_align_center">43.89</td>
<td id="S4.T3.3.3.8.5.3" class="ltx_td ltx_align_center">50.31</td>
<td id="S4.T3.3.3.8.5.4" class="ltx_td ltx_align_center">51.12</td>
<td id="S4.T3.3.3.8.5.5" class="ltx_td ltx_align_center">37.89</td>
<td id="S4.T3.3.3.8.5.6" class="ltx_td ltx_align_center">47.86</td>
<td id="S4.T3.3.3.8.5.7" class="ltx_td ltx_align_center ltx_border_r">50.38</td>
<td id="S4.T3.3.3.8.5.8" class="ltx_td ltx_align_center">54.07</td>
<td id="S4.T3.3.3.8.5.9" class="ltx_td ltx_align_center"><span id="S4.T3.3.3.8.5.9.1" class="ltx_text ltx_font_bold">58.58</span></td>
<td id="S4.T3.3.3.8.5.10" class="ltx_td ltx_align_center">57.51</td>
</tr>
<tr id="S4.T3.3.3.9.6" class="ltx_tr">
<td id="S4.T3.3.3.9.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">Ave.%</td>
<td id="S4.T3.3.3.9.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">58.74</td>
<td id="S4.T3.3.3.9.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">64.29</td>
<td id="S4.T3.3.3.9.6.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">68.00</td>
<td id="S4.T3.3.3.9.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">58.99</td>
<td id="S4.T3.3.3.9.6.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">64.48</td>
<td id="S4.T3.3.3.9.6.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">64.65</td>
<td id="S4.T3.3.3.9.6.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">67.05</td>
<td id="S4.T3.3.3.9.6.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">67.37</td>
<td id="S4.T3.3.3.9.6.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t"><span id="S4.T3.3.3.9.6.10.1" class="ltx_text ltx_font_bold">69.21</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.5.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S4.T3.6.2" class="ltx_text" style="font-size:90%;">Evaluation % of classification on PACS. Multi-class accuracy (%).</span></figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:251.5pt;height:90.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.9pt,17.6pt) scale(0.72,0.72) ;">
<table id="S4.T4.2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.2.1.1.1" class="ltx_tr">
<th id="S4.T4.2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.2.1.1.1.1.1" class="ltx_text">Unseen domain</span></th>
<th id="S4.T4.2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="4">Ablation Study</th>
</tr>
<tr id="S4.T4.2.1.2.2" class="ltx_tr">
<th id="S4.T4.2.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Tuning-Last</th>
<th id="S4.T4.2.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">2HE-Last</th>
<th id="S4.T4.2.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">2HE+Decom-Last</th>
<th id="S4.T4.2.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">Ours-Full</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.2.1.3.1" class="ltx_tr">
<td id="S4.T4.2.1.3.1.1" class="ltx_td ltx_align_center ltx_border_t">Art painting</td>
<td id="S4.T4.2.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t">59.79</td>
<td id="S4.T4.2.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t">59.20</td>
<td id="S4.T4.2.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t">62.71</td>
<td id="S4.T4.2.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t">62.86</td>
</tr>
<tr id="S4.T4.2.1.4.2" class="ltx_tr">
<td id="S4.T4.2.1.4.2.1" class="ltx_td ltx_align_center">Cartoon</td>
<td id="S4.T4.2.1.4.2.2" class="ltx_td ltx_align_center">56.22</td>
<td id="S4.T4.2.1.4.2.3" class="ltx_td ltx_align_center">55.50</td>
<td id="S4.T4.2.1.4.2.4" class="ltx_td ltx_align_center">52.69</td>
<td id="S4.T4.2.1.4.2.5" class="ltx_td ltx_align_center">66.97</td>
</tr>
<tr id="S4.T4.2.1.5.3" class="ltx_tr">
<td id="S4.T4.2.1.5.3.1" class="ltx_td ltx_align_center">Photo</td>
<td id="S4.T4.2.1.5.3.2" class="ltx_td ltx_align_center">86.79</td>
<td id="S4.T4.2.1.5.3.3" class="ltx_td ltx_align_center">87.33</td>
<td id="S4.T4.2.1.5.3.4" class="ltx_td ltx_align_center">88.84</td>
<td id="S4.T4.2.1.5.3.5" class="ltx_td ltx_align_center">89.50</td>
</tr>
<tr id="S4.T4.2.1.6.4" class="ltx_tr">
<td id="S4.T4.2.1.6.4.1" class="ltx_td ltx_align_center">Sketch</td>
<td id="S4.T4.2.1.6.4.2" class="ltx_td ltx_align_center">46.41</td>
<td id="S4.T4.2.1.6.4.3" class="ltx_td ltx_align_center">48.45</td>
<td id="S4.T4.2.1.6.4.4" class="ltx_td ltx_align_center">52.16</td>
<td id="S4.T4.2.1.6.4.5" class="ltx_td ltx_align_center">57.51</td>
</tr>
<tr id="S4.T4.2.1.7.5" class="ltx_tr">
<td id="S4.T4.2.1.7.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">Ave.%</td>
<td id="S4.T4.2.1.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">62.30</td>
<td id="S4.T4.2.1.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">62.62</td>
<td id="S4.T4.2.1.7.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">64.10</td>
<td id="S4.T4.2.1.7.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t">69.21</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.3.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.4.2" class="ltx_text" style="font-size:90%;">Ablation study. Multi-class accuracy (%).</span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Our PACS benchmark</h4>

<div id="S4.SS3.SSS3.p1" class="ltx_para">
<p id="S4.SS3.SSS3.p1.2" class="ltx_p">We compare baselines (SVM, 1HNN) and prior methods (LRE-SVM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, D-MTAE+1HNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, uDICA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>) using DECAF<sub id="S4.SS3.SSS3.p1.2.1" class="ltx_sub">7</sub> features against Deep-ALL, DSN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and Ours-Full using end-to-end learning. From the results in Table <a href="#S4.T3" title="Table 3 ‣ 4.3.2 VLCS Benchmark ‣ 4.3 Domain Generalization Experiments ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we make the observations: (i) uDICA and D-MTAE-1HNN are the best prior DG models, and DSN is also effective despite being designed for DA. While uDICA scores well overall, this is mostly due to very high performance on the photo domain. This is understandable as in that condition DICA uses unaltered DECAF<sub id="S4.SS3.SSS3.p1.2.2" class="ltx_sub">7</sub> features tuned for photo recognition. It is also the least useful direction for DG, as photos are already abundant.
(ii) As for the VLCS benchmark, Deep-ALL again performs well. (iii) However Ours-Full performs best overall by combining the robustness of a CNN architecture with an explicit DG mechanism.</p>
</div>
<div id="S4.SS3.SSS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS3.p2.1" class="ltx_p"><span id="S4.SS3.SSS3.p2.1.1" class="ltx_text ltx_font_bold">Ablation Study:</span> To investigate the contributions of each components in our framework, we compare the following variants: <em id="S4.SS3.SSS3.p2.1.2" class="ltx_emph ltx_font_italic">Tuning-Last</em>: Trains on all sources followed by direct application to the target. But fine-tunes the final FC layer only. <em id="S4.SS3.SSS3.p2.1.3" class="ltx_emph ltx_font_italic">2HE-Last</em>: Fine-tunes the final FC layer, and uses our tensor weight generation (Eq. <a href="#S3.E3" title="In 3.1 Parameterized Neural Network for DG ‣ 3 Methodology ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) based on 2-hot encoding for multidomain learning, before transferring the shared model component to the target. But without low rank factorisation. <em id="S4.SS3.SSS3.p2.1.4" class="ltx_emph ltx_font_italic">2HE+Decomp-Last</em>: Uses 2-hot encoding based weight synthesis, and low-rank decomposition of the final layer (Eq. <a href="#S3.E3" title="In 3.1 Parameterized Neural Network for DG ‣ 3 Methodology ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). <em id="S4.SS3.SSS3.p2.1.5" class="ltx_emph ltx_font_italic">Ours-Full</em>: Uses 2-hot encoding and low-rank modeling on every layer in the CNN.</p>
</div>
<div id="S4.SS3.SSS3.p3" class="ltx_para">
<p id="S4.SS3.SSS3.p3.1" class="ltx_p">From the results, we can see that each component helps: (i) 2HE-Last outperforms Tuning-Last, demonstrating the ability of our tensor weight generator to synthesize domain agnostic models for a multiclass classifier. (ii) 2HE+Decomp-Last outperforms 2HE-Last, demonstrating the value of our low-rank tensor modeling of the weight generator parameters. (iii) Ours-Full outperforms 2HE+Decomp-Last, demonstrating the value of performing these DG strategies at every layer of the network.</p>
</div>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Further Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p"><span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">Learned Layer-wise Sharing Strength</span> An interesting property of our approach is that, unlike some other deep learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> it does not require manual specification of the cross-domain sharing structure at each layer of the CNN; and unlike Undo Bias <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> it can choose how to share more flexibly through the rank choice at each layer. We can observe the estimated sharing structure at each layer by performing Tucker decomposition to factorize the tuned model under a specified reconstruction error threshold (<math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\epsilon=0.001" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mrow id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">ϵ</mi><mo id="S4.SS4.p1.1.m1.1.1.1" xref="S4.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><eq id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1.1"></eq><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">italic-ϵ</ci><cn type="float" id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\epsilon=0.001</annotation></semantics></math>). The resulting domain-rank at each layer reveals the sharing strength.
The rank per-layer for each held-out domain in PACS is shown in Fig. <a href="#S4.F3.sf2" title="In Figure 3 ‣ 4.2 Characterizing Benchmarks’ Domain Shifts ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3(b)</span></a>. Here there are three training domains, so the maximum rank is 3 and the minimum rank is 1. Intuitively, the results show heavily shared Conv1-Conv3 layers, and low-sharing in FC6-FC8 layers. The middle layers Conv4 and Conv5 have different sharing strength according to which domains provide the source set. For example, in Conv 5, when Sketch is unseen, the other domains are relatively similar so can have greater sharing, compared to when Sketch is included as a seen domain. This is intuitive as Sketch is the most different from the other three domains. This flexible ability to determine sharing strength is a key property of our model.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">Visualization</span> To visualize the preferences of our multi-domain network, we apply the DGN-AM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> method to synthesize the preferred input images for our model when parameterized (via the domain descriptor <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">z</annotation></semantics></math>) to one specific domain versus the abstract domain-agnostic factor. This visualization is imperfect because <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> is trained using a photo-domain, and most of our domains are non-photographic art.
Nevertheless, from Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3.2 VLCS Benchmark ‣ 4.3 Domain Generalization Experiments ‣ 4 Experiments ‣ Deeper, Broader and Artier Domain Generalization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> the synthesis for Photo domain seem to be the most concrete, while the Sketch/Cartoon/Painting domains are more abstract.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We presented a new dataset and deep learning-based method for domain generalization. Our PACS (Photo-Art-Cartoon-Sketch) dataset is aligned with a practical application of domain generalization, and we showed it has more challenging domain shift than prior datasets, making it suitable to drive the field in future. Our new domain generalization method integrates the idea of learning a domain-agnostic classifier with a robust deep learning approach for end-to-end learning of domain generalization. The result performs comparably or better than prior approaches.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
L. Bertinetto, J. F. Henriques, J. Valmadre, P. H. S. Torr, and A. Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Learning feed-forward one-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
K. Bousmalis, G. Trigeorgis, N. Silberman, D. Krishnan, and D. Erhan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Domain separation networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
E. J. Crowley, O. M. Parkhi, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Face painting: querying art with photos.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">BMVC</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
J. Donahue, Y. Jia, O. Vinyals, J. Hoffman, N. Zhang, E. Tzeng, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Decaf: A deep convolutional activation feature for generic visual
recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
A. Z. E. J. Crowley.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">The art of detection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV Workshop on Computer Vision for Art Analysis</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
M. Eitz, J. Hays, and M. Alexa.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">How do humans sketch objects?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">TOG</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
C. Fang, Y. Xu, and D. N. Rockmore.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Unbiased metric learning: On the utilization of multiple datasets and
web images for softening bias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
C. Finn, P. Abbeel, and S. Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Y. Ganin and V. Lempitsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Unsupervised domain adaptation by backpropagation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
M. Ghifary, W. Bastiaan Kleijn, M. Zhang, and D. Balduzzi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Domain generalization for object recognition with multi-task
autoencoders.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
B. Gong, Y. Shi, F. Sha, and K. Grauman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Geodesic flow kernel for unsupervised domain adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
A. Khosla, T. Zhou, T. Malisiewicz, A. Efros, and A. Torralba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Undoing the damage of dataset bias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Y.-D. Kim, E. Park, S. Yoo, T. Choi, L. Yang, and D. Shin.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Compression of deep convolutional neural networks for fast and low
power mobile applications.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
A. Krizhevsky, I. Sutskever, and G. E. Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Imagenet classification with deep convolutional neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2012.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
L. D. Lathauwer, B. D. Moor, and J. Vandewalle.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">A multilinear singular value decomposition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">SIMAX</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2000.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
V. Lebedev, Y. Ganin, M. Rakhuba, I. Oseledets, and V. Lempitsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Speeding-up convolutional neural networks using fine-tuned
cp-decomposition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
M. Long, Y. Cao, J. Wang, and M. I. Jordan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Learning transferable features with deep adaptation networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
L. v. d. Maaten and G. Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Visualizing data using t-sne.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">JMLR</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2008.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
K. Muandet, D. Balduzzi, and B. Scholkopf.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Domain generalization via invariant feature representation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, 2013.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
T. Munkhdalai and H. Yu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Meta networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
A. M. Nguyen, A. Dosovitskiy, J. Yosinski, T. Brox, and J. Clune.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Synthesizing the preferred inputs for neurons in neural networks via
deep generator networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
S. Ravi and H. Larochelle.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Optimization as a model for few-shot learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
K. Saenko, B. Kulis, M. Fritz, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Adapting visual category models to new domains.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2010.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
P. Sangkloy, N. Burnell, C. Ham, and J. Hays.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">The sketchy database: learning to retrieve badly drawn bunnies.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">TOG</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
O. Sigaud, C. Masson, D. Filliat, and F. Stulp.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Gated networks: an inventory.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
J. Song, Y. Qian, Y.-Z. Song, T. Xiang, and T. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Deep spatial-semantic attention for fine-grained sketch-based image
retrieval.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
A. Torralba and A. A. Efros.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Unbiased look at dataset bias.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, 2011.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
L. R. Tucker.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Some mathematical notes on three-mode factor analysis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Psychometrika</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 1966.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Q. Wu, H. Cai, and P. Hall.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Learning graphs to model visual objects across different depictive
styles.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">. 2014.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Z. Xu, W. Li, L. Niu, and D. Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Exploiting low-rank structure from latent domains for domain
generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Y. Yang and T. M. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Deep multi-task representation learning: A tensor factorisation
approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
J. Yosinski, J. Clune, Y. Bengio, and H. Lipson.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">How transferable are features in deep neural networks?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Q. Yu, F. Liu, Y.-Z. Song, T. Xiang, T. M. Hospedales, and C. C. Loy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Sketch me that shoe.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib33.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib33.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Q. Yu, Y. Yang, F. Liu, Y.-Z. Song, T. Xiang, and T. M. Hospedales.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Sketch-a-net: A deep neural network that beats humans.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1710.03076" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/land_of_honey_and_milk" rel="nofollow" aria-hidden="true" tabindex="-1"></a>
    <a href="/log/1710.03077" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1710.03077">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1710.03077" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1710.03078" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 03:16:37 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
