<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1710.02543] Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning</title><meta property="og:description" content="We present an approach for mobile robots to learn to navigate in dynamic environments with pedestrians via raw depth inputs,
in a socially compliant manner.
To achieve this, we adopt a generative adversarial imitation …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1710.02543">
<link rel="canonical" target="_blank" href="https://ar5iv.labs.arxiv.org/html/1710.02543">

<!--Generated on Thu Mar  7 03:04:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Tai<sup id="id8.8.id1" class="ltx_sup"><span id="id8.8.id1.1" class="ltx_text ltx_font_italic">1</span></sup>    Jingwei Zhang<sup id="id9.9.id2" class="ltx_sup"><span id="id9.9.id2.1" class="ltx_text ltx_font_italic">2</span></sup>    Ming Liu<sup id="id10.10.id3" class="ltx_sup"><span id="id10.10.id3.1" class="ltx_text ltx_font_italic">1</span></sup>   Wolfram Burgard<sup id="id11.11.id4" class="ltx_sup"><span id="id11.11.id4.1" class="ltx_text ltx_font_italic">2</span></sup>
</span><span class="ltx_author_notes"><sup id="id12.12.id1" class="ltx_sup"><span id="id12.12.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>This paper is supported by Shenzhen Science, Technology and Innovation Commission (SZSTI) JCYJ20160428154842603 and JCYJ20160401100022706; also supported by the Research Grant Council of Hong Kong SAR Government, China, under Project No. 11210017 and No. 16212815 and No. 21202816 awarded to Prof. Ming Liu.<sup id="id13.13.id1" class="ltx_sup"><span id="id13.13.id1.1" class="ltx_text ltx_font_italic">1</span></sup>Department of Electronic and Computer Engineering, The Hong Kong University of Science and Technology; {ltai, eelium}@ust.hk <sup id="id14.14.id1" class="ltx_sup"><span id="id14.14.id1.1" class="ltx_text ltx_font_italic">2</span></sup>Department of Computer Science, Albert Ludwig University of Freiburg; {zhang, burgard}@informatik.uni-freiburg.de </span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id15.id1" class="ltx_p"><span id="id15.id1.1" class="ltx_text">We present an approach for mobile robots to learn to navigate in dynamic environments with pedestrians via raw depth inputs,
in a socially compliant manner.
To achieve this, we adopt a generative adversarial imitation learning (GAIL) strategy, which improves upon a pre-trained behavior cloning policy.
Our approach overcomes the disadvantages of previous methods,
as they heavily depend on the full knowledge of the location and velocity information of nearby pedestrians,
which not only requires specific sensors,
but also the extraction of such state information from raw sensory input could consume much computation time. In this paper, our proposed GAIL-based model performs directly on raw depth inputs and plans in real-time.
Experiments show that our GAIL-based approach greatly improves the safety and efficiency of the behavior of mobile robots from pure behavior cloning. The real-world deployment also shows that our method is capable of guiding autonomous vehicles to navigate in a socially compliant manner directly through raw depth inputs.
In addition, we release a simulation plugin for modeling pedestrian behaviors based on the social force model.
</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<section id="S1.SS0.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S1.SS0.SSS1.5.1.1" class="ltx_text">I-</span>1 </span>Socially compliant navigation</h4>

<div id="S1.SS0.SSS1.p1" class="ltx_para">
<p id="S1.SS0.SSS1.p1.1" class="ltx_p">The ability to cope with dynamic pedestrian environments are crucial for autonomous ground vehicles.
In static environments, mobile robots are required to reliably avoid collision with static objects and plan feasible paths to their target locations;
while in dynamic environments with pedestrians, they are additionally required to behave in socially compliant manners, where they need to understand the dynamic human behaviors and react accordingly under specific socially acceptable rules.
</p>
</div>
<div id="S1.SS0.SSS1.p2" class="ltx_para">
<p id="S1.SS0.SSS1.p2.1" class="ltx_p">Traditional solutions
can be classified into two categories: <span id="S1.SS0.SSS1.p2.1.1" class="ltx_text ltx_font_italic">model-based</span>
and <span id="S1.SS0.SSS1.p2.1.2" class="ltx_text ltx_font_italic">learning-based</span>.
Model-based methods aim to extend the multi-robot navigation solutions with socially compliant constraints <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
However, force parameters need to be carefully tuned for each specific scenario.
Learning-based methods, on the other hand,
aim to directly recover the expert policy through direct supervised learning (e.g., behavior cloning), or through inverse reinforcement learning to recover the inner cost function.</p>
</div>
<div id="S1.SS0.SSS1.p3" class="ltx_para">
<p id="S1.SS0.SSS1.p3.1" class="ltx_p">Yet, all previous approaches require the knowledge of the precise localization and velocity information of nearby pedestrians.
This limitation restricts these methods to be only applicable for robots equipped with high precision sensors,
like 3D Lidars <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
Moreover, the estimation of the state information of pedestrians
is generally time-consuming.
Developing effective navigation strategies directly from raw sensor inputs is still of great importance.
</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1710.02543/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">A mobile robot navigating in a socially compliant manner in an indoor environment. Our approach tackles this scenario through raw depth images.
</span></figcaption>
</figure>
</section>
<section id="S1.SS0.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S1.SS0.SSS2.5.1.1" class="ltx_text">I-</span>2 </span>Perception from visual input</h4>

<div id="S1.SS0.SSS2.p1" class="ltx_para">
<p id="S1.SS0.SSS2.p1.1" class="ltx_p">Compared with 3D Lidars, vision sensors come at affordable prices,
making them more suitable to equip mobile agents that are beginning to populate our social life.
Thus, navigation solutions that can directly operate on raw visual inputs are more feasible than those depending on expensive Lidars.</p>
</div>
<div id="S1.SS0.SSS2.p2" class="ltx_para">
<p id="S1.SS0.SSS2.p2.1" class="ltx_p">In coping with visual information, deep learning approaches have become imperative due to their ability to extract hierarchically more abstract feature representations.
Also, with the improvement of the computation power of mobile platforms,
such approaches have been utilized in various robotics tasks such as obstacle avoidance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
In this paper, we deploy neural networks for extracting useful features from raw depth visual inputs, captured by onboard depth cameras of the mobile robot.</p>
</div>
<div id="S1.SS0.SSS2.p3" class="ltx_para">
<p id="S1.SS0.SSS2.p3.1" class="ltx_p">We use depth inputs over RGB images because the visual fidelity of the simulated color images are much worse than that of the depth images.
This bigger deviation of color images from synthetic environments to real-world scenarios makes it more challenging to transfer the model trained on simulated images directly to the real world.
The simulated depth images, on the other hand, are more consistent with the real domain and can greatly ease the transfer phase.</p>
</div>
</section>
<section id="S1.SS0.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S1.SS0.SSS3.5.1.1" class="ltx_text">I-</span>3 </span>Learning-based navigation</h4>

<div id="S1.SS0.SSS3.p1" class="ltx_para">
<p id="S1.SS0.SSS3.p1.1" class="ltx_p">Deep reinforcement learning have recently gained much attention, and have been successfully extended to learn autonomous navigation from raw sensory inputs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.SS0.SSS3.p2" class="ltx_para">
<p id="S1.SS0.SSS3.p2.1" class="ltx_p">In terms of socially compliant navigation,
behavior cloning methods are easy to deploy since they treat the policy learning as a pure supervised learning task.
Yet, the learned model of behavior cloning completely ignores the temporal correlation between samples in subsequent frames, thus it cannot generalize well to scenarios that deviate too much from the training data.
Agents are also able to learn from expert demonstrations via an intermediate step of learning the latent cost or the reward function <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> through inverse reinforcement learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
Chen <span id="S1.SS0.SSS3.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> defined a complex reward to train the socially aware planning policies (e.g. passing by the right/left side) through reinforcement learning.
However, all of these methods depend on accurate pedestrian information and expensive sensors as mentioned before.</p>
</div>
<div id="S1.SS0.SSS3.p3" class="ltx_para">
<p id="S1.SS0.SSS3.p3.1" class="ltx_p">Generative adversarial imitation learning (GAIL) is an effective alternative for learning from demonstrations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
InfoGAIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> successfully solved a simulated autonomous driving task with raw visual input.
However, only simulated experiments are presented in those two papers.</p>
</div>
<div id="S1.SS0.SSS3.p4" class="ltx_para">
<p id="S1.SS0.SSS3.p4.1" class="ltx_p">In this paper, we effectively deploy behavior cloning for learning an initial policy,
Then, we apply GAIL on the basis of this initial policy,
to benefit the policy model by taking the temporal correlations in the dataset into account.
</p>
</div>
<div id="S1.SS0.SSS3.p5" class="ltx_para">
<p id="S1.SS0.SSS3.p5.1" class="ltx_p">Particularly, this paper presents the following contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce an effective GAIL-based approach that is able to learn and improve socially compliant navigation policies through raw depth inputs.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We release a plugin for simulating pedestrians behaving in socially compliant manners,
as well as a dataset, where 10,000 socially compliant navigation state-action pairs are recorded, based on the social force model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, in various social scenarios.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">background</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.7" class="ltx_p">We consider a <span id="S2.p1.7.1" class="ltx_text ltx_font_italic">Markov decision process</span> (MDP), where an agent interacts with the environment through a sequence of observations, actions and reward signals. The agent executes an action <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="a_{t}\in\mathcal{A}" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><msub id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml"><mi id="S2.p1.1.m1.1.1.2.2" xref="S2.p1.1.m1.1.1.2.2.cmml">a</mi><mi id="S2.p1.1.m1.1.1.2.3" xref="S2.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.1.m1.1.1.1" xref="S2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><in id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1.1"></in><apply id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.2.1.cmml" xref="S2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.p1.1.m1.1.1.2.2.cmml" xref="S2.p1.1.m1.1.1.2.2">𝑎</ci><ci id="S2.p1.1.m1.1.1.2.3.cmml" xref="S2.p1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">a_{t}\in\mathcal{A}</annotation></semantics></math> at time step <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">t</annotation></semantics></math> from its current state <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="s_{t}\in\mathcal{S}" display="inline"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><msub id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml"><mi id="S2.p1.3.m3.1.1.2.2" xref="S2.p1.3.m3.1.1.2.2.cmml">s</mi><mi id="S2.p1.3.m3.1.1.2.3" xref="S2.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><in id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"></in><apply id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.2.1.cmml" xref="S2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.2.cmml" xref="S2.p1.3.m3.1.1.2.2">𝑠</ci><ci id="S2.p1.3.m3.1.1.2.3.cmml" xref="S2.p1.3.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">s_{t}\in\mathcal{S}</annotation></semantics></math>, according to its policy <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\pi:\mathcal{S}\rightarrow\mathcal{A}" display="inline"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml"><mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">π</mi><mo lspace="0.278em" rspace="0.278em" id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">:</mo><mrow id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1.3.2" xref="S2.p1.4.m4.1.1.3.2.cmml">𝒮</mi><mo stretchy="false" id="S2.p1.4.m4.1.1.3.1" xref="S2.p1.4.m4.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1.3.3" xref="S2.p1.4.m4.1.1.3.3.cmml">𝒜</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1"><ci id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1">:</ci><ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝜋</ci><apply id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3"><ci id="S2.p1.4.m4.1.1.3.1.cmml" xref="S2.p1.4.m4.1.1.3.1">→</ci><ci id="S2.p1.4.m4.1.1.3.2.cmml" xref="S2.p1.4.m4.1.1.3.2">𝒮</ci><ci id="S2.p1.4.m4.1.1.3.3.cmml" xref="S2.p1.4.m4.1.1.3.3">𝒜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\pi:\mathcal{S}\rightarrow\mathcal{A}</annotation></semantics></math>. It then receives a reward signal <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="r_{t}:\mathcal{S}\rightarrow\mathbb{R}" display="inline"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><msub id="S2.p1.5.m5.1.1.2" xref="S2.p1.5.m5.1.1.2.cmml"><mi id="S2.p1.5.m5.1.1.2.2" xref="S2.p1.5.m5.1.1.2.2.cmml">r</mi><mi id="S2.p1.5.m5.1.1.2.3" xref="S2.p1.5.m5.1.1.2.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S2.p1.5.m5.1.1.1" xref="S2.p1.5.m5.1.1.1.cmml">:</mo><mrow id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1.3.2" xref="S2.p1.5.m5.1.1.3.2.cmml">𝒮</mi><mo stretchy="false" id="S2.p1.5.m5.1.1.3.1" xref="S2.p1.5.m5.1.1.3.1.cmml">→</mo><mi id="S2.p1.5.m5.1.1.3.3" xref="S2.p1.5.m5.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><ci id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1">:</ci><apply id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.2.1.cmml" xref="S2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.p1.5.m5.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.2.2">𝑟</ci><ci id="S2.p1.5.m5.1.1.2.3.cmml" xref="S2.p1.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3"><ci id="S2.p1.5.m5.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.3.1">→</ci><ci id="S2.p1.5.m5.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.3.2">𝒮</ci><ci id="S2.p1.5.m5.1.1.3.3.cmml" xref="S2.p1.5.m5.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">r_{t}:\mathcal{S}\rightarrow\mathbb{R}</annotation></semantics></math> and transits to the next state <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="s_{t+1}" display="inline"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">s</mi><mrow id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.3.2" xref="S2.p1.6.m6.1.1.3.2.cmml">t</mi><mo id="S2.p1.6.m6.1.1.3.1" xref="S2.p1.6.m6.1.1.3.1.cmml">+</mo><mn id="S2.p1.6.m6.1.1.3.3" xref="S2.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑠</ci><apply id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3"><plus id="S2.p1.6.m6.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.3.1"></plus><ci id="S2.p1.6.m6.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S2.p1.6.m6.1.1.3.3.cmml" xref="S2.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">s_{t+1}</annotation></semantics></math> according to the dynamics of the environment. We use <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="\pi_{E}" display="inline"><semantics id="S2.p1.7.m7.1a"><msub id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">π</mi><mi id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">𝜋</ci><ci id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\pi_{E}</annotation></semantics></math> to denote the expert policy.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Imitation learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Imitation learning aims to learn policies directly from experts, whose demonstrations are only provided in the form of samples of trajectories. Main approaches for imitation learning can be categorized into behavior cloning (BC) and inverse reinforcement learning (IRL) Behavior cloning tackles this problem in a supervised manner, by directly learning the mapping from the states in the recorded trajectories to their corresponding labels: the expert policy. It is conceptually simple and is able to work well with large amounts of training data, but suffers from the compounding error caused by covariate shift, due to its ignorance of the temporal correlation in the recorded trajectories. Thus pure behavior cloning tends to over-fit and is difficult to generalize to unseen scenarios that deviate much from the recorded dataset. Inverse reinforcement learning aims to extract the latent reward or cost function under the optimal expert demonstrations. It imitates by taking the underlying MDP into account, learning from entire trajectories instead of single frames. However, the requirement of running reinforcement learning in an inner loop makes IRL extremely expensive to run <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Generitive adversarial imitation learning</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.7" class="ltx_p">Inspired by Generative adversarial networks (GAN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, Ho and Ermon proposed generative adversarial imitation learning (GAIL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, which surpasses the intermediate step of learning a reward function, but is able to directly learn a policy from expert demonstrations. In the GAIL model, the generator <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">π</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝜋</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\pi_{\theta}</annotation></semantics></math> is forced to generate state-action <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="(\mathcal{S}\times\mathcal{A})" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.2.m2.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.2.cmml">𝒮</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p1.2.m2.1.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.3.cmml">𝒜</mi></mrow><mo stretchy="false" id="S2.SS2.p1.2.m2.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1"><times id="S2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1"></times><ci id="S2.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.2">𝒮</ci><ci id="S2.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.3">𝒜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">(\mathcal{S}\times\mathcal{A})</annotation></semantics></math> pairs matching that from the expert demonstrations, while the discriminator <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="D_{\omega}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msub id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">D</mi><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝐷</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">D_{\omega}</annotation></semantics></math> learns to tell the generated policy <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">π</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝜋</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">\pi_{\theta}</annotation></semantics></math> (<math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><mi id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\theta</annotation></semantics></math> denotes the parameters of the generator of the GAIL model) apart from the expert policy <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="\pi_{E}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">π</mi><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝜋</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\pi_{E}</annotation></semantics></math>. The objective of GAIL is to optimize the function below (<math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="H(\pi)" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mrow id="S2.SS2.p1.7.m7.1.2" xref="S2.SS2.p1.7.m7.1.2.cmml"><mi id="S2.SS2.p1.7.m7.1.2.2" xref="S2.SS2.p1.7.m7.1.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.7.m7.1.2.1" xref="S2.SS2.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.7.m7.1.2.3.2" xref="S2.SS2.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.7.m7.1.2.3.2.1" xref="S2.SS2.p1.7.m7.1.2.cmml">(</mo><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">π</mi><mo stretchy="false" id="S2.SS2.p1.7.m7.1.2.3.2.2" xref="S2.SS2.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.2.cmml" xref="S2.SS2.p1.7.m7.1.2"><times id="S2.SS2.p1.7.m7.1.2.1.cmml" xref="S2.SS2.p1.7.m7.1.2.1"></times><ci id="S2.SS2.p1.7.m7.1.2.2.cmml" xref="S2.SS2.p1.7.m7.1.2.2">𝐻</ci><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝜋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">H(\pi)</annotation></semantics></math> represents the causal entropy of the policy):</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.9" class="ltx_Math" alttext="\displaystyle\mathbb{E}_{\pi_{\theta}}[\log(D(s,a))]+\mathbb{E}_{\pi_{E}}[\log(1-D(s,a))]-\lambda H(\pi_{\theta})" display="inline"><semantics id="S2.E1.m1.9a"><mrow id="S2.E1.m1.9.9" xref="S2.E1.m1.9.9.cmml"><mrow id="S2.E1.m1.8.8.2" xref="S2.E1.m1.8.8.2.cmml"><mrow id="S2.E1.m1.7.7.1.1" xref="S2.E1.m1.7.7.1.1.cmml"><msub id="S2.E1.m1.7.7.1.1.3" xref="S2.E1.m1.7.7.1.1.3.cmml"><mi id="S2.E1.m1.7.7.1.1.3.2" xref="S2.E1.m1.7.7.1.1.3.2.cmml">𝔼</mi><msub id="S2.E1.m1.7.7.1.1.3.3" xref="S2.E1.m1.7.7.1.1.3.3.cmml"><mi id="S2.E1.m1.7.7.1.1.3.3.2" xref="S2.E1.m1.7.7.1.1.3.3.2.cmml">π</mi><mi id="S2.E1.m1.7.7.1.1.3.3.3" xref="S2.E1.m1.7.7.1.1.3.3.3.cmml">θ</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.1.1.2" xref="S2.E1.m1.7.7.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.7.7.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">log</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1a" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">s</mi><mo id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">a</mi><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.7.7.1.1.1.1.3" xref="S2.E1.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.E1.m1.8.8.2.3" xref="S2.E1.m1.8.8.2.3.cmml">+</mo><mrow id="S2.E1.m1.8.8.2.2" xref="S2.E1.m1.8.8.2.2.cmml"><msub id="S2.E1.m1.8.8.2.2.3" xref="S2.E1.m1.8.8.2.2.3.cmml"><mi id="S2.E1.m1.8.8.2.2.3.2" xref="S2.E1.m1.8.8.2.2.3.2.cmml">𝔼</mi><msub id="S2.E1.m1.8.8.2.2.3.3" xref="S2.E1.m1.8.8.2.2.3.3.cmml"><mi id="S2.E1.m1.8.8.2.2.3.3.2" xref="S2.E1.m1.8.8.2.2.3.3.2.cmml">π</mi><mi id="S2.E1.m1.8.8.2.2.3.3.3" xref="S2.E1.m1.8.8.2.2.3.3.3.cmml">E</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.2.2.2" xref="S2.E1.m1.8.8.2.2.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.2.2.1.1" xref="S2.E1.m1.8.8.2.2.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.2" xref="S2.E1.m1.8.8.2.2.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.8.8.2.2.1.1.1.1" xref="S2.E1.m1.8.8.2.2.1.1.1.2.cmml"><mi id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">log</mi><mo id="S2.E1.m1.8.8.2.2.1.1.1.1a" xref="S2.E1.m1.8.8.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.8.8.2.2.1.1.1.1.1" xref="S2.E1.m1.8.8.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.2" xref="S2.E1.m1.8.8.2.2.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.cmml"><mn id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.2" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.1" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.2.1" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">s</mi><mo id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.2.2" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">a</mi><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.2.3" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.3" xref="S2.E1.m1.8.8.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.8.8.2.2.1.1.3" xref="S2.E1.m1.8.8.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E1.m1.9.9.4" xref="S2.E1.m1.9.9.4.cmml">−</mo><mrow id="S2.E1.m1.9.9.3" xref="S2.E1.m1.9.9.3.cmml"><mi id="S2.E1.m1.9.9.3.3" xref="S2.E1.m1.9.9.3.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.3.2" xref="S2.E1.m1.9.9.3.2.cmml">​</mo><mi id="S2.E1.m1.9.9.3.4" xref="S2.E1.m1.9.9.3.4.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.9.9.3.2a" xref="S2.E1.m1.9.9.3.2.cmml">​</mo><mrow id="S2.E1.m1.9.9.3.1.1" xref="S2.E1.m1.9.9.3.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.9.9.3.1.1.2" xref="S2.E1.m1.9.9.3.1.1.1.cmml">(</mo><msub id="S2.E1.m1.9.9.3.1.1.1" xref="S2.E1.m1.9.9.3.1.1.1.cmml"><mi id="S2.E1.m1.9.9.3.1.1.1.2" xref="S2.E1.m1.9.9.3.1.1.1.2.cmml">π</mi><mi id="S2.E1.m1.9.9.3.1.1.1.3" xref="S2.E1.m1.9.9.3.1.1.1.3.cmml">θ</mi></msub><mo stretchy="false" id="S2.E1.m1.9.9.3.1.1.3" xref="S2.E1.m1.9.9.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.9b"><apply id="S2.E1.m1.9.9.cmml" xref="S2.E1.m1.9.9"><minus id="S2.E1.m1.9.9.4.cmml" xref="S2.E1.m1.9.9.4"></minus><apply id="S2.E1.m1.8.8.2.cmml" xref="S2.E1.m1.8.8.2"><plus id="S2.E1.m1.8.8.2.3.cmml" xref="S2.E1.m1.8.8.2.3"></plus><apply id="S2.E1.m1.7.7.1.1.cmml" xref="S2.E1.m1.7.7.1.1"><times id="S2.E1.m1.7.7.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.2"></times><apply id="S2.E1.m1.7.7.1.1.3.cmml" xref="S2.E1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.3.1.cmml" xref="S2.E1.m1.7.7.1.1.3">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.3.2.cmml" xref="S2.E1.m1.7.7.1.1.3.2">𝔼</ci><apply id="S2.E1.m1.7.7.1.1.3.3.cmml" xref="S2.E1.m1.7.7.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.1.1.3.3.1.cmml" xref="S2.E1.m1.7.7.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.7.7.1.1.3.3.2.cmml" xref="S2.E1.m1.7.7.1.1.3.3.2">𝜋</ci><ci id="S2.E1.m1.7.7.1.1.3.3.3.cmml" xref="S2.E1.m1.7.7.1.1.3.3.3">𝜃</ci></apply></apply><apply id="S2.E1.m1.7.7.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.7.7.1.1.1.2.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1"><log id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"></log><apply id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.2">𝐷</ci><interval closure="open" id="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑠</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑎</ci></interval></apply></apply></apply></apply><apply id="S2.E1.m1.8.8.2.2.cmml" xref="S2.E1.m1.8.8.2.2"><times id="S2.E1.m1.8.8.2.2.2.cmml" xref="S2.E1.m1.8.8.2.2.2"></times><apply id="S2.E1.m1.8.8.2.2.3.cmml" xref="S2.E1.m1.8.8.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.3.1.cmml" xref="S2.E1.m1.8.8.2.2.3">subscript</csymbol><ci id="S2.E1.m1.8.8.2.2.3.2.cmml" xref="S2.E1.m1.8.8.2.2.3.2">𝔼</ci><apply id="S2.E1.m1.8.8.2.2.3.3.cmml" xref="S2.E1.m1.8.8.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.2.2.3.3.1.cmml" xref="S2.E1.m1.8.8.2.2.3.3">subscript</csymbol><ci id="S2.E1.m1.8.8.2.2.3.3.2.cmml" xref="S2.E1.m1.8.8.2.2.3.3.2">𝜋</ci><ci id="S2.E1.m1.8.8.2.2.3.3.3.cmml" xref="S2.E1.m1.8.8.2.2.3.3.3">𝐸</ci></apply></apply><apply id="S2.E1.m1.8.8.2.2.1.2.cmml" xref="S2.E1.m1.8.8.2.2.1.1"><csymbol cd="latexml" id="S2.E1.m1.8.8.2.2.1.2.1.cmml" xref="S2.E1.m1.8.8.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.8.8.2.2.1.1.1.2.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1"><log id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"></log><apply id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1"><minus id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.2">1</cn><apply id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3"><times id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.2">𝐷</ci><interval closure="open" id="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.8.8.2.2.1.1.1.1.1.1.3.3.2"><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝑠</ci><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝑎</ci></interval></apply></apply></apply></apply></apply></apply><apply id="S2.E1.m1.9.9.3.cmml" xref="S2.E1.m1.9.9.3"><times id="S2.E1.m1.9.9.3.2.cmml" xref="S2.E1.m1.9.9.3.2"></times><ci id="S2.E1.m1.9.9.3.3.cmml" xref="S2.E1.m1.9.9.3.3">𝜆</ci><ci id="S2.E1.m1.9.9.3.4.cmml" xref="S2.E1.m1.9.9.3.4">𝐻</ci><apply id="S2.E1.m1.9.9.3.1.1.1.cmml" xref="S2.E1.m1.9.9.3.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.3.1.1.1.1.cmml" xref="S2.E1.m1.9.9.3.1.1">subscript</csymbol><ci id="S2.E1.m1.9.9.3.1.1.1.2.cmml" xref="S2.E1.m1.9.9.3.1.1.1.2">𝜋</ci><ci id="S2.E1.m1.9.9.3.1.1.1.3.cmml" xref="S2.E1.m1.9.9.3.1.1.1.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.9c">\displaystyle\mathbb{E}_{\pi_{\theta}}[\log(D(s,a))]+\mathbb{E}_{\pi_{E}}[\log(1-D(s,a))]-\lambda H(\pi_{\theta})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.4" class="ltx_p">Following this objective, the learning procedure of GAIL interleaves between updating the parameters <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\omega</annotation></semantics></math> of the discriminator <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="D_{\omega}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><msub id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml">D</mi><mi id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2">𝐷</ci><ci id="S2.SS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">D_{\omega}</annotation></semantics></math> to maximize Eq. <a href="#S2.E1" title="In II-B Generitive adversarial imitation learning ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and performing trust region policy optimization (TRPO) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> to minimize Eq. <a href="#S2.E1" title="In II-B Generitive adversarial imitation learning ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> with respect to <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\theta</annotation></semantics></math>, which parameterizes the policy generator <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><msub id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml"><mi id="S2.SS2.p3.4.m4.1.1.2" xref="S2.SS2.p3.4.m4.1.1.2.cmml">π</mi><mi id="S2.SS2.p3.4.m4.1.1.3" xref="S2.SS2.p3.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><apply id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.p3.4.m4.1.1.2">𝜋</ci><ci id="S2.SS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.p3.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\pi_{\theta}</annotation></semantics></math>. Here, the discrimination scores of the generated samples are regarded as
costs (can be viewed as the negative counterpart of rewards)
of the state-action pairs in the learning process of TRPO. As a state-of-the-art on policy reinforcement learning method, TRPO constraints the deviation of the updated policy from the original policy according to their KL divergence.
</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.1" class="ltx_p">We extend the GAIL framework with Wasserstein GAN (WGAN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
In WGAN, the classification formulation of the discriminator network is substituted with a regression problem.
By eliminating the usage of <span id="S2.SS2.p4.1.1" class="ltx_text ltx_font_italic">softmax</span> in traditional GAN,
WGAN directly maximizes the score of the real data and minimizes the score of the generated data.
It is proved to improve the training stability of InfoGAIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
The objective function of WGAN is:</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{E}_{\pi_{\theta}}[D(s,a)]-\mathbb{E}_{\pi_{E}}[D(s,a))]" display="inline"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4b"><msub id="S2.E2.m1.4.5"><mi id="S2.E2.m1.4.5.2">𝔼</mi><msub id="S2.E2.m1.4.5.3"><mi id="S2.E2.m1.4.5.3.2">π</mi><mi id="S2.E2.m1.4.5.3.3">θ</mi></msub></msub><mrow id="S2.E2.m1.4.6"><mo stretchy="false" id="S2.E2.m1.4.6.1">[</mo><mi id="S2.E2.m1.4.6.2">D</mi><mrow id="S2.E2.m1.4.6.3"><mo stretchy="false" id="S2.E2.m1.4.6.3.1">(</mo><mi id="S2.E2.m1.1.1">s</mi><mo id="S2.E2.m1.4.6.3.2">,</mo><mi id="S2.E2.m1.2.2">a</mi><mo stretchy="false" id="S2.E2.m1.4.6.3.3">)</mo></mrow><mo stretchy="false" id="S2.E2.m1.4.6.4">]</mo></mrow><mo id="S2.E2.m1.4.7">−</mo><msub id="S2.E2.m1.4.8"><mi id="S2.E2.m1.4.8.2">𝔼</mi><msub id="S2.E2.m1.4.8.3"><mi id="S2.E2.m1.4.8.3.2">π</mi><mi id="S2.E2.m1.4.8.3.3">E</mi></msub></msub><mrow id="S2.E2.m1.4.9"><mo stretchy="false" id="S2.E2.m1.4.9.1">[</mo><mi id="S2.E2.m1.4.9.2">D</mi><mrow id="S2.E2.m1.4.9.3"><mo stretchy="false" id="S2.E2.m1.4.9.3.1">(</mo><mi id="S2.E2.m1.3.3">s</mi><mo id="S2.E2.m1.4.9.3.2">,</mo><mi id="S2.E2.m1.4.4">a</mi><mo stretchy="false" id="S2.E2.m1.4.9.3.3">)</mo></mrow><mo stretchy="false" id="S2.E2.m1.4.9.4">)</mo></mrow><mo stretchy="false" id="S2.E2.m1.4.10">]</mo></mrow><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\displaystyle\mathbb{E}_{\pi_{\theta}}[D(s,a)]-\mathbb{E}_{\pi_{E}}[D(s,a))]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.5.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.6.2" class="ltx_text ltx_font_italic">Social force model</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Helbing and Molnar <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> proposed the social force model for pedestrian dynamics,
which is broadly applied to socially compliant navigation scenarios. This model (Eq. <a href="#S2.E3" title="In II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) computes the acceleration of pedestrians according to the sum of various forces applied to them.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\frac{d{\vec{v}}_{t}}{dt}={\vec{F}}_{\text{desired}}+{\vec{F}}_{\text{social}}+{\vec{F}}_{\text{obs}}+{\vec{F}}_{\text{fluct}}" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml"><mfrac id="S2.E3.m1.1.1.2a" xref="S2.E3.m1.1.1.2.cmml"><mrow id="S2.E3.m1.1.1.2.2" xref="S2.E3.m1.1.1.2.2.cmml"><mi id="S2.E3.m1.1.1.2.2.2" xref="S2.E3.m1.1.1.2.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.2.2.1" xref="S2.E3.m1.1.1.2.2.1.cmml">​</mo><msub id="S2.E3.m1.1.1.2.2.3" xref="S2.E3.m1.1.1.2.2.3.cmml"><mover accent="true" id="S2.E3.m1.1.1.2.2.3.2" xref="S2.E3.m1.1.1.2.2.3.2.cmml"><mi id="S2.E3.m1.1.1.2.2.3.2.2" xref="S2.E3.m1.1.1.2.2.3.2.2.cmml">v</mi><mo stretchy="false" id="S2.E3.m1.1.1.2.2.3.2.1" xref="S2.E3.m1.1.1.2.2.3.2.1.cmml">→</mo></mover><mi id="S2.E3.m1.1.1.2.2.3.3" xref="S2.E3.m1.1.1.2.2.3.3.cmml">t</mi></msub></mrow><mrow id="S2.E3.m1.1.1.2.3" xref="S2.E3.m1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.2.3.2" xref="S2.E3.m1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.2.3.1" xref="S2.E3.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.E3.m1.1.1.2.3.3" xref="S2.E3.m1.1.1.2.3.3.cmml">t</mi></mrow></mfrac></mstyle><mo id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><msub id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml"><mover accent="true" id="S2.E3.m1.1.1.3.2.2" xref="S2.E3.m1.1.1.3.2.2.cmml"><mi id="S2.E3.m1.1.1.3.2.2.2" xref="S2.E3.m1.1.1.3.2.2.2.cmml">F</mi><mo stretchy="false" id="S2.E3.m1.1.1.3.2.2.1" xref="S2.E3.m1.1.1.3.2.2.1.cmml">→</mo></mover><mtext id="S2.E3.m1.1.1.3.2.3" xref="S2.E3.m1.1.1.3.2.3a.cmml">desired</mtext></msub><mo id="S2.E3.m1.1.1.3.1" xref="S2.E3.m1.1.1.3.1.cmml">+</mo><msub id="S2.E3.m1.1.1.3.3" xref="S2.E3.m1.1.1.3.3.cmml"><mover accent="true" id="S2.E3.m1.1.1.3.3.2" xref="S2.E3.m1.1.1.3.3.2.cmml"><mi id="S2.E3.m1.1.1.3.3.2.2" xref="S2.E3.m1.1.1.3.3.2.2.cmml">F</mi><mo stretchy="false" id="S2.E3.m1.1.1.3.3.2.1" xref="S2.E3.m1.1.1.3.3.2.1.cmml">→</mo></mover><mtext id="S2.E3.m1.1.1.3.3.3" xref="S2.E3.m1.1.1.3.3.3a.cmml">social</mtext></msub><mo id="S2.E3.m1.1.1.3.1a" xref="S2.E3.m1.1.1.3.1.cmml">+</mo><msub id="S2.E3.m1.1.1.3.4" xref="S2.E3.m1.1.1.3.4.cmml"><mover accent="true" id="S2.E3.m1.1.1.3.4.2" xref="S2.E3.m1.1.1.3.4.2.cmml"><mi id="S2.E3.m1.1.1.3.4.2.2" xref="S2.E3.m1.1.1.3.4.2.2.cmml">F</mi><mo stretchy="false" id="S2.E3.m1.1.1.3.4.2.1" xref="S2.E3.m1.1.1.3.4.2.1.cmml">→</mo></mover><mtext id="S2.E3.m1.1.1.3.4.3" xref="S2.E3.m1.1.1.3.4.3a.cmml">obs</mtext></msub><mo id="S2.E3.m1.1.1.3.1b" xref="S2.E3.m1.1.1.3.1.cmml">+</mo><msub id="S2.E3.m1.1.1.3.5" xref="S2.E3.m1.1.1.3.5.cmml"><mover accent="true" id="S2.E3.m1.1.1.3.5.2" xref="S2.E3.m1.1.1.3.5.2.cmml"><mi id="S2.E3.m1.1.1.3.5.2.2" xref="S2.E3.m1.1.1.3.5.2.2.cmml">F</mi><mo stretchy="false" id="S2.E3.m1.1.1.3.5.2.1" xref="S2.E3.m1.1.1.3.5.2.1.cmml">→</mo></mover><mtext id="S2.E3.m1.1.1.3.5.3" xref="S2.E3.m1.1.1.3.5.3a.cmml">fluct</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><eq id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"></eq><apply id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"><divide id="S2.E3.m1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.2"></divide><apply id="S2.E3.m1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.2.2"><times id="S2.E3.m1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.2.2.1"></times><ci id="S2.E3.m1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.2.2.2">𝑑</ci><apply id="S2.E3.m1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.1.1.2.2.3">subscript</csymbol><apply id="S2.E3.m1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.1.1.2.2.3.2"><ci id="S2.E3.m1.1.1.2.2.3.2.1.cmml" xref="S2.E3.m1.1.1.2.2.3.2.1">→</ci><ci id="S2.E3.m1.1.1.2.2.3.2.2.cmml" xref="S2.E3.m1.1.1.2.2.3.2.2">𝑣</ci></apply><ci id="S2.E3.m1.1.1.2.2.3.3.cmml" xref="S2.E3.m1.1.1.2.2.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.2.3"><times id="S2.E3.m1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.2.3.1"></times><ci id="S2.E3.m1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.2.3.2">𝑑</ci><ci id="S2.E3.m1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><plus id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3.1"></plus><apply id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.3.2">subscript</csymbol><apply id="S2.E3.m1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2"><ci id="S2.E3.m1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.1.1.3.2.2.1">→</ci><ci id="S2.E3.m1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2.2">𝐹</ci></apply><ci id="S2.E3.m1.1.1.3.2.3a.cmml" xref="S2.E3.m1.1.1.3.2.3"><mtext mathsize="70%" id="S2.E3.m1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.3.2.3">desired</mtext></ci></apply><apply id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.3.3">subscript</csymbol><apply id="S2.E3.m1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.3.3.2"><ci id="S2.E3.m1.1.1.3.3.2.1.cmml" xref="S2.E3.m1.1.1.3.3.2.1">→</ci><ci id="S2.E3.m1.1.1.3.3.2.2.cmml" xref="S2.E3.m1.1.1.3.3.2.2">𝐹</ci></apply><ci id="S2.E3.m1.1.1.3.3.3a.cmml" xref="S2.E3.m1.1.1.3.3.3"><mtext mathsize="70%" id="S2.E3.m1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.3.3.3">social</mtext></ci></apply><apply id="S2.E3.m1.1.1.3.4.cmml" xref="S2.E3.m1.1.1.3.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.4.1.cmml" xref="S2.E3.m1.1.1.3.4">subscript</csymbol><apply id="S2.E3.m1.1.1.3.4.2.cmml" xref="S2.E3.m1.1.1.3.4.2"><ci id="S2.E3.m1.1.1.3.4.2.1.cmml" xref="S2.E3.m1.1.1.3.4.2.1">→</ci><ci id="S2.E3.m1.1.1.3.4.2.2.cmml" xref="S2.E3.m1.1.1.3.4.2.2">𝐹</ci></apply><ci id="S2.E3.m1.1.1.3.4.3a.cmml" xref="S2.E3.m1.1.1.3.4.3"><mtext mathsize="70%" id="S2.E3.m1.1.1.3.4.3.cmml" xref="S2.E3.m1.1.1.3.4.3">obs</mtext></ci></apply><apply id="S2.E3.m1.1.1.3.5.cmml" xref="S2.E3.m1.1.1.3.5"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.5.1.cmml" xref="S2.E3.m1.1.1.3.5">subscript</csymbol><apply id="S2.E3.m1.1.1.3.5.2.cmml" xref="S2.E3.m1.1.1.3.5.2"><ci id="S2.E3.m1.1.1.3.5.2.1.cmml" xref="S2.E3.m1.1.1.3.5.2.1">→</ci><ci id="S2.E3.m1.1.1.3.5.2.2.cmml" xref="S2.E3.m1.1.1.3.5.2.2">𝐹</ci></apply><ci id="S2.E3.m1.1.1.3.5.3a.cmml" xref="S2.E3.m1.1.1.3.5.3"><mtext mathsize="70%" id="S2.E3.m1.1.1.3.5.3.cmml" xref="S2.E3.m1.1.1.3.5.3">fluct</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\frac{d{\vec{v}}_{t}}{dt}={\vec{F}}_{\text{desired}}+{\vec{F}}_{\text{social}}+{\vec{F}}_{\text{obs}}+{\vec{F}}_{\text{fluct}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.10" class="ltx_p">In Eq. <a href="#S2.E3" title="In II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>,
<math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="\vec{F}_{\text{desired}}" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><msub id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mover accent="true" id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2.2" xref="S2.SS3.p3.1.m1.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.1.m1.1.1.2.1" xref="S2.SS3.p3.1.m1.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3a.cmml">desired</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">subscript</csymbol><apply id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2"><ci id="S2.SS3.p3.1.m1.1.1.2.1.cmml" xref="S2.SS3.p3.1.m1.1.1.2.1">→</ci><ci id="S2.SS3.p3.1.m1.1.1.2.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.1.m1.1.1.3a.cmml" xref="S2.SS3.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">desired</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">\vec{F}_{\text{desired}}</annotation></semantics></math> represents the <span id="S2.SS3.p3.10.1" class="ltx_text ltx_font_italic">desired force</span>, which drives the vehicle towards its navigation goal;
<math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="\vec{F}_{\text{social}}" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><msub id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.p3.2.m2.1.1.2" xref="S2.SS3.p3.2.m2.1.1.2.cmml"><mi id="S2.SS3.p3.2.m2.1.1.2.2" xref="S2.SS3.p3.2.m2.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.2.m2.1.1.2.1" xref="S2.SS3.p3.2.m2.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.2.m2.1.1.3" xref="S2.SS3.p3.2.m2.1.1.3a.cmml">social</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.p3.2.m2.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2"><ci id="S2.SS3.p3.2.m2.1.1.2.1.cmml" xref="S2.SS3.p3.2.m2.1.1.2.1">→</ci><ci id="S2.SS3.p3.2.m2.1.1.2.2.cmml" xref="S2.SS3.p3.2.m2.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.2.m2.1.1.3a.cmml" xref="S2.SS3.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.2.m2.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.3">social</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">\vec{F}_{\text{social}}</annotation></semantics></math> is the <span id="S2.SS3.p3.10.2" class="ltx_text ltx_font_italic">social force</span> to measure the influence of nearby pedestrians;
<math id="S2.SS3.p3.3.m3.1" class="ltx_Math" alttext="\vec{F}_{\text{obs}}" display="inline"><semantics id="S2.SS3.p3.3.m3.1a"><msub id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mover accent="true" id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2.2" xref="S2.SS3.p3.3.m3.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.3.m3.1.1.2.1" xref="S2.SS3.p3.3.m3.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3a.cmml">obs</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">subscript</csymbol><apply id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2"><ci id="S2.SS3.p3.3.m3.1.1.2.1.cmml" xref="S2.SS3.p3.3.m3.1.1.2.1">→</ci><ci id="S2.SS3.p3.3.m3.1.1.2.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.3.m3.1.1.3a.cmml" xref="S2.SS3.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3">obs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">\vec{F}_{\text{obs}}</annotation></semantics></math> is the <span id="S2.SS3.p3.10.3" class="ltx_text ltx_font_italic">obstacle force</span> to keep the agent from colliding with static obstacles in the environment;
and <math id="S2.SS3.p3.4.m4.1" class="ltx_Math" alttext="{\vec{F}}_{\text{fluct}}" display="inline"><semantics id="S2.SS3.p3.4.m4.1a"><msub id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mover accent="true" id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2.2" xref="S2.SS3.p3.4.m4.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.4.m4.1.1.2.1" xref="S2.SS3.p3.4.m4.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3a.cmml">fluct</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2"><ci id="S2.SS3.p3.4.m4.1.1.2.1.cmml" xref="S2.SS3.p3.4.m4.1.1.2.1">→</ci><ci id="S2.SS3.p3.4.m4.1.1.2.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.4.m4.1.1.3a.cmml" xref="S2.SS3.p3.4.m4.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3">fluct</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">{\vec{F}}_{\text{fluct}}</annotation></semantics></math> is the force caused by <span id="S2.SS3.p3.10.4" class="ltx_text ltx_font_italic">fluctuations</span>, which comes from the random variations of the environment and the stochastic pedestrian behaviors.
Among them, the <span id="S2.SS3.p3.10.5" class="ltx_text ltx_font_italic">desired force</span> can be simply represented as
<math id="S2.SS3.p3.5.m5.1" class="ltx_Math" alttext="\lambda(p_{\text{desired}}-p_{t})" display="inline"><semantics id="S2.SS3.p3.5.m5.1a"><mrow id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml"><mi id="S2.SS3.p3.5.m5.1.1.3" xref="S2.SS3.p3.5.m5.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.5.m5.1.1.2" xref="S2.SS3.p3.5.m5.1.1.2.cmml">​</mo><mrow id="S2.SS3.p3.5.m5.1.1.1.1" xref="S2.SS3.p3.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.p3.5.m5.1.1.1.1.2" xref="S2.SS3.p3.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p3.5.m5.1.1.1.1.1" xref="S2.SS3.p3.5.m5.1.1.1.1.1.cmml"><msub id="S2.SS3.p3.5.m5.1.1.1.1.1.2" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p3.5.m5.1.1.1.1.1.2.2" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S2.SS3.p3.5.m5.1.1.1.1.1.2.3" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.3a.cmml">desired</mtext></msub><mo id="S2.SS3.p3.5.m5.1.1.1.1.1.1" xref="S2.SS3.p3.5.m5.1.1.1.1.1.1.cmml">−</mo><msub id="S2.SS3.p3.5.m5.1.1.1.1.1.3" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p3.5.m5.1.1.1.1.1.3.2" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3.2.cmml">p</mi><mi id="S2.SS3.p3.5.m5.1.1.1.1.1.3.3" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S2.SS3.p3.5.m5.1.1.1.1.3" xref="S2.SS3.p3.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><apply id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1"><times id="S2.SS3.p3.5.m5.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1.2"></times><ci id="S2.SS3.p3.5.m5.1.1.3.cmml" xref="S2.SS3.p3.5.m5.1.1.3">𝜆</ci><apply id="S2.SS3.p3.5.m5.1.1.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1"><minus id="S2.SS3.p3.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.1"></minus><apply id="S2.SS3.p3.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m5.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p3.5.m5.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.SS3.p3.5.m5.1.1.1.1.1.2.3a.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.SS3.p3.5.m5.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.2.3">desired</mtext></ci></apply><apply id="S2.SS3.p3.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m5.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p3.5.m5.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3.2">𝑝</ci><ci id="S2.SS3.p3.5.m5.1.1.1.1.1.3.3.cmml" xref="S2.SS3.p3.5.m5.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">\lambda(p_{\text{desired}}-p_{t})</annotation></semantics></math>, where <math id="S2.SS3.p3.6.m6.1" class="ltx_Math" alttext="p_{t}" display="inline"><semantics id="S2.SS3.p3.6.m6.1a"><msub id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml"><mi id="S2.SS3.p3.6.m6.1.1.2" xref="S2.SS3.p3.6.m6.1.1.2.cmml">p</mi><mi id="S2.SS3.p3.6.m6.1.1.3" xref="S2.SS3.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><apply id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m6.1.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.p3.6.m6.1.1.2.cmml" xref="S2.SS3.p3.6.m6.1.1.2">𝑝</ci><ci id="S2.SS3.p3.6.m6.1.1.3.cmml" xref="S2.SS3.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">p_{t}</annotation></semantics></math> and <math id="S2.SS3.p3.7.m7.1" class="ltx_Math" alttext="p_{\text{desired}}" display="inline"><semantics id="S2.SS3.p3.7.m7.1a"><msub id="S2.SS3.p3.7.m7.1.1" xref="S2.SS3.p3.7.m7.1.1.cmml"><mi id="S2.SS3.p3.7.m7.1.1.2" xref="S2.SS3.p3.7.m7.1.1.2.cmml">p</mi><mtext id="S2.SS3.p3.7.m7.1.1.3" xref="S2.SS3.p3.7.m7.1.1.3a.cmml">desired</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m7.1b"><apply id="S2.SS3.p3.7.m7.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m7.1.1.1.cmml" xref="S2.SS3.p3.7.m7.1.1">subscript</csymbol><ci id="S2.SS3.p3.7.m7.1.1.2.cmml" xref="S2.SS3.p3.7.m7.1.1.2">𝑝</ci><ci id="S2.SS3.p3.7.m7.1.1.3a.cmml" xref="S2.SS3.p3.7.m7.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.7.m7.1.1.3.cmml" xref="S2.SS3.p3.7.m7.1.1.3">desired</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m7.1c">p_{\text{desired}}</annotation></semantics></math> represent the pose of the agent and the target respectively. It is similar to the concept of <span id="S2.SS3.p3.10.6" class="ltx_text ltx_font_italic">prefered velocity</span> in other planning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The calculation of the <span id="S2.SS3.p3.10.7" class="ltx_text ltx_font_italic">obstacle force</span> <math id="S2.SS3.p3.8.m8.1" class="ltx_Math" alttext="\vec{F}_{\text{obs}}" display="inline"><semantics id="S2.SS3.p3.8.m8.1a"><msub id="S2.SS3.p3.8.m8.1.1" xref="S2.SS3.p3.8.m8.1.1.cmml"><mover accent="true" id="S2.SS3.p3.8.m8.1.1.2" xref="S2.SS3.p3.8.m8.1.1.2.cmml"><mi id="S2.SS3.p3.8.m8.1.1.2.2" xref="S2.SS3.p3.8.m8.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.8.m8.1.1.2.1" xref="S2.SS3.p3.8.m8.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.8.m8.1.1.3" xref="S2.SS3.p3.8.m8.1.1.3a.cmml">obs</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m8.1b"><apply id="S2.SS3.p3.8.m8.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m8.1.1.1.cmml" xref="S2.SS3.p3.8.m8.1.1">subscript</csymbol><apply id="S2.SS3.p3.8.m8.1.1.2.cmml" xref="S2.SS3.p3.8.m8.1.1.2"><ci id="S2.SS3.p3.8.m8.1.1.2.1.cmml" xref="S2.SS3.p3.8.m8.1.1.2.1">→</ci><ci id="S2.SS3.p3.8.m8.1.1.2.2.cmml" xref="S2.SS3.p3.8.m8.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.8.m8.1.1.3a.cmml" xref="S2.SS3.p3.8.m8.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.8.m8.1.1.3.cmml" xref="S2.SS3.p3.8.m8.1.1.3">obs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m8.1c">\vec{F}_{\text{obs}}</annotation></semantics></math> is based on <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and we will not present the details here.
We note that both the estimation of <math id="S2.SS3.p3.9.m9.1" class="ltx_Math" alttext="{\vec{F}}_{\text{obs}}" display="inline"><semantics id="S2.SS3.p3.9.m9.1a"><msub id="S2.SS3.p3.9.m9.1.1" xref="S2.SS3.p3.9.m9.1.1.cmml"><mover accent="true" id="S2.SS3.p3.9.m9.1.1.2" xref="S2.SS3.p3.9.m9.1.1.2.cmml"><mi id="S2.SS3.p3.9.m9.1.1.2.2" xref="S2.SS3.p3.9.m9.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.9.m9.1.1.2.1" xref="S2.SS3.p3.9.m9.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.9.m9.1.1.3" xref="S2.SS3.p3.9.m9.1.1.3a.cmml">obs</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m9.1b"><apply id="S2.SS3.p3.9.m9.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.9.m9.1.1.1.cmml" xref="S2.SS3.p3.9.m9.1.1">subscript</csymbol><apply id="S2.SS3.p3.9.m9.1.1.2.cmml" xref="S2.SS3.p3.9.m9.1.1.2"><ci id="S2.SS3.p3.9.m9.1.1.2.1.cmml" xref="S2.SS3.p3.9.m9.1.1.2.1">→</ci><ci id="S2.SS3.p3.9.m9.1.1.2.2.cmml" xref="S2.SS3.p3.9.m9.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.9.m9.1.1.3a.cmml" xref="S2.SS3.p3.9.m9.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.9.m9.1.1.3.cmml" xref="S2.SS3.p3.9.m9.1.1.3">obs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m9.1c">{\vec{F}}_{\text{obs}}</annotation></semantics></math> and <math id="S2.SS3.p3.10.m10.1" class="ltx_Math" alttext="{\vec{F}}_{\text{fluct}}" display="inline"><semantics id="S2.SS3.p3.10.m10.1a"><msub id="S2.SS3.p3.10.m10.1.1" xref="S2.SS3.p3.10.m10.1.1.cmml"><mover accent="true" id="S2.SS3.p3.10.m10.1.1.2" xref="S2.SS3.p3.10.m10.1.1.2.cmml"><mi id="S2.SS3.p3.10.m10.1.1.2.2" xref="S2.SS3.p3.10.m10.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S2.SS3.p3.10.m10.1.1.2.1" xref="S2.SS3.p3.10.m10.1.1.2.1.cmml">→</mo></mover><mtext id="S2.SS3.p3.10.m10.1.1.3" xref="S2.SS3.p3.10.m10.1.1.3a.cmml">fluct</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m10.1b"><apply id="S2.SS3.p3.10.m10.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m10.1.1.1.cmml" xref="S2.SS3.p3.10.m10.1.1">subscript</csymbol><apply id="S2.SS3.p3.10.m10.1.1.2.cmml" xref="S2.SS3.p3.10.m10.1.1.2"><ci id="S2.SS3.p3.10.m10.1.1.2.1.cmml" xref="S2.SS3.p3.10.m10.1.1.2.1">→</ci><ci id="S2.SS3.p3.10.m10.1.1.2.2.cmml" xref="S2.SS3.p3.10.m10.1.1.2.2">𝐹</ci></apply><ci id="S2.SS3.p3.10.m10.1.1.3a.cmml" xref="S2.SS3.p3.10.m10.1.1.3"><mtext mathsize="70%" id="S2.SS3.p3.10.m10.1.1.3.cmml" xref="S2.SS3.p3.10.m10.1.1.3">fluct</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m10.1c">{\vec{F}}_{\text{fluct}}</annotation></semantics></math> are omitted in this paper to prioritize the social aspects.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">To successfully train our model in an interactive manner with all considered social scenarios, an efficient simulation environment that is capable of modeling pedestrians in socially acceptable behaviors is crucial. The existing robotics simulation environments for pedestrians typically do not come with embedded social force model, that the simulated pedestrians are not able to behave in social compliant manner. As an additional contribution of this paper, we release a plugin<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/onlytailei/gym_ped_sim</span></span></span> for simulating socially compliant pedestrians under the framework of <span id="S2.SS3.p4.1.1" class="ltx_text ltx_font_italic">Gazebo</span>, as is shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/1710.02543/assets/figs/env.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="330" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.6.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S2.F2.2.1" class="ltx_text" style="font-size:90%;">
The simulated environment used in this paper. Each pedestrian is behaving under the social force model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
The <span id="S2.F2.2.1.1" class="ltx_text ltx_font_italic">Gazebo</span> plugin is released<sup id="S2.F2.2.1.2" class="ltx_sup">1</sup>.
</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methods</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.7" class="ltx_p">In this paper, we formulate the problem of navigation in pedestrian environment as a <span id="S3.p1.7.1" class="ltx_text ltx_font_italic">Markov decision process</span> (MDP).
The state <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="s_{t}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">s</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑠</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">s_{t}</annotation></semantics></math> is composed of the depth image <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">x</mi><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑥</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">x_{t}</annotation></semantics></math> and the force towards the desired target <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="{\vec{F}}_{t_{\text{desired}}}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml"><mi id="S3.p1.3.m3.1.1.2.2" xref="S3.p1.3.m3.1.1.2.2.cmml">F</mi><mo stretchy="false" id="S3.p1.3.m3.1.1.2.1" xref="S3.p1.3.m3.1.1.2.1.cmml">→</mo></mover><msub id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">t</mi><mtext id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3a.cmml">desired</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1">subscript</csymbol><apply id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2"><ci id="S3.p1.3.m3.1.1.2.1.cmml" xref="S3.p1.3.m3.1.1.2.1">→</ci><ci id="S3.p1.3.m3.1.1.2.2.cmml" xref="S3.p1.3.m3.1.1.2.2">𝐹</ci></apply><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.p1.3.m3.1.1.3.3a.cmml" xref="S3.p1.3.m3.1.1.3.3"><mtext mathsize="50%" id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">desired</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">{\vec{F}}_{t_{\text{desired}}}</annotation></semantics></math>. Each action <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">a</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑎</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">a_{t}</annotation></semantics></math> corresponds to a moving command <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="u_{t}" display="inline"><semantics id="S3.p1.5.m5.1a"><msub id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">u</mi><mi id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑢</ci><ci id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">u_{t}</annotation></semantics></math> to be executed by the mobile robot. Two parameterised networks, the generator (policy) network <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">π</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝜋</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\pi_{\theta}</annotation></semantics></math> and the discriminator network <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="D_{\omega}" display="inline"><semantics id="S3.p1.7.m7.1a"><msub id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><mi id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml">D</mi><mi id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2">𝐷</ci><ci id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">D_{\omega}</annotation></semantics></math> are updated in an interleaving manner in the training phase.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Behavior cloning</span>
</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/1710.02543/assets/x2.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="282" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S3.F3.3.2" class="ltx_text" style="font-size:90%;">Six basic scenarios considered in this paper to compare the navigation performance of the behavior cloning policy and the GAIL policy.
We test the algorithm on a mobile robot from the view of the red agent.</span></figcaption>
</figure>
<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">We initialize the policy generator network <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝜋</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\pi_{\theta}</annotation></semantics></math> with the weights pre-trained via behavior cloning. To collect the training dataset and test the trained model, we identify the following most commonly encountered and typical social scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which are shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Specifically, we collect trajectories from three relatively easy scenarios: (a) passing, (b) overtaking, (c) crossing, as well as three difficult ones: (d) passing out of a group of pedestrians, (e) passing between a group of pedestrians, and (f) crossing with a group of pedestrians. The differences between scenarios (d) and (e) are intended to motivate socially aware navigation strategies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> that pedestrians walking close to each other should be regarded as a group, and the agent is expected to decide whether there is enough space between them for it to make a crossing.
In our socially compliant pedestrian simulator, we collect data by mounting a depth sensor onto one of the pedestrians, to the height matching that of real-world setups. Then, the social force model, as described by Eq. <a href="#S2.E3" title="In II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, is used to label each incoming depth image with their corresponding social force. We note that only the pedestrians within the field of view (FOV) of the depth sensor (with a sensing range of <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="3.5m" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mn id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">3.5</mn><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><times id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></times><cn type="float" id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">3.5</cn><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">3.5m</annotation></semantics></math>, and a vertical sensing angles of <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\pm 35^{\circ}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1a" xref="S3.SS1.p1.3.m3.1.1.cmml">±</mo><msup id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mn id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">35</mn><mo id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">∘</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">plus-or-minus</csymbol><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">superscript</csymbol><cn type="integer" id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">35</cn><compose id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3"></compose></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\pm 35^{\circ}</annotation></semantics></math>), are considered in the social force calculation.
Desired force, represented by the normalized direction vector to the navigation target, are also collected as another input source for the model.
We assign target locations for each episode, ensuring that the agent would have to encounter with pedestrians in the environment before reaching its targets.</p>
</div>
<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.02543/assets/x3.png" id="S3.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="460" height="478" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S3.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">Generator (policy) network.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.02543/assets/x4.png" id="S3.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="465" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S3.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">Discriminator network.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S3.F4.3.2" class="ltx_text" style="font-size:90%;">Network structures for the generator and the discriminator network.
Every convolutional layer is represented by its type, channel size, kernel size and stride size. Other layers are represented by their types and dimonsions. </span></figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">As an additional contribution of this paper, we release the collected dataset<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://ram-lab.com/file/tailei/tai_18icra_dataset.html</span></span></span> for further benchmarking for the literature. The first person view depth image, RGB image, social force, desired force and velocity of the agent are all recorded and included in the dataset. The final dataset contains 10,000 state-action pairs collected from social scenario shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The initial configuration (the position and velocity information) of the pedestrians and the agent are perturbed by random noise for each episode.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">The model for behavior cloning is the same as the generator network of our GAIL model, which is depicted in Fig. <a href="#S3.F4.sf1" title="In Figure 4 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a>. The model takes the depth image and the <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_italic">desired force</span> as input. The depth image is passed through three steams of feature extraction layers, to benefit the resulting representation from the residual learning of skip connection structures <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. The extracted features are merged with the desired force and then used to predict the expert policies, as well as for performing a subtask: social force prediction. Learning on multiple tasks using the same set of features enforces the extracted features to be an effective and compact representation, which can greatly improve the generalization ability of the model and prevent over-fitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. This setup also makes it possible to transfer our trained model naturally to different motion planners, as the social force prediction part can stay intact regardless of the mobile platforms in use.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/1710.02543/assets/x5.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="369" height="271" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.4.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S3.F5.2.1" class="ltx_text" style="font-size:90%;">Average loss <math id="S3.F5.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.F5.2.1.m1.1b"><mo id="S3.F5.2.1.m1.1.1" xref="S3.F5.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.1c"><csymbol cd="latexml" id="S3.F5.2.1.m1.1.1.cmml" xref="S3.F5.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.1.m1.1d">\pm</annotation></semantics></math> one standard deviation for supervised behavior cloning of social force and action predition in 200 epochs. It is used as the initial policy.</span></figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Algorithm</span>
</h3>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Asynchronous GAIL</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  
Collect expert trajectories <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{T}_{E}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">𝒯</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝒯</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{T}_{E}</annotation></semantics></math>.Initialize <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\pi_{\theta}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">π</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝜋</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\pi_{\theta}</annotation></semantics></math> with the behavior cloning policy <math id="alg1.l1.m3.1" class="ltx_Math" alttext="{\theta}_{0}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">θ</mi><mn id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝜃</ci><cn type="integer" id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">{\theta}_{0}</annotation></semantics></math>.Randomly initialize <math id="alg1.l1.m4.1" class="ltx_Math" alttext="D_{\omega}" display="inline"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">D</mi><mi id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">ω</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝐷</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝜔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">D_{\omega}</annotation></semantics></math> with <math id="alg1.l1.m5.1" class="ltx_Math" alttext="{\omega}_{0}" display="inline"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">ω</mi><mn id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝜔</ci><cn type="integer" id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">{\omega}_{0}</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> iteration <math id="alg1.l2.m1.3" class="ltx_Math" alttext="i=0,1,\dotsc" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><mi id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2.cmml">i</mi><mo id="alg1.l2.m1.3.4.1" xref="alg1.l2.m1.3.4.1.cmml">=</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.3.4.3.2.1" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">1</mn><mo id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><eq id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1"></eq><ci id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2">𝑖</ci><list id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">0</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">1</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">i=0,1,\dotsc</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> iteration <math id="alg1.l3.m1.2" class="ltx_Math" alttext="k=1,K" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mi id="alg1.l3.m1.2.3.2" xref="alg1.l3.m1.2.3.2.cmml">k</mi><mo id="alg1.l3.m1.2.3.1" xref="alg1.l3.m1.2.3.1.cmml">=</mo><mrow id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.2.3.3.2.1" xref="alg1.l3.m1.2.3.3.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><eq id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1"></eq><ci id="alg1.l3.m1.2.3.2.cmml" xref="alg1.l3.m1.2.3.2">𝑘</ci><list id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">k=1,K</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">        
Randomly choose a social scenario simulation.Sample one trajectory: <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\mathcal{T}_{ik}\thicksim\pi_{\theta_{i}}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">𝒯</mi><mrow id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml"><mi id="alg1.l4.m1.1.1.2.3.2" xref="alg1.l4.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.2.3.1" xref="alg1.l4.m1.1.1.2.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.2.3.3" xref="alg1.l4.m1.1.1.2.3.3.cmml">k</mi></mrow></msub><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∼</mo><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">π</mi><msub id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.3.3.2" xref="alg1.l4.m1.1.1.3.3.2.cmml">θ</mi><mi id="alg1.l4.m1.1.1.3.3.3" xref="alg1.l4.m1.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">∼</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝒯</ci><apply id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3"><times id="alg1.l4.m1.1.1.2.3.1.cmml" xref="alg1.l4.m1.1.1.2.3.1"></times><ci id="alg1.l4.m1.1.1.2.3.2.cmml" xref="alg1.l4.m1.1.1.2.3.2">𝑖</ci><ci id="alg1.l4.m1.1.1.2.3.3.cmml" xref="alg1.l4.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝜋</ci><apply id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.3.3.2">𝜃</ci><ci id="alg1.l4.m1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\mathcal{T}_{ik}\thicksim\pi_{\theta_{i}}</annotation></semantics></math>


</div>
<div id="alg1.l5" class="ltx_listingline">     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span>Ascending gradients of <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">ω</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝜔</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\omega_{i}</annotation></semantics></math> on mini-batches (<math id="alg1.l5.m2.1" class="ltx_Math" alttext="\kappa_{i}\thicksim\mathcal{T}_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msub id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mi id="alg1.l5.m2.1.1.2.2" xref="alg1.l5.m2.1.1.2.2.cmml">κ</mi><mi id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">∼</mo><msub id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><ci id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1">∼</ci><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2.2">𝜅</ci><ci id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3">𝑖</ci></apply><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3">subscript</csymbol><ci id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3.2">𝒯</ci><ci id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\kappa_{i}\thicksim\mathcal{T}_{i}</annotation></semantics></math>, <math id="alg1.l5.m3.1" class="ltx_Math" alttext="\kappa_{E}\thicksim\mathcal{T}_{E}" display="inline"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><msub id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml"><mi id="alg1.l5.m3.1.1.2.2" xref="alg1.l5.m3.1.1.2.2.cmml">κ</mi><mi id="alg1.l5.m3.1.1.2.3" xref="alg1.l5.m3.1.1.2.3.cmml">E</mi></msub><mo id="alg1.l5.m3.1.1.1" xref="alg1.l5.m3.1.1.1.cmml">∼</mo><msub id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m3.1.1.3.2" xref="alg1.l5.m3.1.1.3.2.cmml">𝒯</mi><mi id="alg1.l5.m3.1.1.3.3" xref="alg1.l5.m3.1.1.3.3.cmml">E</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><ci id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1.1">∼</ci><apply id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.2.1.cmml" xref="alg1.l5.m3.1.1.2">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.2.cmml" xref="alg1.l5.m3.1.1.2.2">𝜅</ci><ci id="alg1.l5.m3.1.1.2.3.cmml" xref="alg1.l5.m3.1.1.2.3">𝐸</ci></apply><apply id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.3.1.cmml" xref="alg1.l5.m3.1.1.3">subscript</csymbol><ci id="alg1.l5.m3.1.1.3.2.cmml" xref="alg1.l5.m3.1.1.3.2">𝒯</ci><ci id="alg1.l5.m3.1.1.3.3.cmml" xref="alg1.l5.m3.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">\kappa_{E}\thicksim\mathcal{T}_{E}</annotation></semantics></math>):<math id="alg1.l5.m4.6" class="ltx_Math" alttext="\ \ \Delta_{\omega}=\mathbb{E}_{\kappa_{i}}[\nabla_{\omega}D_{\omega}(s,a)]-\mathbb{E}_{\kappa_{E}}[\nabla_{\omega}D_{\omega}(s,a)]" display="inline"><semantics id="alg1.l5.m4.6a"><mrow id="alg1.l5.m4.6.6" xref="alg1.l5.m4.6.6.cmml"><msub id="alg1.l5.m4.6.6.4" xref="alg1.l5.m4.6.6.4.cmml"><mi mathvariant="normal" id="alg1.l5.m4.6.6.4.2" xref="alg1.l5.m4.6.6.4.2.cmml">Δ</mi><mi id="alg1.l5.m4.6.6.4.3" xref="alg1.l5.m4.6.6.4.3.cmml">ω</mi></msub><mo id="alg1.l5.m4.6.6.3" xref="alg1.l5.m4.6.6.3.cmml">=</mo><mrow id="alg1.l5.m4.6.6.2" xref="alg1.l5.m4.6.6.2.cmml"><mrow id="alg1.l5.m4.5.5.1.1" xref="alg1.l5.m4.5.5.1.1.cmml"><msub id="alg1.l5.m4.5.5.1.1.3" xref="alg1.l5.m4.5.5.1.1.3.cmml"><mi id="alg1.l5.m4.5.5.1.1.3.2" xref="alg1.l5.m4.5.5.1.1.3.2.cmml">𝔼</mi><msub id="alg1.l5.m4.5.5.1.1.3.3" xref="alg1.l5.m4.5.5.1.1.3.3.cmml"><mi id="alg1.l5.m4.5.5.1.1.3.3.2" xref="alg1.l5.m4.5.5.1.1.3.3.2.cmml">κ</mi><mi id="alg1.l5.m4.5.5.1.1.3.3.3" xref="alg1.l5.m4.5.5.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m4.5.5.1.1.2" xref="alg1.l5.m4.5.5.1.1.2.cmml">​</mo><mrow id="alg1.l5.m4.5.5.1.1.1.1" xref="alg1.l5.m4.5.5.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m4.5.5.1.1.1.1.2" xref="alg1.l5.m4.5.5.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l5.m4.5.5.1.1.1.1.1" xref="alg1.l5.m4.5.5.1.1.1.1.1.cmml"><mrow id="alg1.l5.m4.5.5.1.1.1.1.1.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.cmml"><msub id="alg1.l5.m4.5.5.1.1.1.1.1.2.1" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1.2.cmml">∇</mo><mi id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.3" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1.3.cmml">ω</mi></msub><msub id="alg1.l5.m4.5.5.1.1.1.1.1.2.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2.cmml"><mi id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2.2.cmml">D</mi><mi id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.3" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2.3.cmml">ω</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l5.m4.5.5.1.1.1.1.1.1" xref="alg1.l5.m4.5.5.1.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l5.m4.5.5.1.1.1.1.1.3.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l5.m4.5.5.1.1.1.1.1.3.2.1" xref="alg1.l5.m4.5.5.1.1.1.1.1.3.1.cmml">(</mo><mi id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml">s</mi><mo id="alg1.l5.m4.5.5.1.1.1.1.1.3.2.2" xref="alg1.l5.m4.5.5.1.1.1.1.1.3.1.cmml">,</mo><mi id="alg1.l5.m4.2.2" xref="alg1.l5.m4.2.2.cmml">a</mi><mo stretchy="false" id="alg1.l5.m4.5.5.1.1.1.1.1.3.2.3" xref="alg1.l5.m4.5.5.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l5.m4.5.5.1.1.1.1.3" xref="alg1.l5.m4.5.5.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="alg1.l5.m4.6.6.2.3" xref="alg1.l5.m4.6.6.2.3.cmml">−</mo><mrow id="alg1.l5.m4.6.6.2.2" xref="alg1.l5.m4.6.6.2.2.cmml"><msub id="alg1.l5.m4.6.6.2.2.3" xref="alg1.l5.m4.6.6.2.2.3.cmml"><mi id="alg1.l5.m4.6.6.2.2.3.2" xref="alg1.l5.m4.6.6.2.2.3.2.cmml">𝔼</mi><msub id="alg1.l5.m4.6.6.2.2.3.3" xref="alg1.l5.m4.6.6.2.2.3.3.cmml"><mi id="alg1.l5.m4.6.6.2.2.3.3.2" xref="alg1.l5.m4.6.6.2.2.3.3.2.cmml">κ</mi><mi id="alg1.l5.m4.6.6.2.2.3.3.3" xref="alg1.l5.m4.6.6.2.2.3.3.3.cmml">E</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m4.6.6.2.2.2" xref="alg1.l5.m4.6.6.2.2.2.cmml">​</mo><mrow id="alg1.l5.m4.6.6.2.2.1.1" xref="alg1.l5.m4.6.6.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l5.m4.6.6.2.2.1.1.2" xref="alg1.l5.m4.6.6.2.2.1.2.1.cmml">[</mo><mrow id="alg1.l5.m4.6.6.2.2.1.1.1" xref="alg1.l5.m4.6.6.2.2.1.1.1.cmml"><mrow id="alg1.l5.m4.6.6.2.2.1.1.1.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.cmml"><msub id="alg1.l5.m4.6.6.2.2.1.1.1.2.1" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1.cmml"><mo rspace="0.167em" id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1.2.cmml">∇</mo><mi id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.3" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1.3.cmml">ω</mi></msub><msub id="alg1.l5.m4.6.6.2.2.1.1.1.2.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2.cmml"><mi id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2.2.cmml">D</mi><mi id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.3" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2.3.cmml">ω</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l5.m4.6.6.2.2.1.1.1.1" xref="alg1.l5.m4.6.6.2.2.1.1.1.1.cmml">​</mo><mrow id="alg1.l5.m4.6.6.2.2.1.1.1.3.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l5.m4.6.6.2.2.1.1.1.3.2.1" xref="alg1.l5.m4.6.6.2.2.1.1.1.3.1.cmml">(</mo><mi id="alg1.l5.m4.3.3" xref="alg1.l5.m4.3.3.cmml">s</mi><mo id="alg1.l5.m4.6.6.2.2.1.1.1.3.2.2" xref="alg1.l5.m4.6.6.2.2.1.1.1.3.1.cmml">,</mo><mi id="alg1.l5.m4.4.4" xref="alg1.l5.m4.4.4.cmml">a</mi><mo stretchy="false" id="alg1.l5.m4.6.6.2.2.1.1.1.3.2.3" xref="alg1.l5.m4.6.6.2.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l5.m4.6.6.2.2.1.1.3" xref="alg1.l5.m4.6.6.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.6b"><apply id="alg1.l5.m4.6.6.cmml" xref="alg1.l5.m4.6.6"><eq id="alg1.l5.m4.6.6.3.cmml" xref="alg1.l5.m4.6.6.3"></eq><apply id="alg1.l5.m4.6.6.4.cmml" xref="alg1.l5.m4.6.6.4"><csymbol cd="ambiguous" id="alg1.l5.m4.6.6.4.1.cmml" xref="alg1.l5.m4.6.6.4">subscript</csymbol><ci id="alg1.l5.m4.6.6.4.2.cmml" xref="alg1.l5.m4.6.6.4.2">Δ</ci><ci id="alg1.l5.m4.6.6.4.3.cmml" xref="alg1.l5.m4.6.6.4.3">𝜔</ci></apply><apply id="alg1.l5.m4.6.6.2.cmml" xref="alg1.l5.m4.6.6.2"><minus id="alg1.l5.m4.6.6.2.3.cmml" xref="alg1.l5.m4.6.6.2.3"></minus><apply id="alg1.l5.m4.5.5.1.1.cmml" xref="alg1.l5.m4.5.5.1.1"><times id="alg1.l5.m4.5.5.1.1.2.cmml" xref="alg1.l5.m4.5.5.1.1.2"></times><apply id="alg1.l5.m4.5.5.1.1.3.cmml" xref="alg1.l5.m4.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m4.5.5.1.1.3.1.cmml" xref="alg1.l5.m4.5.5.1.1.3">subscript</csymbol><ci id="alg1.l5.m4.5.5.1.1.3.2.cmml" xref="alg1.l5.m4.5.5.1.1.3.2">𝔼</ci><apply id="alg1.l5.m4.5.5.1.1.3.3.cmml" xref="alg1.l5.m4.5.5.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l5.m4.5.5.1.1.3.3.1.cmml" xref="alg1.l5.m4.5.5.1.1.3.3">subscript</csymbol><ci id="alg1.l5.m4.5.5.1.1.3.3.2.cmml" xref="alg1.l5.m4.5.5.1.1.3.3.2">𝜅</ci><ci id="alg1.l5.m4.5.5.1.1.3.3.3.cmml" xref="alg1.l5.m4.5.5.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l5.m4.5.5.1.1.1.2.cmml" xref="alg1.l5.m4.5.5.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m4.5.5.1.1.1.2.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l5.m4.5.5.1.1.1.1.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1"><times id="alg1.l5.m4.5.5.1.1.1.1.1.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.1"></times><apply id="alg1.l5.m4.5.5.1.1.1.1.1.2.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2"><apply id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1">subscript</csymbol><ci id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.2.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1.2">∇</ci><ci id="alg1.l5.m4.5.5.1.1.1.1.1.2.1.3.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.1.3">𝜔</ci></apply><apply id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.2.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2.2">𝐷</ci><ci id="alg1.l5.m4.5.5.1.1.1.1.1.2.2.3.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.2.2.3">𝜔</ci></apply></apply><interval closure="open" id="alg1.l5.m4.5.5.1.1.1.1.1.3.1.cmml" xref="alg1.l5.m4.5.5.1.1.1.1.1.3.2"><ci id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1">𝑠</ci><ci id="alg1.l5.m4.2.2.cmml" xref="alg1.l5.m4.2.2">𝑎</ci></interval></apply></apply></apply><apply id="alg1.l5.m4.6.6.2.2.cmml" xref="alg1.l5.m4.6.6.2.2"><times id="alg1.l5.m4.6.6.2.2.2.cmml" xref="alg1.l5.m4.6.6.2.2.2"></times><apply id="alg1.l5.m4.6.6.2.2.3.cmml" xref="alg1.l5.m4.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l5.m4.6.6.2.2.3.1.cmml" xref="alg1.l5.m4.6.6.2.2.3">subscript</csymbol><ci id="alg1.l5.m4.6.6.2.2.3.2.cmml" xref="alg1.l5.m4.6.6.2.2.3.2">𝔼</ci><apply id="alg1.l5.m4.6.6.2.2.3.3.cmml" xref="alg1.l5.m4.6.6.2.2.3.3"><csymbol cd="ambiguous" id="alg1.l5.m4.6.6.2.2.3.3.1.cmml" xref="alg1.l5.m4.6.6.2.2.3.3">subscript</csymbol><ci id="alg1.l5.m4.6.6.2.2.3.3.2.cmml" xref="alg1.l5.m4.6.6.2.2.3.3.2">𝜅</ci><ci id="alg1.l5.m4.6.6.2.2.3.3.3.cmml" xref="alg1.l5.m4.6.6.2.2.3.3.3">𝐸</ci></apply></apply><apply id="alg1.l5.m4.6.6.2.2.1.2.cmml" xref="alg1.l5.m4.6.6.2.2.1.1"><csymbol cd="latexml" id="alg1.l5.m4.6.6.2.2.1.2.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.2">delimited-[]</csymbol><apply id="alg1.l5.m4.6.6.2.2.1.1.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1"><times id="alg1.l5.m4.6.6.2.2.1.1.1.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.1"></times><apply id="alg1.l5.m4.6.6.2.2.1.1.1.2.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2"><apply id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1">subscript</csymbol><ci id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.2.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1.2">∇</ci><ci id="alg1.l5.m4.6.6.2.2.1.1.1.2.1.3.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.1.3">𝜔</ci></apply><apply id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2">subscript</csymbol><ci id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.2.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2.2">𝐷</ci><ci id="alg1.l5.m4.6.6.2.2.1.1.1.2.2.3.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.2.2.3">𝜔</ci></apply></apply><interval closure="open" id="alg1.l5.m4.6.6.2.2.1.1.1.3.1.cmml" xref="alg1.l5.m4.6.6.2.2.1.1.1.3.2"><ci id="alg1.l5.m4.3.3.cmml" xref="alg1.l5.m4.3.3">𝑠</ci><ci id="alg1.l5.m4.4.4.cmml" xref="alg1.l5.m4.4.4">𝑎</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.6c">\ \ \Delta_{\omega}=\mathbb{E}_{\kappa_{i}}[\nabla_{\omega}D_{\omega}(s,a)]-\mathbb{E}_{\kappa_{E}}[\nabla_{\omega}D_{\omega}(s,a)]</annotation></semantics></math> Update to <math id="alg1.l5.m5.1" class="ltx_Math" alttext="\omega_{i+1}" display="inline"><semantics id="alg1.l5.m5.1a"><msub id="alg1.l5.m5.1.1" xref="alg1.l5.m5.1.1.cmml"><mi id="alg1.l5.m5.1.1.2" xref="alg1.l5.m5.1.1.2.cmml">ω</mi><mrow id="alg1.l5.m5.1.1.3" xref="alg1.l5.m5.1.1.3.cmml"><mi id="alg1.l5.m5.1.1.3.2" xref="alg1.l5.m5.1.1.3.2.cmml">i</mi><mo id="alg1.l5.m5.1.1.3.1" xref="alg1.l5.m5.1.1.3.1.cmml">+</mo><mn id="alg1.l5.m5.1.1.3.3" xref="alg1.l5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m5.1b"><apply id="alg1.l5.m5.1.1.cmml" xref="alg1.l5.m5.1.1"><csymbol cd="ambiguous" id="alg1.l5.m5.1.1.1.cmml" xref="alg1.l5.m5.1.1">subscript</csymbol><ci id="alg1.l5.m5.1.1.2.cmml" xref="alg1.l5.m5.1.1.2">𝜔</ci><apply id="alg1.l5.m5.1.1.3.cmml" xref="alg1.l5.m5.1.1.3"><plus id="alg1.l5.m5.1.1.3.1.cmml" xref="alg1.l5.m5.1.1.3.1"></plus><ci id="alg1.l5.m5.1.1.3.2.cmml" xref="alg1.l5.m5.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l5.m5.1.1.3.3.cmml" xref="alg1.l5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m5.1c">\omega_{i+1}</annotation></semantics></math> after clipping the weights
to <math id="alg1.l5.m6.2" class="ltx_Math" alttext="(−0.01,0.01)" display="inline"><semantics id="alg1.l5.m6.2a"><mrow id="alg1.l5.m6.2.2.1" xref="alg1.l5.m6.2.2.2.cmml"><mo stretchy="false" id="alg1.l5.m6.2.2.1.2" xref="alg1.l5.m6.2.2.2.cmml">(</mo><mrow id="alg1.l5.m6.2.2.1.1" xref="alg1.l5.m6.2.2.1.1.cmml"><mi mathvariant="normal" id="alg1.l5.m6.2.2.1.1.2" xref="alg1.l5.m6.2.2.1.1.2.cmml">−</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m6.2.2.1.1.1" xref="alg1.l5.m6.2.2.1.1.1.cmml">​</mo><mn id="alg1.l5.m6.2.2.1.1.3" xref="alg1.l5.m6.2.2.1.1.3.cmml">0.01</mn></mrow><mo id="alg1.l5.m6.2.2.1.3" xref="alg1.l5.m6.2.2.2.cmml">,</mo><mn id="alg1.l5.m6.1.1" xref="alg1.l5.m6.1.1.cmml">0.01</mn><mo stretchy="false" id="alg1.l5.m6.2.2.1.4" xref="alg1.l5.m6.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m6.2b"><interval closure="open" id="alg1.l5.m6.2.2.2.cmml" xref="alg1.l5.m6.2.2.1"><apply id="alg1.l5.m6.2.2.1.1.cmml" xref="alg1.l5.m6.2.2.1.1"><times id="alg1.l5.m6.2.2.1.1.1.cmml" xref="alg1.l5.m6.2.2.1.1.1"></times><ci id="alg1.l5.m6.2.2.1.1.2.cmml" xref="alg1.l5.m6.2.2.1.1.2">−</ci><cn type="float" id="alg1.l5.m6.2.2.1.1.3.cmml" xref="alg1.l5.m6.2.2.1.1.3">0.01</cn></apply><cn type="float" id="alg1.l5.m6.1.1.cmml" xref="alg1.l5.m6.1.1">0.01</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m6.2c">(−0.01,0.01)</annotation></semantics></math>. Update <math id="alg1.l5.m7.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l5.m7.1a"><msub id="alg1.l5.m7.1.1" xref="alg1.l5.m7.1.1.cmml"><mi id="alg1.l5.m7.1.1.2" xref="alg1.l5.m7.1.1.2.cmml">θ</mi><mi id="alg1.l5.m7.1.1.3" xref="alg1.l5.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m7.1b"><apply id="alg1.l5.m7.1.1.cmml" xref="alg1.l5.m7.1.1"><csymbol cd="ambiguous" id="alg1.l5.m7.1.1.1.cmml" xref="alg1.l5.m7.1.1">subscript</csymbol><ci id="alg1.l5.m7.1.1.2.cmml" xref="alg1.l5.m7.1.1.2">𝜃</ci><ci id="alg1.l5.m7.1.1.3.cmml" xref="alg1.l5.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m7.1c">\theta_{i}</annotation></semantics></math> to <math id="alg1.l5.m8.1" class="ltx_Math" alttext="\theta_{i+1}" display="inline"><semantics id="alg1.l5.m8.1a"><msub id="alg1.l5.m8.1.1" xref="alg1.l5.m8.1.1.cmml"><mi id="alg1.l5.m8.1.1.2" xref="alg1.l5.m8.1.1.2.cmml">θ</mi><mrow id="alg1.l5.m8.1.1.3" xref="alg1.l5.m8.1.1.3.cmml"><mi id="alg1.l5.m8.1.1.3.2" xref="alg1.l5.m8.1.1.3.2.cmml">i</mi><mo id="alg1.l5.m8.1.1.3.1" xref="alg1.l5.m8.1.1.3.1.cmml">+</mo><mn id="alg1.l5.m8.1.1.3.3" xref="alg1.l5.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m8.1b"><apply id="alg1.l5.m8.1.1.cmml" xref="alg1.l5.m8.1.1"><csymbol cd="ambiguous" id="alg1.l5.m8.1.1.1.cmml" xref="alg1.l5.m8.1.1">subscript</csymbol><ci id="alg1.l5.m8.1.1.2.cmml" xref="alg1.l5.m8.1.1.2">𝜃</ci><apply id="alg1.l5.m8.1.1.3.cmml" xref="alg1.l5.m8.1.1.3"><plus id="alg1.l5.m8.1.1.3.1.cmml" xref="alg1.l5.m8.1.1.3.1"></plus><ci id="alg1.l5.m8.1.1.3.2.cmml" xref="alg1.l5.m8.1.1.3.2">𝑖</ci><cn type="integer" id="alg1.l5.m8.1.1.3.3.cmml" xref="alg1.l5.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m8.1c">\theta_{i+1}</annotation></semantics></math> with the cost function <math id="alg1.l5.m9.2" class="ltx_Math" alttext="D_{\omega_{\i+1}}(s,a)" display="inline"><semantics id="alg1.l5.m9.2a"><mrow id="alg1.l5.m9.2.3" xref="alg1.l5.m9.2.3.cmml"><msub id="alg1.l5.m9.2.3.2" xref="alg1.l5.m9.2.3.2.cmml"><mi id="alg1.l5.m9.2.3.2.2" xref="alg1.l5.m9.2.3.2.2.cmml">D</mi><msub id="alg1.l5.m9.2.3.2.3" xref="alg1.l5.m9.2.3.2.3.cmml"><mi id="alg1.l5.m9.2.3.2.3.2" xref="alg1.l5.m9.2.3.2.3.2.cmml">ω</mi><mrow id="alg1.l5.m9.2.3.2.3.3" xref="alg1.l5.m9.2.3.2.3.3.cmml"><mi id="alg1.l5.m9.2.3.2.3.3.2" xref="alg1.l5.m9.2.3.2.3.3.2.cmml">ı</mi><mo id="alg1.l5.m9.2.3.2.3.3.1" xref="alg1.l5.m9.2.3.2.3.3.1.cmml">+</mo><mn id="alg1.l5.m9.2.3.2.3.3.3" xref="alg1.l5.m9.2.3.2.3.3.3.cmml">1</mn></mrow></msub></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m9.2.3.1" xref="alg1.l5.m9.2.3.1.cmml">​</mo><mrow id="alg1.l5.m9.2.3.3.2" xref="alg1.l5.m9.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l5.m9.2.3.3.2.1" xref="alg1.l5.m9.2.3.3.1.cmml">(</mo><mi id="alg1.l5.m9.1.1" xref="alg1.l5.m9.1.1.cmml">s</mi><mo id="alg1.l5.m9.2.3.3.2.2" xref="alg1.l5.m9.2.3.3.1.cmml">,</mo><mi id="alg1.l5.m9.2.2" xref="alg1.l5.m9.2.2.cmml">a</mi><mo stretchy="false" id="alg1.l5.m9.2.3.3.2.3" xref="alg1.l5.m9.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m9.2b"><apply id="alg1.l5.m9.2.3.cmml" xref="alg1.l5.m9.2.3"><times id="alg1.l5.m9.2.3.1.cmml" xref="alg1.l5.m9.2.3.1"></times><apply id="alg1.l5.m9.2.3.2.cmml" xref="alg1.l5.m9.2.3.2"><csymbol cd="ambiguous" id="alg1.l5.m9.2.3.2.1.cmml" xref="alg1.l5.m9.2.3.2">subscript</csymbol><ci id="alg1.l5.m9.2.3.2.2.cmml" xref="alg1.l5.m9.2.3.2.2">𝐷</ci><apply id="alg1.l5.m9.2.3.2.3.cmml" xref="alg1.l5.m9.2.3.2.3"><csymbol cd="ambiguous" id="alg1.l5.m9.2.3.2.3.1.cmml" xref="alg1.l5.m9.2.3.2.3">subscript</csymbol><ci id="alg1.l5.m9.2.3.2.3.2.cmml" xref="alg1.l5.m9.2.3.2.3.2">𝜔</ci><apply id="alg1.l5.m9.2.3.2.3.3.cmml" xref="alg1.l5.m9.2.3.2.3.3"><plus id="alg1.l5.m9.2.3.2.3.3.1.cmml" xref="alg1.l5.m9.2.3.2.3.3.1"></plus><ci id="alg1.l5.m9.2.3.2.3.3.2.cmml" xref="alg1.l5.m9.2.3.2.3.3.2">italic-ı</ci><cn type="integer" id="alg1.l5.m9.2.3.2.3.3.3.cmml" xref="alg1.l5.m9.2.3.2.3.3.3">1</cn></apply></apply></apply><interval closure="open" id="alg1.l5.m9.2.3.3.1.cmml" xref="alg1.l5.m9.2.3.3.2"><ci id="alg1.l5.m9.1.1.cmml" xref="alg1.l5.m9.1.1">𝑠</ci><ci id="alg1.l5.m9.2.2.cmml" xref="alg1.l5.m9.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m9.2c">D_{\omega_{\i+1}}(s,a)</annotation></semantics></math> under the TRPO rule.

</div>
<div id="alg1.l6" class="ltx_listingline">  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
<figure id="S3.F6" class="ltx_figure"><img src="/html/1710.02543/assets/x6.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="392" height="368" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S3.F6.3.2" class="ltx_text" style="font-size:90%;">Navigation trajectories of test episodes. In every scenario, the upper part is the performance of the model purely trained from behavior cloning and the lower part is the performance of the model optimized by GAIL. The thickness of the path increases from the starting position of the agent to its ending point. Red paths are the trajectories executed by the mobile robot under the trained policy. The other agents are moving under the social force model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</span></figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">The original GAIL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> requires training one model for each specific task. The trajectories sampled from the environment are quite similar across episodes, which greatly limits the generalization of the trained model. Inspired by various asynchronous methods in the deep reinforcement learning literature (Async-DRL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, we propose to perform generative adversarial imitation learning in a modified training procedure. Specifically, during training, our model interacts with several different social scenario simulations in an interleaving manner. The resulting model thus converges to a generalized policy across all social scenarios and is able to perform well on all considered tasks. We note that our proposed method differs from the other Async-DRL methods in that, those previous approaches have multiple instances of the environment of the same task, while for our approach, each instance of the environment corresponds to a different social task.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.10" class="ltx_p">We describe our approach in detail in Algorithm <a href="#alg1" title="Algorithm 1 ‣ III-B Algorithm ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We initialize the generator (policy) network of our GAIL model by the pre-trained weights <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">θ</mi><mn id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\theta_{0}</annotation></semantics></math> from behavior cloning.
The discriminator network is initialized randomly with <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\omega_{0}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">ω</mi><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝜔</ci><cn type="integer" id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\omega_{0}</annotation></semantics></math>.
In every training step, the trajectories <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\tau_{i}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">τ</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝜏</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\tau_{i}</annotation></semantics></math> are sampled from different social scenario simulations.
The sampled trajectories <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\tau_{i}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">τ</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝜏</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\tau_{i}</annotation></semantics></math> and the sampled expert trajectories <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\tau_{E}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">τ</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝜏</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\tau_{E}</annotation></semantics></math> are then fed into the discriminator network.
The weight of the discriminator network is clipped between <math id="S3.SS2.p2.6.m6.2" class="ltx_Math" alttext="(-0.01,0.01)" display="inline"><semantics id="S3.SS2.p2.6.m6.2a"><mrow id="S3.SS2.p2.6.m6.2.2.1" xref="S3.SS2.p2.6.m6.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m6.2.2.1.2" xref="S3.SS2.p2.6.m6.2.2.2.cmml">(</mo><mrow id="S3.SS2.p2.6.m6.2.2.1.1" xref="S3.SS2.p2.6.m6.2.2.1.1.cmml"><mo id="S3.SS2.p2.6.m6.2.2.1.1a" xref="S3.SS2.p2.6.m6.2.2.1.1.cmml">−</mo><mn id="S3.SS2.p2.6.m6.2.2.1.1.2" xref="S3.SS2.p2.6.m6.2.2.1.1.2.cmml">0.01</mn></mrow><mo id="S3.SS2.p2.6.m6.2.2.1.3" xref="S3.SS2.p2.6.m6.2.2.2.cmml">,</mo><mn id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">0.01</mn><mo stretchy="false" id="S3.SS2.p2.6.m6.2.2.1.4" xref="S3.SS2.p2.6.m6.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.2b"><interval closure="open" id="S3.SS2.p2.6.m6.2.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2.1"><apply id="S3.SS2.p2.6.m6.2.2.1.1.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1"><minus id="S3.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1"></minus><cn type="float" id="S3.SS2.p2.6.m6.2.2.1.1.2.cmml" xref="S3.SS2.p2.6.m6.2.2.1.1.2">0.01</cn></apply><cn type="float" id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">0.01</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.2c">(-0.01,0.01)</annotation></semantics></math> to update to <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="\omega_{i+1}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">ω</mi><mrow id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.7.m7.1.1.3.1" xref="S3.SS2.p2.7.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p2.7.m7.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝜔</ci><apply id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3"><plus id="S3.SS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.1"></plus><ci id="S3.SS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\omega_{i+1}</annotation></semantics></math>, to fulfill the constraint of WGAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
After that, <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><msub id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">θ</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝜃</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\theta_{i}</annotation></semantics></math> is updated to <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="\theta_{i+1}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">θ</mi><mrow id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.3.2" xref="S3.SS2.p2.9.m9.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.9.m9.1.1.3.1" xref="S3.SS2.p2.9.m9.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p2.9.m9.1.1.3.3" xref="S3.SS2.p2.9.m9.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝜃</ci><apply id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3"><plus id="S3.SS2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS2.p2.9.m9.1.1.3.1"></plus><ci id="S3.SS2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS2.p2.9.m9.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p2.9.m9.1.1.3.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\theta_{i+1}</annotation></semantics></math>, by following the TRPO rule for updating the policy parameters. The discrimination score of the state action pair <math id="S3.SS2.p2.10.m10.2" class="ltx_Math" alttext="D_{\omega_{i+1}}(s,a)" display="inline"><semantics id="S3.SS2.p2.10.m10.2a"><mrow id="S3.SS2.p2.10.m10.2.3" xref="S3.SS2.p2.10.m10.2.3.cmml"><msub id="S3.SS2.p2.10.m10.2.3.2" xref="S3.SS2.p2.10.m10.2.3.2.cmml"><mi id="S3.SS2.p2.10.m10.2.3.2.2" xref="S3.SS2.p2.10.m10.2.3.2.2.cmml">D</mi><msub id="S3.SS2.p2.10.m10.2.3.2.3" xref="S3.SS2.p2.10.m10.2.3.2.3.cmml"><mi id="S3.SS2.p2.10.m10.2.3.2.3.2" xref="S3.SS2.p2.10.m10.2.3.2.3.2.cmml">ω</mi><mrow id="S3.SS2.p2.10.m10.2.3.2.3.3" xref="S3.SS2.p2.10.m10.2.3.2.3.3.cmml"><mi id="S3.SS2.p2.10.m10.2.3.2.3.3.2" xref="S3.SS2.p2.10.m10.2.3.2.3.3.2.cmml">i</mi><mo id="S3.SS2.p2.10.m10.2.3.2.3.3.1" xref="S3.SS2.p2.10.m10.2.3.2.3.3.1.cmml">+</mo><mn id="S3.SS2.p2.10.m10.2.3.2.3.3.3" xref="S3.SS2.p2.10.m10.2.3.2.3.3.3.cmml">1</mn></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.10.m10.2.3.1" xref="S3.SS2.p2.10.m10.2.3.1.cmml">​</mo><mrow id="S3.SS2.p2.10.m10.2.3.3.2" xref="S3.SS2.p2.10.m10.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.10.m10.2.3.3.2.1" xref="S3.SS2.p2.10.m10.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">s</mi><mo id="S3.SS2.p2.10.m10.2.3.3.2.2" xref="S3.SS2.p2.10.m10.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p2.10.m10.2.2" xref="S3.SS2.p2.10.m10.2.2.cmml">a</mi><mo stretchy="false" id="S3.SS2.p2.10.m10.2.3.3.2.3" xref="S3.SS2.p2.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.2b"><apply id="S3.SS2.p2.10.m10.2.3.cmml" xref="S3.SS2.p2.10.m10.2.3"><times id="S3.SS2.p2.10.m10.2.3.1.cmml" xref="S3.SS2.p2.10.m10.2.3.1"></times><apply id="S3.SS2.p2.10.m10.2.3.2.cmml" xref="S3.SS2.p2.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.2.3.2.1.cmml" xref="S3.SS2.p2.10.m10.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.10.m10.2.3.2.2.cmml" xref="S3.SS2.p2.10.m10.2.3.2.2">𝐷</ci><apply id="S3.SS2.p2.10.m10.2.3.2.3.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.2.3.2.3.1.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3">subscript</csymbol><ci id="S3.SS2.p2.10.m10.2.3.2.3.2.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3.2">𝜔</ci><apply id="S3.SS2.p2.10.m10.2.3.2.3.3.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3.3"><plus id="S3.SS2.p2.10.m10.2.3.2.3.3.1.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3.3.1"></plus><ci id="S3.SS2.p2.10.m10.2.3.2.3.3.2.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p2.10.m10.2.3.2.3.3.3.cmml" xref="S3.SS2.p2.10.m10.2.3.2.3.3.3">1</cn></apply></apply></apply><interval closure="open" id="S3.SS2.p2.10.m10.2.3.3.1.cmml" xref="S3.SS2.p2.10.m10.2.3.3.2"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝑠</ci><ci id="S3.SS2.p2.10.m10.2.2.cmml" xref="S3.SS2.p2.10.m10.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.2c">D_{\omega_{i+1}}(s,a)</annotation></semantics></math> are used as the cost for policy gradient optimization.
As <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, in the trajectories sampling procedure,
an augmented cost punishing the collision with pedestrians is added,
in case that demonstrations under social force model are not optimal enough.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">As mentioned before, the generator model has the same architecture as the model used for conducting behavior cloning, which is shown in Fig. <a href="#S3.F4.sf1" title="In Figure 4 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a>.
The discriminator, on the other hand, contains only one stream for feature extraction, the resulting features are concatenated with the <span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_italic">desired force</span> of the corresponding step. Then, they are merged with the selected action, which is then fed to several fully-connected layers to estimate a score to tell apart generated policies from expert policies. The details of the discriminator architecture are shown in Fig. <a href="#S3.F4.sf2" title="In Figure 4 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(b)</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<figure id="S4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.02543/assets/x7.png" id="S4.F7.sf1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="343" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf1.3.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F7.sf1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">min-dist<span id="S4.F7.sf1.4.2.1" class="ltx_text ltx_font_upright">: average minimum distance ratio</span></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F7.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1710.02543/assets/x8.png" id="S4.F7.sf2.g1" class="ltx_graphics ltx_img_landscape" width="461" height="344" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.sf2.3.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F7.sf2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">travel time<span id="S4.F7.sf2.4.2.1" class="ltx_text ltx_font_upright">: average travel time ratio</span></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S4.F7.3.2" class="ltx_text" style="font-size:90%;">Average minimum distance to pedestrians and the average travel time of 10 episodes in all test scenarios. Green boxes represent results from the BC policy, and the blue ones show results from the GAIL policy. In every scenario, all the statistics are normalized by dividing the mean of the BC policy.
</span></figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We begin our experiment by training the behavior cloning model.
First, we collect training data from different social scenario simulations, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
To add to the variations of the training dataset, we collect sample trajectories from the perspective of both the agent (shown in red in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and the pedestrians (shown in blue in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). The social force model, as is described in Sec. <a href="#S2.SS3" title="II-C Social force model ‣ II background ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">II-C</span></span></a>, is utilized to generate the expert policy. In total, 10,000 state-action pairs are collected, containing trajectories from all the considered social scenarios, with randomized starting configurations. 2000 samples are separated for evaluating the pre-trained model.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.3" class="ltx_p">To train the behavior cloning model, we use <span id="S4.p2.3.1" class="ltx_text ltx_font_italic">RMSprop</span> with a learning rate of <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="1e{-4}" display="inline"><semantics id="S4.p2.1.m1.1a"><mrow id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mrow id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml"><mn id="S4.p2.1.m1.1.1.2.2" xref="S4.p2.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.p2.1.m1.1.1.2.1" xref="S4.p2.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p2.1.m1.1.1.2.3" xref="S4.p2.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.p2.1.m1.1.1.1" xref="S4.p2.1.m1.1.1.1.cmml">−</mo><mn id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><minus id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1.1"></minus><apply id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2"><times id="S4.p2.1.m1.1.1.2.1.cmml" xref="S4.p2.1.m1.1.1.2.1"></times><cn type="integer" id="S4.p2.1.m1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.2.2">1</cn><ci id="S4.p2.1.m1.1.1.2.3.cmml" xref="S4.p2.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">1e{-4}</annotation></semantics></math>, and decay it by a factor of <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S4.p2.2.m2.1a"><mn id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><cn type="float" id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">0.9</annotation></semantics></math> after every <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.p2.3.m3.1a"><mn id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><cn type="integer" id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">20</annotation></semantics></math> epochs.
We experiment with different weight ratios for the two supervised tasks (social force prediction, action prediction, as shown in Fig. <a href="#S3.F4.sf1" title="In Figure 4 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4(a)</span></a>).
We can observe from Fig. <a href="#S3.F5" title="Figure 5 ‣ III-A Behavior cloning ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that those tasks are effectively learned.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Then we start the training of our model.
As mentioned before, we initialize the generator network of the GAIL policy with the pre-trained behavior cloning model.
In every training step, 3 trajectories are sampled from 6 randomly chosen scenarios as Algorithm <a href="#alg1" title="Algorithm 1 ‣ III-B Algorithm ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
which add up to a total number of 1000 samples approximately. This training strategy is highly effective for learning a generalized policy over all considered tasks, and greatly improves the generalization capability of our trained model across the most commonly encountered social scenes.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">We train GAIL for 300 iterations, in a duration of 10 hours, on a Tesla P100 graphics processing unit. The discriminator is optimized through <span id="S4.p4.1.1" class="ltx_text ltx_font_italic">RMSprop</span> with a learning rate of <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="5e{-5}" display="inline"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mrow id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml"><mn id="S4.p4.1.m1.1.1.2.2" xref="S4.p4.1.m1.1.1.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.1.1.2.1" xref="S4.p4.1.m1.1.1.2.1.cmml">​</mo><mi id="S4.p4.1.m1.1.1.2.3" xref="S4.p4.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">−</mo><mn id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><minus id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1"></minus><apply id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2"><times id="S4.p4.1.m1.1.1.2.1.cmml" xref="S4.p4.1.m1.1.1.2.1"></times><cn type="integer" id="S4.p4.1.m1.1.1.2.2.cmml" xref="S4.p4.1.m1.1.1.2.2">5</cn><ci id="S4.p4.1.m1.1.1.2.3.cmml" xref="S4.p4.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">5e{-5}</annotation></semantics></math>. The generator (policy) network is optimized following the TRPO rule.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">In the following, we present both quantitative and qualitative results, which clearly show the effectiveness our approach. In particular, we can observe that the pre-trained policy via behavior cloning is only able to perform some reactive actions, since it completely ignores the temporal correlations in the sample trajectories, thus is only able to make frame-wise decisions; while the improved policy via GAIL is able to drive the agent to behave in a socially-compliant manner, due to its underlying formulation that takes the underlying MDP of the trajectories into account, which enables it to make planning decisions on the horizon of a whole trajectory.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Evaluation in simulated environments</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To ensure a fair comparison between test runs, we remove all the randomness that is included in the training setups.
A simulated <span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">Turtlebot3 waffle</span> is used to execute 10 test episodes in each scenario, under both BC policy and GAIL policy,
taking the depth image and the <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">desired force</span> as input.
The other pedestrian agents in the environment are navigating under the social force model, taking in also the social force from the mobile robot.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS1.5.1.1" class="ltx_text">IV-A</span>1 </span>Qualitative evaluation</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">Both the trajectories of BC policy and GAIL policy are shown in Fig. <a href="#S3.F6" title="Figure 6 ‣ III-B Algorithm ‣ III Methods ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
For each scenario, we show the BC policy performance in the upper part and the GAIL policy in the lower part.
We increase the thickness of the trajectory from the starting point to the ending point.
The trajectories of the robot are shown in red, the trajectories of pedestrians are shown blue.
We can clearly observe that agent performing under the optimized policy by GAIL is able to navigate in a more socially-compliant manner in all considered scenarios. In particular, in scenarios (a), (b), (c) and (f), the GAIL policy guides the robot further away from the pedestrians. Also, the GAIL policy successfully guides the mobile robot to pass in between (d) and travel out of (e) a group of pedestrians, which the BC policy fails to accomplish.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p">We note that limited by the small FOV, the robot is only able to perceive the pedestrians when they are fairly nearby, especially in the crossing scenario (c). This leads to some sudden turnings shown in the trajectories.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS2.5.1.1" class="ltx_text">IV-A</span>2 </span>Quantitative evaluation</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We choose two metrics to perform quantitative evaluation: (1) <span id="S4.SS1.SSS2.p1.1.1" class="ltx_text ltx_font_italic">min-dist</span>: the minimal distance from the robot to other pedestrians in one episode and (2) <span id="S4.SS1.SSS2.p1.1.2" class="ltx_text ltx_font_italic">travel-time</span>: the time taken by the robot to travel from the starting location to the target. Those statistics are shown in Fig. <a href="#S4.F7" title="Figure 7 ‣ IV Experiments ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.1" class="ltx_p">From Fig. <a href="#S4.F7" title="Figure 7 ‣ IV Experiments ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we can observe that our GAIL model performs much better than the behavior cloning baseline. Fig. <a href="#S4.F7.sf1" title="In Figure 7 ‣ IV Experiments ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7(a)</span></a> shows that it clearly converges to a much safer navigation strategy as its average <span id="S4.SS1.SSS2.p2.1.1" class="ltx_text ltx_font_italic">min-dist</span> to pedestrians is larger than that of the baseline in all six social scenarios; as for the <span id="S4.SS1.SSS2.p2.1.2" class="ltx_text ltx_font_italic">travel-time</span>, it plans more efficient paths in most scenarios as can be seen in Fig. <a href="#S4.F7.sf2" title="In Figure 7 ‣ IV Experiments ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7(b)</span></a>, but performs slightly slower than that of behavior cloning in two easy scenarios. Those two statistics show that the GAIL model learns to navigate in a much more socially acceptable way, and is able to plan paths that are both safe and efficient.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Real world experiments</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We also conduct real-world experiments to test the performance of our approach in realistic scenarios.
We use a <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">Turtlebot waffle</span> platform, which is shown in Fig. <a href="#S4.F8" title="Figure 8 ‣ IV-B Real world experiments ‣ IV Experiments ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.
It navigates autonomously in an indoor office environment as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ I-1 Socially compliant navigation ‣ I Introduction ‣ Socially Compliant Navigation through Raw Depth Inputs with Generative Adversarial Imitation Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>,
under the improved GAIL policy. A low-cost laser range sensor is used to localize the robot in the environment.
Navigation targets are chosen randomly on the collision-free areas of the map.
The depth image, captured by an obboard Intel Realsense R200, is cropped to <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="400\times 250" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">400</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">250</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">400</cn><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">400\times 250</annotation></semantics></math> and fed into the trained model.
A Nvidia Jetson TX2 is mounted for real-time neural network processing.
The model control cycle runs in real-time at 15Hz. A video showing the real-world performance of our trained policy can be found in <a target="_blank" href="https://goo.gl/42yf6f" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://goo.gl/42yf6f</a>.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/1710.02543/assets/x9.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="311" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F8.3.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="S4.F8.4.2" class="ltx_text" style="font-size:90%;">Real world experiments in an indoor office environment, through a <span id="S4.F8.4.2.1" class="ltx_text ltx_font_italic">Turtlebot waffle</span> platform by taking raw depth images and desired forces as inputs.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We presented an approach for agents to learn to navigate in a socially compliant manner,
from raw depth images. Our algorithm is able to guide the agent to perform socially compliant behaviors,
as well as plan efficient paths to reach its goal location.
We validated our approach in both simulated and real world experiments;
moreover, we release a plugin for simulating pedestrians under social force model,
as well as a dataset collected from our simulation environment.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">The performance of the GAIL policy in real-world environments is influenced by the limited maximum speed and
the FOV of the <span id="S5.p2.1.1" class="ltx_text ltx_font_italic">Turtlebot waffle</span>. We leave it as future work to evaluate the proposed algorithm on more compatible platforms.
Recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> of real-to-sim domain adaptation for visual control also makes it possible to tackle this problem through raw RGB images.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
D. Helbing and P. Molnar, “Social force model for pedestrian dynamics,”
</span><em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Physical review E</em><span id="bib.bib1.3.3" class="ltx_text" style="font-size:90%;">, vol. 51, no. 5, p. 4282, 1995.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
M. Pfeiffer, U. Schwesinger, H. Sommer, E. Galceran, and R. Siegwart,
“Predicting actions to act predictably: Cooperative partial motion planning
with maximum entropy models,” in </span><em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2016 IEEE/RSJ International
Conference on Intelligent Robots and Systems (IROS)</em><span id="bib.bib2.3.3" class="ltx_text" style="font-size:90%;">, 2016, pp. 2096–2101.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Y. F. Chen, M. Everett, M. Liu, and J. P. How, “Socially aware motion planning
with deep reinforcement learning,” in </span><em id="bib.bib3.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">IROS</em><span id="bib.bib3.3.3" class="ltx_text" style="font-size:90%;">, Sept 2017, pp.
1343–1350.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
L. Tai, S. Li, and M. Liu, “A deep-network solution towards model-less
obstacle avoidance,” in </span><em id="bib.bib4.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2016 IEEE/RSJ International Conference on
Intelligent Robots and Systems (IROS)</em><span id="bib.bib4.3.3" class="ltx_text" style="font-size:90%;">, Oct 2016, pp. 2759–2764.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
P. Mirowski, R. Pascanu, F. Viola, H. Soyer, A. Ballard, A. Banino, M. Denil,
R. Goroshin, L. Sifre, K. Kavukcuoglu, </span><em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">et al.</em><span id="bib.bib5.3.3" class="ltx_text" style="font-size:90%;">, “Learning to navigate
in complex environments,” in </span><em id="bib.bib5.4.4" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICLR</em><span id="bib.bib5.5.5" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
L. Tai, G. Paolo, and M. Liu, “Virtual-to-real deep reinforcement learning:
Continuous control of mobile robots for mapless navigation,” in </span><em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2017
IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)</em><span id="bib.bib6.3.3" class="ltx_text" style="font-size:90%;">,
Sep 2017, pp. 31–36.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
J. Zhang, J. T. Springenberg, J. Boedecker, and W. Burgard, “Deep
reinforcement learning with successor features for navigation across similar
environments,” in </span><em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2017 IEEE/RSJ International Conference on
Intelligent Robots and Systems (IROS)</em><span id="bib.bib7.3.3" class="ltx_text" style="font-size:90%;">, Sep 2017, pp. 2371–2378.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
J. Zhang, L. Tai, J. Boedecker, W. Burgard, and M. Liu, “Neural slam: Learning
to explore with external memory,” </span><em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1706.09520</em><span id="bib.bib8.3.3" class="ltx_text" style="font-size:90%;">,
2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
H. Kretzschmar, M. Spies, C. Sprunk, and W. Burgard, “Socially compliant
mobile robot navigation via inverse reinforcement learning,” </span><em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">The
International Journal of Robotics Research</em><span id="bib.bib9.3.3" class="ltx_text" style="font-size:90%;">, vol. 35, no. 11, pp. 1289–1307,
2016.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
B. Okal and K. O. Arras, “Learning socially normative robot navigation
behaviors with bayesian inverse reinforcement learning,” in </span><em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICRA</em><span id="bib.bib10.3.3" class="ltx_text" style="font-size:90%;">, May
2016, pp. 2889–2895.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
A. Y. Ng, S. J. Russell, </span><em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">et al.</em><span id="bib.bib11.3.3" class="ltx_text" style="font-size:90%;">, “Algorithms for inverse reinforcement
learning.” in </span><em id="bib.bib11.4.4" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib11.5.5" class="ltx_text" style="font-size:90%;">, 2000, pp. 663–670.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
P. Abbeel and A. Y. Ng, “Apprenticeship learning via inverse reinforcement
learning,” in </span><em id="bib.bib12.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib12.3.3" class="ltx_text" style="font-size:90%;">, 2004, p. 1.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
J. Ho and S. Ermon, “Generative adversarial imitation learning,” in
</span><em id="bib.bib13.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NIPS</em><span id="bib.bib13.3.3" class="ltx_text" style="font-size:90%;">, 2016, pp. 4565–4573.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Y. Li, J. Song, and S. Ermon, “Infogail: Interpretable imitation learning from
visual demonstrations,” in </span><em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NIPS</em><span id="bib.bib14.3.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D. Warde-Farley, S. Ozair,
A. Courville, and Y. Bengio, “Generative adversarial nets,” in </span><em id="bib.bib15.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">NIPS</em><span id="bib.bib15.3.3" class="ltx_text" style="font-size:90%;">,
2014.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
J. Schulman, S. Levine, P. Abbeel, M. Jordan, and P. Moritz, “Trust region
policy optimization,” in </span><em id="bib.bib16.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib16.3.3" class="ltx_text" style="font-size:90%;">, 2015, pp. 1889–1897.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
M. Arjovsky, S. Chintala, and L. Bottou, “Wasserstein gan,” </span><em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv
preprint arXiv:1701.07875</em><span id="bib.bib17.3.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
J. Van den Berg, M. Lin, and D. Manocha, “Reciprocal velocity obstacles for
real-time multi-agent navigation,” in </span><em id="bib.bib18.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">2008 IEEE International
Conference on Robotics and Automation</em><span id="bib.bib18.3.3" class="ltx_text" style="font-size:90%;">, May 2008, pp. 1928–1935.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in </span><em id="bib.bib19.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">CVPR</em><span id="bib.bib19.3.3" class="ltx_text" style="font-size:90%;">, June 2016.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
I. Goodfellow, Y. Bengio, and A. Courville, </span><em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">Deep Learning</em><span id="bib.bib20.3.3" class="ltx_text" style="font-size:90%;">.   MIT Press, 2016, vol. 1.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
V. Mnih, A. P. Badia, M. Mirza, A. Graves, T. Lillicrap, T. Harley, D. Silver,
and K. Kavukcuoglu, “Asynchronous methods for deep reinforcement learning,”
in </span><em id="bib.bib21.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">ICML</em><span id="bib.bib21.3.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
J. Zhang, L. Tai, Y. Xiong, M. Liu, J. Boedecker, and W. Burgard, “Vr goggles
for robots: Real-to-sim domain adaptation for visual control,” </span><em id="bib.bib22.2.2" class="ltx_emph ltx_font_italic" style="font-size:90%;">arXiv
preprint arXiv:1802.00265</em><span id="bib.bib22.3.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1710.02542" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/land_of_honey_and_milk" rel="nofollow" aria-hidden="true" tabindex="-1"></a>
    <a href="/log/1710.02543" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1710.02543">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1710.02543" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1710.02544" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 03:04:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
